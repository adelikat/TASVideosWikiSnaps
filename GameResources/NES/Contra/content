17
[div class=p 
	"The purpose of this page is to document all of the known tricks
	$LF
	"of the NES Contra game so far.
	$LF
]div
[div class=p 
	"Because of the nature of this site, we concentrate here on tricks
	$LF
	"that are extremely difficult to execute in real play, but are useful
	$LF
	"in the making of tool-assisted speedruns. For most of the tricks,
	$LF
	"a 
	(__wikiLink|displaytext=frame advance|href=/Glossary)
	" feature in an emulator is a definite must-have.
	$LF
	[br 
	]br
	$LF
	[br 
	]br
	$LF
]div
[div class= 
	[div class= 
		[ul class=nav nav-tabs role=tablist 
			[li class=nav-item 
				[a class=active nav-link data-bs-toggle=tab href=#tabs-416-0 
					"Table of contents
				]a
			]li
			[li class=nav-item 
				[a class=nav-link data-bs-toggle=tab href=#tabs-416-1 
					"Movies
				]a
			]li
			[li class=nav-item 
				[a class=nav-link data-bs-toggle=tab href=#tabs-416-2 
					"RAM Addresses List
				]a
			]li
		]ul
	]div
	[div class=tab-content 
		[div class=tab-pane fade active show id=tabs-416-0 
			[div class=card mb-2 
				[div class=card-header 
					[strong 
						"Table of contents
					]strong
				]div
				[div class=card-body 
					[ul 
						[li 
							[a href=#JumpGlitch 
								" The Jump Glitch
								$LF
							]a
						]li
						[li 
							[a href=#SpreadGunOptimizationHorizontalLevels 
								" Spread Gun Optimization - Horizontal levels
								$LF
							]a
						]li
						[li 
							[a href=#SpreadGunOptimization3dLevels 
								" Spread Gun optimization - 3D levels
								$LF
							]a
						]li
						[li 
							[a href=#GradualSpreadGunPatternSubstitution 
								" Gradual Spread Gun pattern substitution
								$LF
							]a
						]li
						[li 
							[a href=#BossBehavior 
								" Boss Behavior
								$LF
							]a
							[ul 
								[li 
									[a href=#GromaidesLevel3Boss 
										" Gromaides (Level 3 Boss)
										$LF
									]a
								]li
							]ul
						]li
						[li 
							[a href=#Rng 
								" RNG
								$LF
							]a
						]li
						[li 
							[a href=#ExternalLinks 
								" External links
								$LF
							]a
						]li
					]ul
				]div
			]div
		]div
		[div class=tab-pane fade id=tabs-416-1 
			[div class=p 
				[b 
					"Currently Published Movies
				]b
				$LF
				(displaymovie|game=18)
				$LF
			]div
		]div
		[div class=tab-pane fade id=tabs-416-2 
			[div class=p 
				"See also 
				[a href=http://acmlm.kafuka.org/board/thread.php?pid=126023#126023 rel=noopener external nofollow 
					"Trax's disassembly
				]a
				$LF
				"(
				[a href=https://www.bwass.org/romhack/contra/ rel=noopener external nofollow 
					"home page
				]a
				"),
				$LF
				"especially 
				[a href=https://www.bwass.org/romhack/contra/contrarammap.txt rel=noopener external nofollow 
					"contrarammap.txt
				]a
				".
				$LF
				"It is for the North American release.
				$LF
			]div
			[div class=p 
				"BizHawk .wch file: 
				(__wikiLink|href=/UserFiles/Info/637936906459604210|implicitdisplaytext=UserFiles/Info/637936906459604210)
				$LF
			]div
			[div class=p 
				"Known enemy sprite codes:
				$LF
			]div
			[table 
				[tbody 
					[tr 
						[td 
							"7A
						]td
						[td 
							"Arm segment of Gromaides (Level 3 boss)
						]td
					]tr
					[tr 
						[td 
							"7B
						]td
						[td 
							"Hand segment of Gromaides (Level 3 boss)
						]td
					]tr
				]tbody
			]table
		]div
	]div
]div
[hr 
]hr
[h3 id=JumpGlitch 
	" The Jump Glitch
	$LF
]h3
[div class=p 
	(youtube|align=right|h=148|hidelink=|loop=150|start=145|v=kXKniEJDXBM|w=197)
	$LF
	"In Stage 3 it is possible to jump to ledges normally impossible by taking advantage of vertical scrolling.  To perform it you jump, then press left, then hold right.  It seems random, but if you press right at the right frame, you will stay in air for longer than usual and can land on ledges that would normally take 2 jumps.  
	$LF
]div
[div class=p 
	"Conversely, this can also be used to jump shorter than normal.  This should be used on all other jumps in order to shave a frame from each one.  (In reality many of them can not be shaved this way).
	$LF
	[br 
	]br
	$LF
]div
[hr 
]hr
[h3 id=SpreadGunOptimizationHorizontalLevels 
	" Spread Gun Optimization - Horizontal levels
	$LF
]h3
[div class=p 
	[br 
	]br
	$LF
]div
[hr 
]hr
[h3 id=SpreadGunOptimization3dLevels 
	" Spread Gun optimization - 3D levels
	$LF
]h3
[div class=p 
	[br 
	]br
	$LF
]div
[hr 
]hr
[h3 id=GradualSpreadGunPatternSubstitution 
	" Gradual Spread Gun pattern substitution
	$LF
]h3
[div class=p 
	[br 
	]br
	$LF
]div
[hr 
]hr
[h3 id=BossBehavior 
	" Boss Behavior
	$LF
]h3
[div class=p 
	"Boss HP can only drop 1 HP per frame.  This means the strategy isn't as much about unloading bullets as fast as possible, but instead trying to make sure damage is registered every frame.
	$LF
]div
[h4 id=GromaidesLevel3Boss 
	" Gromaides (Level 3 Boss)
	$LF
]h4
[div class=p 
	"The arms of Gromaides occupy 10 enemy slots,
	$LF
	"one for each segment.
	$LF
	"The following enemy variable arrays have special meanings for this boss:
	$LF
]div
[table 
	[tbody 
		[tr 
			[td 
				"05A8
			]td
			[td 
				"0x00 = segment belongs to the left arm, 0x01 = segment belongs to the right arm (relative to the screen).
			]td
		]tr
		[tr 
			[td 
				"05C8
			]td
			[td 
				"Frame counter for each segment. Counts up to 16; then spawns the next arm segment and becomes 0xFF.
			]td
		]tr
		[tr 
			[td 
				"05D8
			]td
			[td 
				"Enemy slot index of the next arm segment, moving inward. 0xFF if this is the innermost segment (the "shoulder").
			]td
		]tr
		[tr 
			[td 
				"05E8
			]td
			[td 
				"Enemy slot index of the next arm segment, moving outward. 0xFF if this is the outermost segment (the "hand").
			]td
		]tr
	]tbody
]table
[div class=p 
	"The enemy variable arrays at 05D8 and 05E8
	$LF
	"form doubly linked lists of arm segments,
	$LF
	"one list for each arm.
	$LF
]div
[div class=p 
	"Some subroutine addresses:
	$LF
]div
[table 
	[tbody 
		[tr 
			[td 
				"9B7E
			]td
			[td 
				"Update function for initial arm extension. Has delay counters for spawning in each arm segment successively. Calls 9BDA to update the position of each spawned segment.
			]td
		]tr
		[tr 
			[td 
				"9BDA
			]td
			[td 
				"Arm segment position update function during initial extension. Adds ±0x0.B5 pixels to the 
				[em 
					"x
				]em
				"-coordinate (depending on whether left or right arm) and −0x0.B5 pixels to the 
				[em 
					"y
				]em
				"-coordinate of each spawned arm segment.
			]td
		]tr
		[tr 
			[td 
				"9C11
			]td
			[td 
				"Stores the sprite code to use for an arm segment in the corresponding slot in the 030A enemy variable array: 0x7A for an "arm" segment or 0x7B for a "hand" segment.
			]td
		]tr
	]tbody
]table
[h3 id=Rng 
	" RNG
	$LF
]h3
[div class=p 
	"The RNG variable at address 0034
	$LF
	"is updated by repeatedly adding to it the current frame counter (and carry flag),
	$LF
	"in an infinite loop
	$LF
	"until an 
	[a href=https://wiki.nesdev.com/w/index.php?title=NMI rel=noopener external nofollow 
		"NMI
	]a
	" (vblank) occurs.
	$LF
]div
[pre 
	"07:F880: A5 1A    LDA $1A    ; frame counter
	$LF
	"07:F882: 65 34    ADC $34    ; RNG
	$LF
	"07:F884: 85 34    STA $34
	$LF
	"07:F886: 4C 80 F8 JMP $F880
	$LF
]pre
[h3 id=ExternalLinks 
	" External links
	$LF
]h3
[ul 
	[li 
		" Series of articles by Allan Blomquist:
		$LF
		[ol 
			[li 
				" 
				[a href=https://tomorrowcorporation.com/posts/retro-game-internals rel=noopener external nofollow 
					"Introduction
				]a
				" – object model, level types, scrolling
				$LF
			]li
			[li 
				" 
				[a href=https://tomorrowcorporation.com/posts/retro-game-internals-contra-levels rel=noopener external nofollow 
					"Levels
				]a
				" – screens, supertiles, collision data, enemies
				$LF
			]li
			[li 
				" 
				[a href=https://tomorrowcorporation.com/posts/retro-game-internals-contra-random-enemies rel=noopener external nofollow 
					"Random Enemies
				]a
				" – random enemy spawns, respawn counter, weapon levels
				$LF
			]li
			[li 
				" 
				[a href=https://tomorrowcorporation.com/posts/contra-base-enemies rel=noopener external nofollow 
					"Base Enemies
				]a
				" – static enemies, sequenced enemies, power-up enemies
				$LF
			]li
			[li 
				" 
				[a href=https://tomorrowcorporation.com/posts/retro-game-internals-contra-collision-detection rel=noopener external nofollow 
					"Collision Detection
				]a
				" – object vs. object, object vs. level, 3D collision
				$LF
			]li
			[li 
				" 
				[a href=https://tomorrowcorporation.com/posts/retro-game-internals-contra-player-control rel=noopener external nofollow 
					"Player Control
				]a
				" – player physics, player states, control details
				$LF
			]li
			[li 
				" 
				[a href=https://tomorrowcorporation.com/posts/retro-game-internals-contra-conclusion rel=noopener external nofollow 
					"Conclusion
				]a
				" – RNG, structure of arrays, screen space coordinates, formulas for enemy HP and behavior, changes after multiple playthroughs
				$LF
			]li
		]ol
	]li
]ul
[ul 
	[li 
		[a href=https://www.youtube.com/watch?v=8LnwsYL7Apk rel=noopener external nofollow 
			"Contra - Behind the Code
		]a
		" – Konami code, "R" weapon upgrade, player bullet speed
		$LF
	]li
]ul
[ul 
	[li 
		[a href=https://github.com/vermiceli/nes-contra-us/ rel=noopener external nofollow 
			"https://github.com/vermiceli/nes-contra-us/
		]a
		" - An annotated disassembly with supplemental materials of the Contra (US) NES game.
		$LF
	]li
]ul
[div class=p 
	[br 
	]br
	$LF
]div
