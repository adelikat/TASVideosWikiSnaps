16
[div class=p 
	"The purpose of this page is to document all of the known tricks
	$LF
	"of NDS New Super Mario Bros so far.
	$LF
]div
[div class=p 
	"Because of the nature of this site, we concentrate here on tricks
	$LF
	"that are extremely difficult to execute in real play, but are useful
	$LF
	"in the making of tool-assisted speedruns. For most of the tricks,
	$LF
	"a 
	(__wikiLink|displaytext=frame advance|href=/Glossary)
	" feature in an emulator is a definite must-have.
	$LF
]div
[div class=p 
	[em 
		(__wikiLink|href=/TODO|implicitdisplaytext=TODO)
		": Make clips of these segments and cut the useless screen out.
	]em
	$LF
	[br 
	]br
	$LF
	[br 
	]br
	$LF
]div
[div class= 
	[div class= 
		[ul class=nav nav-tabs role=tablist 
			[li class=nav-item 
				[a class=active nav-link data-bs-toggle=tab href=#tabs-497-0 
					"Table of contents
				]a
			]li
			[li class=nav-item 
				[a class=nav-link data-bs-toggle=tab href=#tabs-497-1 
					"Movie
				]a
			]li
			[li class=nav-item 
				[a class=nav-link data-bs-toggle=tab href=#tabs-497-2 
					"RAM Addresses List
				]a
			]li
			[li class=nav-item 
				[a class=nav-link data-bs-toggle=tab href=#tabs-497-3 
					"Lua Scripts
				]a
			]li
		]ul
	]div
	[div class=tab-content 
		[div class=tab-pane fade active show id=tabs-497-0 
			[div class=card mb-2 
				[div class=card-header 
					[strong 
						"Table of contents
					]strong
				]div
				[div class=card-body 
					[ul 
						[li 
							[a href=#CornerBoosting 
								" Corner Boosting
								$LF
							]a
						]li
						[li 
							[a href=#TurningRightOnTheFlagpole 
								" Turning right on the flagpole
								$LF
							]a
						]li
						[li 
							[a href=#SpeedMechanics 
								" Speed Mechanics
								$LF
							]a
						]li
						[li 
							[a href=#WallSlidesAndWallJumps 
								" Wall slides and wall jumps
								$LF
							]a
						]li
						[li 
							[a href=#Rng 
								" RNG
								$LF
							]a
						]li
					]ul
				]div
			]div
		]div
		[div class=tab-pane fade id=tabs-497-1 
			[div class=p 
				(displaymovie|id=4647)
				$LF
			]div
		]div
		[div class=tab-pane fade id=tabs-497-2 
			[div class=p 
				"RAM values relevant to tricks/optimization. For the US version.
				$LF
			]div
			[ul 
				[li 
					" 021B6A90 - X speed (20.12 Fixed Point)
					$LF
				]li
				[li 
					" 021B6A3C - X position (20.12 Fixed Point)
					$LF
				]li
				[li 
					" 021B6AB0 - Y speed (20.12 Fixed Point)
					$LF
				]li
				[li 
					" 021B6A40 - Y position (20.12 Fixed Point)
					$LF
				]li
				[li 
					" 021B6A94 - Current max speed (20.12 Fixed Point)
					$LF
				]li
				[li 
					" 02088A68 - RNG (4 byte)
					$LF
				]li
				[li 
					" 020CC0EE - Rail position; where mario/luigi are on the progress bar (4 bytes)
					$LF
				]li
				[li 
					" 021B759B - Wall jump timer (1 byte)
					$LF
				]li
				[li 
					" 021B7597 - Wall action timer, wall to left of Mario (1 byte)
					$LF
				]li
				[li 
					" 021B7598 - Wall action timer, wall to right of Mario (1 byte)
					$LF
				]li
				[li 
					" 021B71D8 - Mario's height in pixels, for wall jumps (4 bytes)
					$LF
				]li
				[li 
					" 021B71BC - Mario's height in pixels, for bumping blocks(4 bytes)
					$LF
				]li
				[li 
					" 021B757F - Jump combo timer (for double/triple jumps) (1 byte)
					$LF
				]li
				[li 
					" 0208B350 - Starman timer (4 bytes)
					$LF
				]li
				[li 
					" 021B75A1 - Pipe timer left; must be 10 to enter left pipe (1 byte)
					$LF
				]li
				[li 
					" 021B75A2 - Pipe timer right; must be 10 to enter right pipe (1 byte)
					$LF
				]li
				[li 
					" 02088BD8 - Frame counter that pauses during stage transitions (e.g. doors) (4 bytes)
					$LF
				]li
				[li 
					" 020CA8B4 - In-game timer as seen in top-right (20.12 fixed point)
					$LF
				]li
			]ul
			[div class=p 
				"Speed and location units are in pixels. Blocks are 16x16 pixels, so displaying location values mod 16 is helpful.
				$LF
			]div
		]div
		[div class=tab-pane fade id=tabs-497-3 
			[div class=p 
				"Here are some Lua scripts for BizHawk that may be helpful.
				$LF
			]div
			[div class=p 
				"View information about currently spawned objects, such as location and speed of Mario, enemies, and star coins.
				$LF
				[a href=https://pastebin.com/h23Yhsym rel=noopener external nofollow 
					"https://pastebin.com/h23Yhsym
				]a
				$LF
			]div
			[div class=p 
				"See when and how many times RNG is used.
				$LF
				[a href=https://pastebin.com/ARAMDreP rel=noopener external nofollow 
					"https://pastebin.com/ARAMDreP
				]a
				$LF
			]div
		]div
	]div
]div
[hr 
]hr
[h3 id=CornerBoosting 
	" Corner Boosting
	$LF
]h3
[div class=p 
	(youtube|align=right|h=300|hidelink=|loop=84|start=54|v=kpUbnr3pSZ4|w=192)
	$LF
	[br 
	]br
	$LF
]div
[hr 
]hr
[h3 id=TurningRightOnTheFlagpole 
	" Turning right on the flagpole
	$LF
]h3
[div class=p 
	(youtube|align=right|h=300|hidelink=|loop=80|start=76|v=kpUbnr3pSZ4|w=192)
	$LF
	[br 
	]br
	$LF
]div
[hr 
]hr
[h3 id=SpeedMechanics 
	" Speed Mechanics
	$LF
]h3
[ul 
	[li 
		" Running Speed/Triple Jumping speed = 3.0 Pixels per frame
		$LF
	]li
	[li 
		" Shell Spinning speed = 2.75 Px/frame
		$LF
	]li
]ul
[div class=p 
	[em 
		(__wikiLink|href=/TODO|implicitdisplaytext=TODO)
		": finish this and turn into a table, and explain, and add RAM addresses
	]em
	$LF
]div
[hr 
]hr
[h3 id=WallSlidesAndWallJumps 
	" Wall slides and wall jumps
	$LF
]h3
[div class=p 
	"These are generally straight-forward, but there are some details that make it difficult in certain situations. Mario's ability to do these is affected by a variety of factors, including a "wall jump timer" and two "wall action timers", one for left walls and one for right walls. See RAM addresses at the top of this page for the address of the timer values.
	$LF
]div
[div class= 
	[div class= 
		[ul class=nav nav-tabs role=tablist 
			[li class=nav-item 
				[a class=active nav-link data-bs-toggle=tab href=#tabs-3040-0 
					"Requirements for wall actions and wall action timers
				]a
			]li
			[li class=nav-item 
				[a class=nav-link data-bs-toggle=tab href=#tabs-3040-1 
					"Wall jump timer
				]a
			]li
			[li class=nav-item 
				[a class=nav-link data-bs-toggle=tab href=#tabs-3040-2 
					"Wall action timers
				]a
			]li
			[li class=nav-item 
				[a class=nav-link data-bs-toggle=tab href=#tabs-3040-3 
					"Wall slides
				]a
			]li
			[li class=nav-item 
				[a class=nav-link data-bs-toggle=tab href=#tabs-3040-4 
					"Wall jumps
				]a
			]li
		]ul
	]div
	[div class=tab-content 
		[div class=tab-pane fade active show id=tabs-3040-0 
			[div class=p 
				"The wall action timers and the actions themselves all depend on various factors. Here is a list of requirements that apply to one or more of them.
				$LF
			]div
			[ol 
				[li 
					" Wall jump timer: This requirement is satisfied when the wall jump timer is 0 after the frame in question (e.g., the frame on which A is pressed for a wall jump).
					$LF
				]li
				[li 
					" Wall action timer: This requirement is satisfied when the wall action timer is non-zero both before and after the frame in question.
					$LF
				]li
				[li 
					" Floor: This requirement is satisfied when there is not a floor <= 16 pixels below Mario's Y location.
					$LF
				]li
				[li 
					" Wall collision: This requirement is satisfied when Mario is within the wall's collision space.
					$LF
				]li
				[li 
					" Height:
					$LF
					[ol 
						[li 
							" This requirement is satisfied if both (A) Mario is >= 19 pixels below the top of the wall (11 pixels if crouching) after the frame in question, and (B) Mario is < 4 pixels below the bottom of the wall after the frame in question.
							$LF
						]li
						[li 
							" Same as 5.1, except part (B) is BEFORE the frame in question.
							$LF
						]li
					]ol
				]li
				[li 
					" Crouch: This requirement is satisfied if Mario is not crouching.
					$LF
				]li
				[li 
					" Moved down:
					$LF
					[ol 
						[li 
							" This requirement is satisfied if Mario moved down during the frame in question.
							$LF
						]li
						[li 
							" Opposite 7.1, this requirement is satisfied if Mario did not move down during the frame in question.
							$LF
						]li
					]ol
				]li
				[li 
					" Facing wall: This requirement is satisfied if Mario was facing the wall before the frame in question, or if he would be at the end of current animations.
					$LF
				]li
				[li 
					" Horizontal movement: This requirement only ever applies if the wall is to the left of Mario.
					$LF
					[ol 
						[li 
							" This requirement is satisfied if Mario moved horizontally during the frame in question (movement counts even if the wall immediately pushed Mario back; thus holding left against a wall works).
							$LF
						]li
						[li 
							" Same as 9.1, but movement happened on the previous frame.
							$LF
						]li
					]ol
				]li
			]ol
		]div
		[div class=tab-pane fade id=tabs-3040-1 
			[div class=p 
				"This value must be zero before a wall jump or slide can be executed. The timer is set to 16 on the frame Mario begins a wall jump. It decreases by 1 each frame until 0.
				$LF
			]div
		]div
		[div class=tab-pane fade id=tabs-3040-2 
			[div class=p 
				"This value must be non-zero before a wall jump or slide can be executed.
				$LF
			]div
			[div class=p 
				"The timer is set to 16 when left/right (towards wall) is pressed and the following conditions are met:
				$LF
			]div
			[ul 
				[li 
					" #3 (Floor)
					$LF
				]li
				[li 
					" #4 (Wall collision)
					$LF
				]li
				[li 
					" #5.1 (Height)
					$LF
				]li
				[li 
					" #7.1 (Moved down)
					$LF
				]li
				[li 
					" #9.1 (Horizontal movement)
					$LF
				]li
			]ul
			[div class=p 
				"The timer decreases by 1 each frame until 0. The timer is automatically set to 0 if condition #3 (Floor) is no longer met. This means that both wall slides and jumps implicitly require condition #3 (Floor) as well. If Mario is currently doing a wall slide when this value reaches 0, the wall slide ends.
				$LF
			]div
		]div
		[div class=tab-pane fade id=tabs-3040-3 
			[div class=p 
				"A wall slide can be started by pressing left/right (towards wall) when the following conditions are met:
				$LF
			]div
			[ul 
				[li 
					" #1 (Wall jump timer)
					$LF
				]li
				[li 
					" #2 (Wall action timer)
					$LF
				]li
				[li 
					" #4 (Wall collision)
					$LF
				]li
				[li 
					" #5.2 (Height)
					$LF
				]li
				[li 
					" #6 (Crouch)
					$LF
				]li
				[li 
					" #8 (Facing wall)
					$LF
				]li
				[li 
					" #9.2 (Horizontal movement)
					$LF
				]li
			]ul
		]div
		[div class=tab-pane fade id=tabs-3040-4 
			[div class=p 
				"A wall jump can be done in either of two situations. Both require #1 (Wall jump timer) and #6 (Crouch).
				$LF
			]div
			[div class=p 
				"The first situation requires pressing A on the frame in question, and #2 (Wall action timer).
				$LF
			]div
			[div class=p 
				"The second situation requires pressing A and left/right (towards wall) on the frame in question, and:
				$LF
			]div
			[ul 
				[li 
					" #4 (Wall collision)
					$LF
				]li
				[li 
					" #7.2 (Not moved down)
					$LF
				]li
				[li 
					" #8 (Facing wall)
					$LF
				]li
				[li 
					" #9.2 (Horizontal movement)
					$LF
				]li
			]ul
			[div class=p 
				"Notes:
				$LF
			]div
			[ul 
				[li 
					" If a wall slide and a wall jump are activated on the same frame, the wall slide is activated first.
					$LF
				]li
				[li 
					" If a wall slide is active, vertical speed is set to 0 and the actual jump is delayed by one frame.
					$LF
				]li
			]ul
		]div
	]div
]div
[hr 
]hr
[h3 id=Rng 
	" RNG
	$LF
]h3
[ul 
	[li 
		" The starting RNG depends on the date and time you start the movie.
		$LF
	]li
	[li 
		" The RNG changes whenever certain sound effects are played, whether by Mario or the background music itself (though this depends on the level). Luck can always be manipulated 
		[b 
			"very frequently
		]b
		" - (though not always) by either double jumping, throwing something, wall jumping, and by breaking a block.
		$LF
	]li
]ul
[div class=p 
	"The RNG is currently known to affect:
	$LF
]div
[ul 
	[li 
		" The Red ? Block and Hammer Bros. movements on the world map
		$LF
	]li
	[li 
		" The movement of the Scuttlebugs
		$LF
	]li
	[li 
		" The movement of the bosses in Worlds 2-Castle, 3-Castle, and 5-Castle
		$LF
	]li
	[li 
		" The volcano rocks in World 8-8
		$LF
	]li
	[li 
		" When the final cutscene in World 8-Castle 2 (Bowser Jr. throwing Dry Bowser into the pot) activates.
		$LF
	]li
]ul
[div class=p 
	(__wikiLink|href=/TODO|implicitdisplaytext=TODO)
	", explain these:
	$LF
	"Ground pounding as mini-mario
	$LF
	"Super corner boosting
	$LF
	"Maintaining speed as a turtle shell
	$LF
	"Mini-mario corner boosting
	$LF
]div
