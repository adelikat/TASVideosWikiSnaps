7
[div class=card mb-2 
	[div class=card-header 
		[strong 
			"Table of contents
		]strong
	]div
	[div class=card-body 
		[ul 
			[li 
				[a href=#GameSpeed 
					" Game speed
					$LF
				]a
			]li
			[li 
				[a href=#EmulatorSettingsAndBoot 
					" Emulator settings and boot
					$LF
				]a
			]li
			[li 
				[a href=#BetweenStages 
					" Between stages
					$LF
				]a
			]li
			[li 
				[a href=#BossOrder 
					" Boss order
					$LF
				]a
			]li
			[li 
				[a href=#Mechanics 
					" Mechanics
					$LF
				]a
				[ul 
					[li 
						[a href=#Shooting 
							" Shooting
							$LF
						]a
					]li
					[li 
						[a href=#Physics 
							" Physics
							$LF
						]a
					]li
					[li 
						[a href=#SubTileAlignment 
							" Sub-tile alignment
							$LF
						]a
					]li
					[li 
						[a href=#VerticalCameraRecenteringDelay 
							" Vertical camera recentering delay
							$LF
						]a
					]li
					[li 
						[a href=#HorizontalCameraRecenteringDelay 
							" Horizontal camera recentering delay
							$LF
						]a
					]li
					[li 
						[a href=#ItemDrops 
							" Item drops
							$LF
						]a
					]li
					[li 
						[a href=#WeaponSelectScreen 
							" Weapon select screen
							$LF
						]a
					]li
				]ul
			]li
			[li 
				[a href=#VoltSkip 
					" Volt skip
					$LF
				]a
			]li
			[li 
				[a href=#Weapons 
					" Weapons
					$LF
				]a
				[ul 
					[li 
						[a href=#DamageChart 
							" Damage chart
							$LF
						]a
					]li
					[li 
						[a href=#NuclearDetonator 
							" Nuclear Detonator
							$LF
						]a
					]li
				]ul
			]li
			[li 
				[a href=#EnemyAi 
					" Enemy AI
					$LF
				]a
				[ul 
					[li 
						[a href=#Rng 
							" RNG
							$LF
						]a
					]li
					[li 
						[a href=#DataStructures 
							" Data structures
							$LF
						]a
					]li
					[li 
						[a href=#GuardDog 
							" Guard dog
							$LF
						]a
					]li
					[li 
						[a href=#SewerRat 
							" Sewer Rat
							$LF
						]a
					]li
					[li 
						[a href=#VoltMan 
							" Volt Man
							$LF
						]a
					]li
					[li 
						[a href=#DynaMan 
							" Dyna Man
							$LF
						]a
					]li
				]ul
			]li
			[li 
				[a href=#UnderexploredGlitches 
					" Underexplored glitches
					$LF
				]a
				[ul 
					[li 
						[a href=#LackOfCollisionWithForceField 
							" Lack of collision with Force Field
							$LF
						]a
					]li
					[li 
						[a href=#DeathWarp 
							" Death warp
							$LF
						]a
					]li
					[li 
						[a href=#TriggerTileReentrancy 
							" Trigger tile reentrancy
							$LF
						]a
					]li
					[li 
						[a href=#WallClip 
							" Wall clip
							$LF
						]a
					]li
					[li 
						[a href=#OutOfBounds 
							" Out of bounds
							$LF
						]a
					]li
				]ul
			]li
			[li 
				[a href=#Maps 
					" Maps
					$LF
				]a
			]li
			[li 
				[a href=#MemoryAddresses 
					" Memory addresses
					$LF
				]a
			]li
			[li 
				[a href=#Resources 
					" Resources
					$LF
				]a
			]li
		]ul
	]div
]div
[h2 id=GameSpeed 
	" Game speed
	$LF
]h2
[div class=p 
	"Mega Man is one of those games that just 
	(__wikiLink|displaytext=runs too fast|href=/Forum/Posts/473252)
	".
	$LF
	"It technically 
	[em 
		"is
	]em
	" screen refresh–limited,
	$LF
	"but its "natural" speed of one frame per refresh is too fast to be humanly playable.
	$LF
	(__wikiLink|displaytext=Ilari explained it|href=/Forum/Posts/480224)
	": "There are games that fail to sensibly limit themselves, and altough the effective framerate saturates at some point, that saturation point is unplayably fast."
	$LF
	"A faster CPU setting would reduces load times, but not increase the speed of gameplay.
	$LF
]div
[div class=p 
	"To produce an encode that runs slower and is more pleasant to watch,
	$LF
	"without messing up the sound effects too much,
	$LF
	"you can use the "soundhack" script under 
	(__wikiLink|displaytext=Resources|href=/GameResources/DOS/MegaMan#Resources)
	".
	$LF
]div
[div class=p 
	"By the way, for casual play, you can fix the game's speed with
	$LF
	"Brad Smith's 
	[a href=https://github.com/bbbradsmith/mmpatch rel=noopener external nofollow 
		"speed patch
	]a
	".
	$LF
]div
[h2 id=EmulatorSettingsAndBoot 
	" Emulator settings and boot
	$LF
]h2
[div class=p 
	"In the 
	(__wikiLink|displaytext=JPC-RR assembly window|href=/EmulatorResources/JPC#AssemblingTheVirtualSystem)
	",
	$LF
	"put the Mega Man image on Hdd and FreeDOS on fda.
	$LF
	"Clear the "Modules" box—this game doesn't need need sound card, FPU, MIDI.
	$LF
]div
[div class=p 
	"At the prompt
	$LF
]div
[pre 
	[code 
		$UNPRINTABLE TEXT!!!
	]code
]pre
[div class=p 
	"press F8 to run fdconfig.sys, then answer 
	[em 
		"n
	]em
	" to all of the prompts.
	$LF
]div
[pre 
	[code 
		$UNPRINTABLE TEXT!!!
	]code
]pre
[div class=p 
	"For some reason, running fdconfig.sys and declining all the options shortens load times between stages.
	$LF
	"More info: 
	(__wikiLink|href=/Forum/Posts/479329|implicitdisplaytext=Forum/Posts/479329)
	", 
	(__wikiLink|href=/Forum/Posts/478684|implicitdisplaytext=Forum/Posts/478684)
	".
	$LF
]div
[div class=p 
	"The setup menu (where you choose VGA and disable the joystick)
	$LF
	"is not frame-oriented, unlike the game itself.
	$LF
	"It's just a loop that polls a global variable that is set by the keyboard interrupt handler.
	$LF
	"This means that you can provide inputs much faster than one per frame—but you have to go slow enough that the loop notices one of your inputs before you provide the next one.
	$LF
	"The setupmenu.lua script under 
	(__wikiLink|displaytext=Resources|href=/GameResources/DOS/MegaMan#Resources)
	" can automatically optimize this menu.
	$LF
]div
[h2 id=BetweenStages 
	" Between stages
	$LF
]h2
[div class=p 
	"You can press and release Space right after finishing the setup menu.
	$LF
	"You don't have to wait for the title screen to appear.
	$LF
]div
[div class=p 
	"The stage select screen recognizes inputs when you 
	[em 
		"release
	]em
	" a key.
	$LF
	"So if you want to select Sonic Man, you should press Left and Enter
	$LF
	[em 
		"before
	]em
	" the stage select appears, then release at the earliest moment at which the game recognizes the input.
	$LF
	"This is not necessarily on a frame boundary, so you need to use sub-frame inputs.
	$LF
	"Find the earliest frame at which the input is recognized, then load a savestate
	$LF
	"and go back to one frame earlier.
	$LF
	"Try pressing/releasing the Up key 9 times before releasing Left and Enter.
	$LF
	"If it works, try again with pressing/releasing Up 8 times, and so on.
	$LF
	"Each press/release of Up takes about 1/10th of a frame—this
	$LF
	"is an easy way push inputs later in a frame, if they are not recognized at the beginning of a frame.
	$LF
]div
[div class=p 
	"The same rule applies at the beginning of each stage.
	$LF
	"It may appear that you can start moving 1 frame before the stage appears onscreen.
	$LF
	"But usually you can start moving 1.
	[em 
		"x
	]em
	" frames before the stage appears,
	$LF
	"by using sub-frame inputs in the frame prior.
	$LF
]div
[div class=p 
	"Sub-frame inputs don't seem to help at the "weapon get" screen.
	$LF
]div
[div class=p 
	"After defeating a Robot Master, jumping to collect the card key
	$LF
	"will shorten the animation of it falling to you.
	$LF
]div
[h2 id=BossOrder 
	" Boss order
	$LF
]h2
[div class=p 
	"The 
	(__wikiLink|displaytext=Volt skip|href=/GameResources/DOS/MegaMan#VoltSkip)
	" requires an E Tank from
	$LF
	"Sonic Man's stage, so Sonic must come before Volt.
	$LF
	"Therefore the only orders worth considering are:
	$LF
]div
[ul 
	[li 
		" Sonic, Volt, Dyna
		$LF
	]li
	[li 
		" Sonic, Dyna, Volt
		$LF
	]li
	[li 
		" Dyna, Sonic, Volt
		$LF
	]li
]ul
[div class=p 
	"Current runs use SVD. SDV seems strictly inferior to SVD,
	$LF
	"because Dyna Man's stage benefits from the Force Field
	$LF
	"but Volt Man's stage doesn't benefit from the Nuclear Detonator.
	$LF
	"DSV is worth considering: the Dyna stage and boss fight would be slower,
	$LF
	"but the Sonic boss fight would be faster.
	$LF
]div
[h2 id=Mechanics 
	" Mechanics
	$LF
]h2
[h3 id=Shooting 
	" Shooting
	$LF
]h3
[div class=p 
	"Press and release Space in the same frame in order to shoot every frame.
	$LF
]div
[h3 id=Physics 
	" Physics
	$LF
]h3
[div class=p 
	"Mega Man accelerates horizontally at 2 pixels/frame/frame
	$LF
	"up to a maximum speed of 8 pixels/frame.
	$LF
	"Releasing an arrow key, or pressing the opposite direction,
	$LF
	"sets your horizontal speed to 0 immediately (instant deceleration).
	$LF
]div
[div class=p 
	"In most places, vertical acceleration due to gravity is 3 pixels/frame/frame.
	$LF
	"Mega Man stops accelerating when he reaches a speed of 15 pixels/frame downwards.
	$LF
	"When jumping down a ledge, it's usually best to jump
	$LF
	"as early and as high as possible,
	$LF
	"so that you're already falling down at maximum speed when you reach the ledge.
	$LF
]div
[div class=p 
	"Mega Man's apparent position lags 1 frame behind his actual position
	$LF
	"(use the HUD script under 
	(__wikiLink|displaytext=Resources|href=/GameResources/DOS/MegaMan#Resources)
	" to see this).
	$LF
	"When landing from a jump, you can jump again
	$LF
	"as soon as Mega Man's within-tile 
	[em 
		"y
	]em
	" position is 3;
	$LF
	"e.g. a 
	[em 
		"y
	]em
	" position of 819 is 51 3/16 when expressed in terms of tiles.
	$LF
	"If you do it right, Mega Man will jump again
	$LF
	"without ever entering his running animation.
	$LF
	"This matters, for example, on backwards conveyors,
	$LF
	"which slow you down as long as you are on the ground.
	$LF
]div
[div class=p 
	[img alt=An animation of Mega Man jumping forward over a backwards conveyor, comparing the earliest possible jumps with jumps that are 1 frame slower. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mmdos-conveyor-jump.gif 
	]img
	$LF
]div
[div class=p 
	"Some tiles are programmed to push Mega Man horizontally.
	$LF
	"Solid pusher tiles (conveyor belts) only push while you are standing on them;
	$LF
	"passable pusher tiles (like underwater in Sonic Man's stage)
	$LF
	"push as you pass through them.
	$LF
	"On either side of every conveyor there are single passable tiles
	$LF
	"that push in the same direction as the conveyor.
	$LF
	"Examples are highlighted in the screenshot below.
	$LF
	"Avoid touching these tiles when they push backwards.
	$LF
]div
[div class=p 
	[img alt=A screenshot of a conveyor belt, with the non-solid tiles at either end highlighted with arrows to show that they push in the same direction as the conveyor. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mmdos-conveyor-extension.png 
	]img
	$LF
]div
[div class=p 
	"Some places have lower gravitational acceleration than 3 pixels/frame/frame,
	$LF
	"for instance underwater in Sonic Man's stage.
	$LF
	"Whenever gravity is 
	[a href=https://tcrf.net/Mega_Man_(DOS)#Gravity rel=noopener external nofollow 
		"zero or negative
	]a
	",
	$LF
	"you can affect Mega Man's vertical speed by pressing the Up and Down keys.
	$LF
	"This is only useful in one place: the vertical fan shaft in Sonic Man's stage.
	$LF
	"Hold the Up key to accelerate to maximum speed 1 frame faster.
	$LF
]div
[h3 id=SubTileAlignment 
	" Sub-tile alignment
	$LF
]h3
[div class=p 
	"Tiles are 16 pixels wide.
	$LF
	"Because Mega Man accelerates in units of 2 pixels,
	$LF
	"This means that under normal circumstances, if you have even pixel alignment, it will stay even;
	$LF
	"and if you have odd alignment, it will stay odd.
	$LF
	"The only way to change your alignment is to run into a wall
	$LF
	"(going left makes the alignment even; going right makes it odd)
	$LF
	"or grab a ladder (makes it even).
	$LF
]div
[div class=p 
	"Having the right sub-tile alignment may allow you to,
	$LF
	"for example,
	$LF
	"start accelerating horizontally 1 frame earlier when exiting a vertical shaft.
	$LF
	"Changing your 
	[em 
		"x
	]em
	" position by any amount other than 8 pixels
	$LF
	"requires slowing down, so it's only worth doing when you are otherwise
	$LF
	"stopped from making immediate progress.
	$LF
]div
[div class=p 
	"To adjust your position by:
	$LF
]div
[ul 
	[li 
		" 2 pixels: press Right, release Right, frame advance.
		$LF
	]li
	[li 
		" 4 pixels: press Right, release Right, frame advance, frame advance, press Right, release Right, frame advance.
		$LF
	]li
	[li 
		" 6 pixels: press Right, frame advance, frame advance, release Right, frame advance.
		$LF
	]li
	[li 
		" 8 pixels: just keep running; this is Mega Man's running speed.
		$LF
	]li
]ul
[h3 id=VerticalCameraRecenteringDelay 
	" Vertical camera recentering delay
	$LF
]h3
[div class=p 
	"Whenever Mega Man lands a jump from a lower to a higher platform,
	$LF
	"he freezes in place while the camera recenters on him vertically.
	$LF
	"It doesn't happen when jumping downward.
	$LF
	"The following animation stabilizes the camera
	$LF
	"to show the freezing effect.
	$LF
	"The only difference between the two examples is that
	$LF
	"the top one avoids low-to-high jumps as much as possible.
	$LF
]div
[div class=p 
	[img alt=An animation of Mega Man jumping across platforms, demonstrating how he freezes in place whenever the camera recenters itself. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mmdos-lava-jump.gif 
	]img
	$LF
]div
[div class=p 
	"Vertical camera recentering delay
	$LF
	"also affects the tops of ladders.
	$LF
	"You can diminish the delay by jumping at the top of the ladder,
	$LF
	"which partially scrolls the camera up,
	$LF
	"leaving it less distance to move when you touch the ground again.
	$LF
	"it doesn't help unless Mega Man has a certain amount of headroom.
	$LF
]div
[div class=p 
	[img alt=A split-screen animation comparing Mega Man jumping at the top of a ladder, and not jumping. The jumping one is a tile and a half faster. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mmdos-ladder-jump.gif 
	]img
	$LF
]div
[h3 id=HorizontalCameraRecenteringDelay 
	" Horizontal camera recentering delay
	$LF
]h3
[div class=p 
	"The only time horizontal camera recentering delay matters
	$LF
	"is after each of the Robot Master refights in Wily's stage.
	$LF
	"At the moment the camera starts moving, you want to be:
	$LF
]div
[ul 
	[li 
		" on the half of the screen nearest the exit gate
		$LF
	]li
	[li 
		" moving at full speed
		$LF
	]li
	[li 
		" with sub-tile alignment of 0 or 8
		$LF
	]li
]ul
[div class=p 
	"If you have bad alignment, the camera will take an extra frame to recenter itself. More info: 
	(__wikiLink|href=/Forum/Posts/478286|implicitdisplaytext=Forum/Posts/478286)
	".
	$LF
]div
[h3 id=ItemDrops 
	" Item drops
	$LF
]h3
[div class=p 
	"An item drop iterates the 
	(__wikiLink|displaytext=RNG|href=/GameResources/DOS/MegaMan#RNG)
	" once and chooses the item based on the most significant byte:
	$LF
]div
[table 
	[tbody 
		[tr 
			[td 
				"0 ≤ 
				[em 
					"x
				]em
				" < 4 
			]td
			[td 
				"1-up 
			]td
		]tr
		[tr 
			[td 
				"4 ≤ 
				[em 
					"x
				]em
				" < 24 
			]td
			[td 
				"large health 
			]td
		]tr
		[tr 
			[td 
				"24 ≤ 
				[em 
					"x
				]em
				" < 48 
			]td
			[td 
				"large weapon energy 
			]td
		]tr
		[tr 
			[td 
				"48 ≤ 
				[em 
					"x
				]em
				" < 88 
			]td
			[td 
				"small health 
			]td
		]tr
		[tr 
			[td 
				"88 ≤ 
				[em 
					"x
				]em
				" < 128 
			]td
			[td 
				"small weapon energy 
			]td
		]tr
		[tr 
			[td 
				"128 ≤ 
				[em 
					"x
				]em
				" < 256 
			]td
			[td 
				"nothing 
			]td
		]tr
	]tbody
]table
[h3 id=WeaponSelectScreen 
	" Weapon select screen
	$LF
]h3
[div class=p 
	"You can switch weapons without losing time.
	$LF
	"To switch to Sonic Wave, for example:
	$LF
	"press S, press Esc, frame advance; release S, release Esc, frame advance.
	$LF
	"Mega Man will continue moving at full speed during both of these frames.
	$LF
]div
[h2 id=VoltSkip 
	" Volt skip
	$LF
]h2
[div class=p 
	"You can skip most of Volt Man's stage
	$LF
	"using the E Tank from Sonic Man's stage
	$LF
	"to heal past a death barrier.
	$LF
	"Take damage from a spark while facing right,
	$LF
	"so that you stagger backwards into the wall.
	$LF
	"Press Escape on the frame before you lose all your health.
	$LF
	"On the next frame the weapon select menu will be open and you will have zero health.
	$LF
	"Use an E Tank and then select a weapon to close the weapon select menu.
	$LF
]div
[div class=p 
	[img alt=A screenshot of Mega Man falling toward the death barrier in Volt Man's stage, with the death tiles highlighted. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mmdos-voltman-death-barrier.png 
	]img
	$LF
]div
[div class=p 
	[img alt=Animation showing Volt skip. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mmdos-voltman-1etank-skip.gif 
	]img
	" 
	$LF
]div
[div class=p 
	(__wikiLink|displaytext=Forum post|href=/Forum/Posts/471887)
	" 
	[a href=https://archive.org/details/Mega_Man_DOS_speedrun_11_21_20180711_David_Fifield rel=noopener external nofollow 
		"RTA documentation
	]a
	$LF
]div
[div class=p 
	"The same trick would work to pass a death barrier in Dyna Man's stage,
	$LF
	"but you would have to farm a second E Tank and
	$LF
	(__wikiLink|displaytext=it's not quite worth it|href=/Forum/Posts/479471)
	".
	$LF
]div
[h2 id=Weapons 
	" Weapons
	$LF
]h2
[h3 id=DamageChart 
	" Damage chart
	$LF
]h3
[table 
	[tbody 
		[tr 
			[th 
				"Enemy 
			]th
			[th 
				"HP 
			]th
			[th 
				"P 
			]th
			[th 
				"S 
			]th
			[th 
				"V 
			]th
			[th 
				"D 
			]th
		]tr
		[tr 
			[td 
				"Guard dog 
			]td
			[td 
				" 8
			]td
			[td 
				" 1
			]td
			[td 
				" 1
			]td
			[td 
				" 1
			]td
			[td 
				" 1
			]td
		]tr
		[tr 
			[td 
				"Sewer Rat 
			]td
			[td 
				" 2
			]td
			[td 
				" 1
			]td
			[td 
				" 0
			]td
			[td 
				" ∞
			]td
			[td 
				" ∞
			]td
		]tr
		[tr 
			[td 
				"Sonic Man 
			]td
			[td 
				"32
			]td
			[td 
				" 1
			]td
			[td 
				" 0
			]td
			[td 
				" 2
			]td
			[td 
				"16
			]td
		]tr
		[tr 
			[td 
				"Volt Man  
			]td
			[td 
				"32
			]td
			[td 
				" 1
			]td
			[td 
				" 6
			]td
			[td 
				" 0
			]td
			[td 
				" 2
			]td
		]tr
		[tr 
			[td 
				"Dyna Man  
			]td
			[td 
				"32
			]td
			[td 
				" 2
			]td
			[td 
				" 1
			]td
			[td 
				" 6
			]td
			[td 
				" 0
			]td
		]tr
		[tr 
			[td 
				"Crorq     
			]td
			[td 
				"32
			]td
			[td 
				" 1
			]td
			[td 
				" 6
			]td
			[td 
				" 2
			]td
			[td 
				" 4
			]td
		]tr
		[tr 
			[td 
				"Wily      
			]td
			[td 
				"32
			]td
			[td 
				" 1
			]td
			[td 
				" 2
			]td
			[td 
				" 8
			]td
			[td 
				" 4
			]td
		]tr
	]tbody
]table
[h3 id=NuclearDetonator 
	" Nuclear Detonator
	$LF
]h3
[div class=p 
	"When you shoot the Nuclear Detonator, it starts a 
	[code 
		"weapon_counter
	]code
	" timer.
	$LF
	"After 16 frames, you can manually detonate it.
	$LF
	"After 96 frames, it will detonate automatically.
	$LF
]div
[h2 id=EnemyAi 
	" Enemy AI
	$LF
]h2
[h3 id=Rng 
	" RNG
	$LF
]h3
[div class=p 
	"The random number generator is duplicated for each stage,
	$LF
	"a copy of it appearing in each .bin file.
	$LF
	"It is the same algorithm everywhere (a linear congruential generator),
	$LF
	"but with a different seed in each stage.
	$LF
]div
[pre 
	[code class=language-c 
		$UNPRINTABLE TEXT!!!
	]code
]pre
[table 
	[tbody 
		[tr 
			[th 
				"stage 
			]th
			[th 
				" seed
			]th
		]tr
		[tr 
			[td 
				"SECUR 
			]td
			[td 
				" 0x7536
			]td
		]tr
		[tr 
			[td 
				"SONIC 
			]td
			[td 
				" 0x5f27
			]td
		]tr
		[tr 
			[td 
				"VOLT  
			]td
			[td 
				" 0x3a05
			]td
		]tr
		[tr 
			[td 
				"DYNA  
			]td
			[td 
				" 0x9d86
			]td
		]tr
		[tr 
			[td 
				"WILEY 
			]td
			[td 
				" 0xd975
			]td
		]tr
	]tbody
]table
[div class=p 
	"The fixed RNG per stage is convenient for TASing.
	$LF
	"It means that RNG from earlier stages does not carry over into later stages;
	$LF
	"the RNG is always in a known state at the beginning of a stage.
	$LF
	"When the game samples from the RNG,
	$LF
	"it tends to use the high-order bits,
	$LF
	"perhaps as mitigation against the weaknesses of a linear congruential generator.
	$LF
]div
[div class=p 
	"The RNG iterates at least once per frame.
	$LF
	"Enemy AI, item drops, and other random events may iterate it more.
	$LF
]div
[h3 id=DataStructures 
	" Data structures
	$LF
]h3
[div class=p 
	"Enemies, pickups, and other objects use a common 28-byte data structure.
	$LF
	"Each stage (.bin file) contains an array of these data structures,
	$LF
	"with one element for each thing that can appear in the stage.
	$LF
	"Fields may have different meanings for different types of enemies.
	$LF
]div
[pre 
	[code class=language-c 
		$UNPRINTABLE TEXT!!!
	]code
]pre
[div class=p 
	"The 18-byte data structure that 
	[code 
		"current_frm
	]code
	" points to contains the actor's current bitmap,
	$LF
	"and also hitbox dimensions.
	$LF
]div
[pre 
	[code class=language-c 
		$UNPRINTABLE TEXT!!!
	]code
]pre
[h3 id=GuardDog 
	" Guard dog
	$LF
]h3
[div class=p 
	"The guard dog's AI subroutine starts at offset 0x56c in SECUR.BIN.
	$LF
]div
[div class=p 
	"The guard dog in the intro stage is unlike other enemies
	$LF
	"in that it can only be damaged once per frame.
	$LF
]div
[h3 id=SewerRat 
	" Sewer Rat
	$LF
]h3
[div class=p 
	"The Sewer Rat AI subroutine starts at offset 0x1912 in SONIC.BIN.
	$LF
]div
[pre 
	[code class=language-c 
		$UNPRINTABLE TEXT!!!
	]code
]pre
[h3 id=VoltMan 
	" Volt Man
	$LF
]h3
[div class=p 
	"Volt Man's AI subroutine starts at offset 0x2204 in VOLT.BIN,
	$LF
	"or offset 0x235b in WILEY.BIN.
	$LF
]div
[div class=p 
	"Volt Man's initial jump is random.
	$LF
	"The 
	[em 
		"x
	]em
	" speed is random in {−4, −6} (or {+4, +6} in the Wily-stage refight).
	$LF
	"The 
	[em 
		"y
	]em
	" speed is random in {−14, −16}.
	$LF
	"The 
	[em 
		"x
	]em
	" speed doesn't matter, but the smaller jump is 2 frames faster.
	$LF
]div
[h3 id=DynaMan 
	" Dyna Man
	$LF
]h3
[div class=p 
	"Dyna Man's AI subroutine starts at offset 0x1fdb in DYNA.BIN,
	$LF
	"or offset 0x2a1a in WILEY.BIN.
	$LF
]div
[div class=p 
	"Dyna Man's initial jump is random.
	$LF
	"The 
	[em 
		"x
	]em
	" speed is random in {−4, −5, −6, −7}.
	$LF
	"The 
	[em 
		"y
	]em
	" speed is random in {−7, −9, −11, −13}.
	$LF
	"Ideally, you want him to jump towards you as fast as possible
	$LF
	"(so he gets close enough to use the Force Field on him),
	$LF
	"and low enough that he remains in reach of Mega Man's jump.
	$LF
]div
[h2 id=UnderexploredGlitches 
	" Underexplored glitches
	$LF
]h2
[h3 id=LackOfCollisionWithForceField 
	" Lack of collision with Force Field
	$LF
]h3
[div class=p 
	"Sometimes, in the corridor before Volt Man in Wily's stage,
	$LF
	"the Force Field will pass through enemies rather than destroying them.
	$LF
	"It's not known why this happens or under what circumstances,
	$LF
	"except that it has something to do with having used the Nuclear Detonator.
	$LF
	"You can see it in Lizstar's AGDQ 2019 run:
	$LF
]div
[ul 
	[li 
		" 
		[a href=https://www.youtube.com/watch?v=tbs6PEgXEJg&t=665s rel=noopener external nofollow 
			"https://www.youtube.com/watch?v=tbs6PEgXEJg&t=665s
		]a
		$LF
	]li
]ul
[h3 id=DeathWarp 
	" Death warp
	$LF
]h3
[div class=p 
	"Trigger tiles are special map tiles that do something when Mega Man passes over them,
	$LF
	"for example spawning the enemies for the next room or activating a checkpoint.
	$LF
	"You can see the trigger tiles with the 
	(__wikiLink|displaytext=HUD script|href=/GameResources/DOS/MegaMan#Resources)
	$LF
	"or in the annotated 
	(__wikiLink|displaytext=Maps|href=/GameResources/DOS/MegaMan#Maps)
	".
	$LF
	"A minor death warp is possible with a least one checkpoint,
	$LF
	"where the checkpoint is located a tiny bit farther ahead in the stage.
	$LF
]div
[div class=p 
	[img alt=An animation of Mega Man entering the bat cave in Sonic Man's stage, dying with F10, and respawning a few tiles down and to the left of where he was. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mmdos-sonicman-death-warp.gif 
	]img
	$LF
]div
[h3 id=TriggerTileReentrancy 
	" Trigger tile reentrancy
	$LF
]h3
[div class=p 
	"I found a bug having to do with activating a trigger tile twice.
	$LF
	"After the fan shaft in Sonic Man's stage,
	$LF
	"there is a trigger tile in the downward tube at coordinates (79, 15)
	$LF
	"that spawns the Sewer Rat and makes the wall blasters start shooting.
	$LF
	"The 
	(__wikiLink|displaytext=Sewer Rat AI|href=/GameResources/DOS/MegaMan#SewerRat)
	" is supposed to work like this:
	$LF
	"walk for 
	[code 
		"rand(32, 64)
	]code
	" frames, stand for 
	[code 
		"rand(8, 16)
	]code
	" frames, repeat.
	$LF
	"If you jump straight down into the room (touching the trigger tile only once),
	$LF
	"that is the behavior you'll see.
	$LF
	"But if you walk off the edge at an angle (touching the trigger tile twice),
	$LF
	"you'll instead see the rat walk for about 256 frames before starting
	$LF
	"its normal cycle.
	$LF
	"It happens because the rat gets reinitialized after it has already started its AI cycle,
	$LF
	"and an integer underflow occurs.
	$LF
	"Abusing the glitch doesn't help here,
	$LF
	"because you want the rat to stand anyway
	$LF
	"so it's easier to damage-boost past it.
	$LF
	"But possibly there are other such bugs in other places.
	$LF
]div
[div class=p 
	"The trigger tile callback in question starts at offset 0x9f5 in SONIC.BIN.
	$LF
	"The portion having to do with the Sewer Rat is:
	$LF
]div
[pre 
	[code class=language-c 
		$UNPRINTABLE TEXT!!!
	]code
]pre
[div class=p 
	"The first time Mega Man hits the trigger tile,
	$LF
	"the rat is in the walking state with 
	[code 
		"counter_1
	]code
	" = 0.
	$LF
	"The first call to the 
	(__wikiLink|displaytext=Sewer Rat AI|href=/GameResources/DOS/MegaMan#SewerRat)
	$LF
	"underflows 
	[code 
		"counter_1
	]code
	" = 255 and transitions to the standing state.
	$LF
	"But then if Mega Man hits the trigger tile a second time,
	$LF
	"it forces the rat back into the walking state,
	$LF
	"but without resetting 
	[code 
		"counter_1
	]code
	".
	$LF
	"So now the rat will walk for 255 frames.
	$LF
]div
[h3 id=WallClip 
	" Wall clip
	$LF
]h3
[div class=p 
	"While climbing a ladder, hold Right and J (jump).
	$LF
	"At the top of the ladder, release Up, and you'll clip one tile into the solid wall on the right.
	$LF
	"It doesn't work going left.
	$LF
]div
[div class=p 
	[img alt=An animation of Mega Man reaching the top of the long ladder in Dyna Man's stage, and clipping into the solid tile on the right. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mmdos-ladder-clip.gif 
	]img
	$LF
]div
[h3 id=OutOfBounds 
	" Out of bounds
	$LF
]h3
[div class=p 
	"After traversing the death barrier in Volt Man's stage,
	$LF
	"if you go left rather than right
	$LF
	"you'll end up out of bounds,
	$LF
	"off the left edge of the stage.
	$LF
	"There are some invisible solid platforms there.
	$LF
]div
[div class=p 
	[img alt=An animation of Mega Man traversing the death barrier in Volt Man's stage using the E Tank trick, and moving left to stand atop the pole at the left of the stage. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mmdos-voltman-1etank-skip.gif 
	]img
	$LF
]div
[h2 id=Maps 
	" Maps
	$LF
]h2
[ul 
	[li 
		" 
		[a href=https://www.bamsoftware.com/computers/tasvideos/mmdos-secur.map.16.png? rel=noopener external nofollow 
			"SECUR
		]a
		" (
		[a href=https://www.bamsoftware.com/computers/tasvideos/mmdos-secur.map-annotated.16.png? rel=noopener external nofollow 
			"annotated
		]a
		")
		$LF
	]li
	[li 
		" 
		[a href=https://www.bamsoftware.com/computers/tasvideos/mmdos-sonic.map.16.png? rel=noopener external nofollow 
			"SONIC
		]a
		" (
		[a href=https://www.bamsoftware.com/computers/tasvideos/mmdos-sonic.map-annotated.16.png? rel=noopener external nofollow 
			"annotated
		]a
		")
		$LF
	]li
	[li 
		" 
		[a href=https://www.bamsoftware.com/computers/tasvideos/mmdos-volt.map.16.png? rel=noopener external nofollow 
			"VOLT
		]a
		" (
		[a href=https://www.bamsoftware.com/computers/tasvideos/mmdos-volt.map-annotated.16.png? rel=noopener external nofollow 
			"annotated
		]a
		")
		$LF
	]li
	[li 
		" 
		[a href=https://www.bamsoftware.com/computers/tasvideos/mmdos-dyna.map.16.png? rel=noopener external nofollow 
			"DYNA
		]a
		" (
		[a href=https://www.bamsoftware.com/computers/tasvideos/mmdos-dyna.map-annotated.16.png? rel=noopener external nofollow 
			"annotated
		]a
		")
		$LF
	]li
	[li 
		" 
		[a href=https://www.bamsoftware.com/computers/tasvideos/mmdos-wiley.map.16.png? rel=noopener external nofollow 
			"WILEY
		]a
		" (
		[a href=https://www.bamsoftware.com/computers/tasvideos/mmdos-wiley.map-annotated.16.png? rel=noopener external nofollow 
			"annotated
		]a
		")
		$LF
	]li
]ul
[div class=p 
	"Static maps don't tell the whole story.
	$LF
	"For example, in Sonic Man's stage,
	$LF
	"if you use the Nuclear Detonator to break into the large secret chamber,
	$LF
	"the game will build a wall inside it,
	$LF
	"preventing you from going all the way through.
	$LF
]div
[div class=p 
	"Annotations (see map/main.go under 
	(__wikiLink|displaytext=Resources|href=/GameResources/DOS/MegaMan#Resources)
	" for details about flags):
	$LF
]div
[ul 
	[li 
		" center gray: tile ID
		$LF
	]li
	[li 
		" upper-left magenta: Flags0: animation/destructibility
		$LF
	]li
	[li 
		" upper-right yellow: Flags1: solidity, 0x80=trigger, 0x40=masked, 0x01=climbable
		$LF
	]li
	[li 
		" lower-left red: Flags2: contact damage
		$LF
	]li
	[li 
		" lower-right cyan: Flags3: physics, upper nibble is horizontal push, lower nibble is vertical gravity
		$LF
	]li
]ul
[h2 id=MemoryAddresses 
	" Memory addresses
	$LF
]h2
[div class=p 
	"Base memory addresses differ depending on whether you
	$LF
	"have loaded HIMEM during boot.
	$LF
	"As far as we can tell, it's faster 
	[em 
		"not
	]em
	" to load HIMEM.
	$LF
]div
[div class=p 
	"Without HIMEM:
	$LF
]div
[table 
	[tbody 
		[tr 
			[td 
				[code 
					"SEG_000
				]code
				"  
			]td
			[td 
				" 0x2f970
			]td
		]tr
		[tr 
			[td 
				[code 
					"MAP_AREA
				]code
				" 
			]td
			[td 
				" 0x3859e
			]td
		]tr
		[tr 
			[td 
				[code 
					"BIN_AREA
				]code
				" 
			]td
			[td 
				" 0x5f870
			]td
		]tr
	]tbody
]table
[div class=p 
	"With HIMEM:
	$LF
]div
[table 
	[tbody 
		[tr 
			[td 
				[code 
					"SEG_000
				]code
				"  
			]td
			[td 
				" 0x5380
			]td
		]tr
		[tr 
			[td 
				[code 
					"MAP_AREA
				]code
				" 
			]td
			[td 
				" 0xdfae
			]td
		]tr
		[tr 
			[td 
				[code 
					"BIN_AREA
				]code
				" 
			]td
			[td 
				" 0x35280
			]td
		]tr
	]tbody
]table
[table 
	[tbody 
		[tr 
			[td 
				[code 
					"camera_x
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x8c04
			]td
		]tr
		[tr 
			[td 
				[code 
					"camera_y
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x8c0a
			]td
		]tr
		[tr 
			[td 
				[code 
					"camera_target_x
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x8c16
			]td
		]tr
		[tr 
			[td 
				[code 
					"camera_target_y
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x8c1c
			]td
		]tr
		[tr 
			[td 
				[code 
					"megaman_x
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x10db7
			]td
		]tr
		[tr 
			[td 
				[code 
					"megaman_y
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x10db9
			]td
		]tr
		[tr 
			[td 
				[code 
					"megaman_frm
				]code
				" (current bitmap)
			]td
			[td 
				" ptr 
				[code 
					"SEG_000
				]code
				" + 0x10dbb
			]td
		]tr
		[tr 
			[td 
				[code 
					"megaman_hp
				]code
				" 
			]td
			[td 
				" byte 
				[code 
					"SEG_000
				]code
				" + 0x10dbd
			]td
		]tr
		[tr 
			[td 
				[code 
					"megaman_x_vel
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x10dcf
			]td
		]tr
		[tr 
			[td 
				[code 
					"megaman_y_vel
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x10dd1
			]td
		]tr
		[tr 
			[td 
				[code 
					"player_shot_1.x
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x10dd3
			]td
		]tr
		[tr 
			[td 
				[code 
					"player_shot_1.y
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x10dd5
			]td
		]tr
		[tr 
			[td 
				[code 
					"player_shot_2.x
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x10def
			]td
		]tr
		[tr 
			[td 
				[code 
					"player_shot_2.y
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x10df1
			]td
		]tr
		[tr 
			[td 
				[code 
					"player_shot_3.x
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x10e0b
			]td
		]tr
		[tr 
			[td 
				[code 
					"player_shot_3.y
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"SEG_000
				]code
				" + 0x10e0d
			]td
		]tr
		[tr 
			[td 
				[code 
					"weapon_counter
				]code
				" (used for Nuclear Detonator timer) 
			]td
			[td 
				" byte 
				[code 
					"SEG_000
				]code
				" + 0x10de7
			]td
		]tr
		[tr 
			[td 
				[code 
					"explosion_counter
				]code
				" 
			]td
			[td 
				" byte 
				[code 
					"SEG_000
				]code
				" + 0x10f15
			]td
		]tr
		[tr 
			[td 
				[code 
					"num_lives
				]code
				" 
			]td
			[td 
				" byte 
				[code 
					"SEG_000
				]code
				" + 0x115b1
			]td
		]tr
		[tr 
			[td 
				[code 
					"num_etanks
				]code
				" 
			]td
			[td 
				" byte 
				[code 
					"SEG_000
				]code
				" + 0x115b2
			]td
		]tr
		[tr 
			[td 
				[code 
					"stages_finished
				]code
				" 0x40=SECUR 0x01=SONIC 0x02=VOLT 0x04=DYNA 
			]td
			[td 
				" byte 
				[code 
					"SEG_000
				]code
				" + 0x115b3
			]td
		]tr
		[tr 
			[td 
				[code 
					"current_weapon
				]code
				" 0=P 1=S 2=V 3=D 
			]td
			[td 
				" byte 
				[code 
					"SEG_000
				]code
				" + 0x115b5
			]td
		]tr
		[tr 
			[td 
				[code 
					"weapon_energy_S
				]code
				" 
			]td
			[td 
				" byte 
				[code 
					"SEG_000
				]code
				" + 0x115b7
			]td
		]tr
		[tr 
			[td 
				[code 
					"weapon_energy_V
				]code
				" 
			]td
			[td 
				" byte 
				[code 
					"SEG_000
				]code
				" + 0x115b8
			]td
		]tr
		[tr 
			[td 
				[code 
					"weapon_energy_D
				]code
				" 
			]td
			[td 
				" byte 
				[code 
					"SEG_000
				]code
				" + 0x115b9
			]td
		]tr
		[tr 
			[td 
				[code 
					"setup_menu_settings
				]code
				" 
			]td
			[td 
				" byte 
				[code 
					"SEG_000
				]code
				" + 0x18b90
			]td
		]tr
	]tbody
]table
[div class=p 
	[code 
		"setup_menu_settings
	]code
	" bit 0x08 is a global invincibility flag.
	$LF
	"It can be convenient to set that bit when you're trying something out
	$LF
	"without wanting to worry about damage.
	$LF
]div
[table 
	[tbody 
		[tr 
			[td 
				[code 
					"stage_width
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"MAP_AREA
				]code
				" + 0x0
			]td
		]tr
		[tr 
			[td 
				[code 
					"stage_height
				]code
				" 
			]td
			[td 
				" word 
				[code 
					"MAP_AREA
				]code
				" + 0x4
			]td
		]tr
	]tbody
]table
[div class=p 
	"The per-stage variables are relative to 
	[code 
		"BIN_AREA
	]code
	" and vary across stages.
	$LF
]div
[table 
	[tbody 
		[tr 
			[th 
				"variable 
			]th
			[th 
				" 
			]th
			[th 
				"SECUR 
			]th
			[th 
				"SONIC 
			]th
			[th 
				"VOLT 
			]th
			[th 
				"DYNA 
			]th
			[th 
				"WILEY 
			]th
		]tr
		[tr 
			[td 
				[code 
					"rng_state
				]code
				" 
			]td
			[td 
				"word 
				[code 
					"BIN_AREA
				]code
				" +
			]td
			[td 
				"0x2fc 
			]td
			[td 
				"0x7d5 
			]td
			[td 
				"0xbf4 
			]td
			[td 
				"0xb01 
			]td
			[td 
				"0xb00 
			]td
		]tr
		[tr 
			[td 
				[code 
					"ACTORS
				]code
				" array 
			]td
			[td 
				[code 
					"BIN_AREA
				]code
				" +
			]td
			[td 
				"0x1ac 
			]td
			[td 
				"0x2ba 
			]td
			[td 
				"0x340 
			]td
			[td 
				"0x3a4 
			]td
			[td 
				"0x4a0 
			]td
		]tr
		[tr 
			[td 
				"SONIC 1st wall HP 
			]td
			[td 
				"byte 
				[code 
					"BIN_AREA
				]code
				" +
			]td
			[td 
				"N/A 
			]td
			[td 
				"0x793 
			]td
			[td 
				"N/A 
			]td
			[td 
				"N/A 
			]td
			[td 
				"N/A 
			]td
		]tr
		[tr 
			[td 
				"SONIC 2nd wall HP 
			]td
			[td 
				"byte 
				[code 
					"BIN_AREA
				]code
				" +
			]td
			[td 
				"N/A 
			]td
			[td 
				"0x799 
			]td
			[td 
				"N/A 
			]td
			[td 
				"N/A 
			]td
			[td 
				"N/A 
			]td
		]tr
	]tbody
]table
[div class=p 
	"Some of the notable actors in each stage:
	$LF
]div
[table 
	[tbody 
		[tr 
			[td 
				"SECUR guard dog 
			]td
			[td 
				[code 
					"ACTORS[10]
				]code
				" 
			]td
		]tr
		[tr 
			[td 
				"VOLT Volt Man 
			]td
			[td 
				[code 
					"ACTORS[40]
				]code
				" 
			]td
		]tr
		[tr 
			[td 
				"DYNA Dyna Man 
			]td
			[td 
				[code 
					"ACTORS[60]
				]code
				" 
			]td
		]tr
		[tr 
			[td 
				"WILEY Volt Man 
			]td
			[td 
				[code 
					"ACTORS[24]
				]code
				" 
			]td
		]tr
		[tr 
			[td 
				"WILEY Dyna Man 
			]td
			[td 
				[code 
					"ACTORS[47]
				]code
				" 
			]td
		]tr
	]tbody
]table
[h2 id=Resources 
	" Resources
	$LF
]h2
[div class=p 
	"Unorganized resources and reverse engineering tools,
	$LF
	"including a HUD script and an automatic optimization script.
	$LF
]div
[pre 
	[code 
		$UNPRINTABLE TEXT!!!
	]code
]pre
