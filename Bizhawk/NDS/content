16
[div class=card mb-2 
	[div class=card-header 
		[strong 
			"Table of contents
		]strong
	]div
	[div class=card-body 
		[ul 
			[li 
				[a href=#BiosFirmwareAndYou 
					" BIOS, Firmware, and You
					$LF
				]a
			]li
			[li 
				[a href=#FormatTheDsiNand 
					" Format the DSi NAND
					$LF
				]a
			]li
		]ul
	]div
]div
[div class=p 
	"The NDS core in BizHawk uses 
	[a href=https://github.com/Arisotura/melonDS rel=noopener external nofollow 
		"MelonDS
	]a
	", which is written primarily by Arisotura along with various contributors.
	$LF
]div
[h3 id=BiosFirmwareAndYou 
	" BIOS, Firmware, and You
	$LF
]h3
[div class=p 
	"The NDS uses 2 BIOS files and 1 firmware file. The 2 BIOS files contain various functions games may call, and the firmware file stores the code for the boot screen you would typically have when booting a real DS, along with various user settings.
	$LF
]div
[div class=p 
	"MelonDS uses 
	[a href=https://github.com/Arisotura/melonDS/tree/master/freebios rel=noopener external nofollow 
		"freebios
	]a
	" from DraStic when BIOS files are not provided. However, these are not perfect, and may result in graphical/audio bugs in a few games that the real BIOS does not have. It is recommended to use real BIOS files whenever possible.
	$LF
]div
[div class=p 
	"MelonDS will generate a firmware file with only user settings present. This is not bootable, but it is sufficient for most games. However, some games may not play nice with this fake firmware, and if you wish to change user settings midway through a movie, you would need to use a real firmware file (as that contains actual boot code). For such cases, you will need to use a real firmware file.
	$LF
]div
[div class=p 
	"However, using a real firmware file has potential issues. Often firmware gets hacked, and is thus unusable for TASing. Along with that, firmware has user settings which change, and the boot code is encrypted, so it's rather difficult to verify firmware is correct. BizHawk has special handling to check the integrity of firmware files using various internal firmware checksums, checks against hacked firmware files, and decrypting the firmware code and checking its hash against known good dumps, which should cover 99% of cases. Still, this is not perfect, so if you don't need to use real firmware, it's recommended to not use it.
	$LF
]div
[div class=p 
	"On a minor note, you must use real BIOS files when using real firmware, as freebios lacks the code to boot to firmware.
	$LF
]div
[h3 id=FormatTheDsiNand 
	" Format the DSi NAND
	$LF
]h3
[div class=p 
	"TODO: This section is probably not that needed once BizHawk 2.9.2/2.10 is out, as latest BizHawk dev builds can directly boot DSi (including DSiWare) titles.
	$LF
]div
[div class=p 
	"Every DSi has unique 
	[a href=https://en.wikipedia.org/wiki/Flash_memory#NAND_flash rel=noopener external nofollow 
		"NAND
	]a
	" and there's no definitive version that many authentic devices share, so there can't be a strict rule on which exact NAND you end up using.
	$LF
]div
[div class=p 
	"But since the NAND is a complex thing with many unknowns attached to it, the best way to create a semi-consistent environment is to wipe it with its 
	[em 
		"Format
	]em
	" option.
	$LF
]div
[div class=p 
	"BizHawk is unable to 
	[b 
		"write
	]b
	" to NAND, so you have to format the NAND using 
	[a href=https://melonds.kuribo64.net/downloads.php rel=noopener external nofollow 
		"melonDS
	]a
	" GUI.
	$LF
]div
[ol 
	[li 
		" Run melonDS
		$LF
	]li
	[li 
		" Go to 
		[em 
			"Config -> Emu settings
		]em
		$LF
		[ul 
			[li 
				" 
				[em 
					"General
				]em
				" tab -> 
				[em 
					"Console type
				]em
				" -> select 
				[em 
					"DSi
				]em
				$LF
			]li
			[li 
				" 
				[em 
					"DSi-mode
				]em
				" tab -> Specify paths to the 4 required files (in some unclear cases, melonDS may need file paths to not contain spaces)
				$LF
				[ul 
					[li 
						" 
						[em 
							"DSi ARM9 BIOS
						]em
						$LF
					]li
					[li 
						" 
						[em 
							"DSi ARM7 BIOS
						]em
						$LF
					]li
					[li 
						" 
						[em 
							"DSi firmware
						]em
						$LF
					]li
					[li 
						" 
						[em 
							"DSi NAND
						]em
						$LF
					]li
				]ul
			]li
		]ul
	]li
	[li 
		" Hit 
		[em 
			"OK
		]em
		$LF
	]li
	[li 
		" 
		[em 
			"File -> Boot firmware
		]em
		$LF
	]li
	[li 
		" If the NAND has been set up before, just navigate to 
		[em 
			"System Settings -> Format System Memory
		]em
		" and proceed to Format in all the menus. After melonDS has formatted your NAND, it will shut down the system, and your NAND will be ready for use.
		$LF
	]li
]ol
[div class=p 
	"Keep in mind that DSi NANDs are region locked between the US, European, Australian, Japanese, Korean, and Chinese regions. So make sure to match the region between your game and NAND. Note that some games might allow multiple regions to be used (commonly Europe and Australia get the exact same release), and a few games are region free.
]div
