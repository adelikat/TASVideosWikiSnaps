10
[p 
	"Hetfield90 & RachelB's Wii Muramasa: The Demon Blade "Momohime" TAS in 1:03:44.55. It is a 1 minute and 24 second improvement over the 
	[a href=/3491S 
		"published run
	]a
	" after accounting for ~9 seconds of intro differences from not playing on NG+.
	$LF
]p
[h2 
	" Encode
	$LF
]h2
[p 
	(youtube|v=Yf-Bi7YDHyE)
	$LF
]p
[h3 
	" Goals
	$LF
]h3
[ul 
	[li 
		" Genre: Action
		$LF
	]li
	[li 
		" Genre: Adventure
		$LF
	]li
	[li 
		" Genre: Platform
		$LF
	]li
	[li 
		" Aims for fastest completion
		$LF
	]li
	[li 
		" Heavy luck manipulation
		$LF
	]li
	[li 
		" Takes damage to save time
		$LF
	]li
]ul
[h4 
	" Emulator Settings
	$LF
]h4
[ul 
	[li 
		" Emulator Used: Dolphin 5.0
		$LF
	]li
	[li 
		" Dual Core: Off
		$LF
	]li
	[li 
		" Idle Skipping: Off
		$LF
	]li
	[li 
		" DSP Emulator Engine: DSP HLE emulation (fast)
		$LF
	]li
	[li 
		" Standard Gamecube controller in port 1
		$LF
	]li
	[li 
		" Wiimote 1 connected
		$LF
	]li
]ul
[h2 
	" About the Run
	$LF
]h2
[h4 
	" Difficulty Choice
	$LF
]h4
[p 
	"The reason for switching from Shiguri to Shura difficulty is because the two difficulties are exactly identical for a TAS outside of having Shura having a ~9s longer intro from not being on NG+ and being able run through the butterflies in the final act(which saves a very small amount of frames). Shiguri also allows you to parry enemy attacks while attacking, but this is useless in a TAS because you want to avoid the hit lag caused by parries. Also, recording input files from NG+ doesn't work on Dolphin 5.0.
	$LF
]p
[h3 
	" General Info
	$LF
]h3
[h4 
	" Random Encounters
	$LF
]h4
[p 
	"As far as I was able to tell, the pseudorandom distribution for encounter luck in this game uses some sort of algorithm that increases the chance of a random encounter for each iteration that yields no encounter. Therefor, the general strategy is to just delay encounters from happening for as long as possible and then either use a smoke bomb or manipulate something that dies very quickly like wooly eyeballs or a pheasant.
	$LF
]p
[p 
	"RNG in this game does not increment frame by frame, and the only thing you can do to advance rng in non-combat zones is kicking up dirt or snow by running, or grabbing a treasure if one happens to be in your direct path. You kick up additional dirt sprites by pressing down for a frame while moving, or reduce the number of sprites you create by pressing backwards for a frame.
	$LF
]p
[p 
	"The unfortunate part about this is that most of the acts, at least the ones with the most difficult RNG manipulation, don't have terrain that kicks anything up to advance the RNG. There is at least a silver lining in random encounter manipulation in the form of dirt always being generated just before a screen transition regardless of the type of terrain. Since you can only create one small dirt sprite from running or 1 large dirt sprite from jumping each screen transition, you usually end up having to waste a lot of time manipulating encounters away in these acts. As such, pretty much all of your money over the course of the run is spent on smoke bombs, and some are even worth acquiring by taking slight detours to grab them, and some are also needed to be manipulated from high level ninjas.
	$LF
]p
[h4 
	" Combat Zone Movement
	$LF
]h4
[p 
	"Momohime gains access to a much larger array of movement options when she is in a combat zone.
	$LF
]p
[p 
	"Rolling is the fastest form of horizontal movement, followed by continuous blade dashing, followed by running. Since running has an acceleration period to it, you generally want to start these zones by either blade dashing or rolling, and since rolling normally has a long stand up animation, you want your last one to always be followed by a blade dash, jump, falling off a cliff, etc...
	$LF
]p
[p 
	"There are 2 main tricks for vertical movement, the first being corner jumping. Normally Momohime has a large delay period after landing before she can jump again, but if you land on the corner of a ledge and fall off you can jump immediately. The second most commonly used vertical movement tech blade dash zipping/canceling, where you zip great distances up to passable floors by using a blade dash and cancel the blade dash with an air slash that is subsequently interrupted by landing on the ground.
	$LF
]p
[h4 
	" Boss Fights
	$LF
]h4
[p 
	"The most notable mechanic in the boss fights of this game is the dynamic difficulty timer. Each time you deplete a boss' large yellow health bar, their small orange bar above it will deplete an amount relative to how long it took you to do it.
	$LF
]p
[p 
	"Because there is a minimum amount of time you must wait before reaching certain dynamic difficulty thresholds, optimizing each phase of boss fights sans the final phase entails generating as little hit lag as possible while still being able to transition each phase right when the decrement threshold increases to a given value.
	$LF
]p
[p 
	[img class=embed src=http://puu.sh/qQPBP.png 
	]img
	$LF
]p
[p 
	"This table shows how many frames of hit lag each type of slash generates. It doesn't include the damage/hit lag ratio of each type of slash, but suffice it to say that blade dashing is significantly more efficient than all other slashes in this regard. I also forgot to include special abilities from swords, but Flash(the only one that's really used in this run) is pretty comparable to the 1st-3rd combo slashes, and if you do need to another type of slash in one of the non-final phases, whether you use Flash or combo slashes generally boils down to RNG manipulation contingencies.
	$LF
]p
[p 
	"Since you want to be doing as few hits as possible in the first several phases, you generally want to do two 30% decrements and one 40%. The IGT would still be the same with other combinations of decrements, but the real-time would be slower from additional hit lag. Dynamic difficulty does not apply to the final phase, so DPS should be maximized without any regard to hit lag.
	$LF
]p
[p 
	[b 
		"Base-Damage Transfer:
	]b
	" Selecting the secondary or tertiary sword slot before entering a boss battle will overwrite the base damage of either of those swords to your primary sword. This is a very useful glitch because the ideal sword length, special ability, and base damage for each fight do not typically coincide all within the same sword, so it is nice to be able to combine specific properties of different swords.
	$LF
]p
[p 
	[b 
		"Blade Dash Canceling:
	]b
	" Blade dashes can be used up to 3 times in a row before touching the ground again, but only the first 2 can be interrupted by an air slash. Additionally, the air slash itself will be interrupted if you are too close to the ground. As such, the ideal way DPS bosses in their non-final phases is doing pairs of ground-level blade dashes interrupted by air slashes. Blade dash canceling is very much a TAS-only technique. For RTA, I would say it's best to just use the 3 preliminary combo slashes without a finisher to minimize hit lag.
	$LF
]p
[p 
	"As far as the final phase of each fight goes, the general breakdown of different slashing combos' DPS is as follows:
	$LF
]p
[ol 
	[li 
		" Flash spam
		$LF
	]li
	[li 
		" Triple combo with Flash finisher
		$LF
	]li
	[li 
		" Air combo interrupted by downward stab
		$LF
	]li
	[li 
		" Triple combo with sliding slash finisher
		$LF
	]li
]ol
[p 
	"Some other things to note about sword DPS are that blades barely beat long blades of identical base damage in DPS, and it is in fact slower to cut your combos short instead of using all 3 preliminary slashes.
	$LF
]p
[h3 
	" Act Comments
	$LF
]h3
[h4 
	" Act 1
	$LF
]h4
[p 
	"You start with 3 bamboo flasks, which aren't needed for their healing properties, but are still consumed anyway to gain Spirit for later sword forgings.
	$LF
]p
[p 
	"The explanation box at the start of the mandatory samurai fight can be avoided by delaying your quick draw, but this will merely move it to the Yukinojo fight instead. This might be worth doing in the Kisuke run since I don't think you have to fight any more samurai for the remainder of the run.
	$LF
]p
[p 
	"Even though random encounters do not end until the final corpse hits the floor, there's no other way to keep every ninja together than by juggling them, so this is still the fastest way to do the mandatory ninja fight.
	$LF
]p
[p 
	"Which side of an NPC you talk to them from during dialogue zones depends on several factors:
	$LF
]p
[ol 
	[li 
		" Whether or not you can reach them before the minimum amount of time has passed to be able to start talking to NPCs(if you reach the first NPC with time to spare, part of their turnaround animation may occur during this grace period)
		$LF
	]li
	[li 
		" How long it takes each NPC to turn around
		$LF
	]li
	[li 
		" Whether or not Momohime is possessed by Jinkuro(since Momohime walks so slowly by herself, it's generally faster to walk through an NPC before talking to them so Momohime quickly steps backwards before the dialogue, but only if that NPC has a quick turnaround animation.)
		$LF
	]li
]ol
[p 
	[b 
		"Blue Monk
	]b
	": The base damage transfer glitch is used to overwrite Sazanami's base damage onto the Chizuru Muramasa. The Chizuru Muramasa's special ability, Misty Slash, is particularly useful on this fight since it interrupts Blue Monk's desperation attack. It doesn't particularly matter what Blue Monk does in the first two phases, but he should be manipulated to use the fire pillar attack or his desperation move in the 3rd since those keep him stationary the longest for more blade dash cancels. Once he reaches his fourth and final phase air comboing is by far the fastest form of DPS in the game at this point before obtaining the Umitsubame Muramasa.
	$LF
]p
[h4 
	" Act 2
	$LF
]h4
[p 
	"The two swords I equip in this act are the Hasabe Kunishige, obtained from Blue Monk, and the Botan Muramasa, forged at level 3. The Hasabe Kunishege is used for its passive +1 strength bonus, which adds a small damage increase to other swords, but more importantly helps meet strength requisites  for more powerful swords throughout the run. The Botan Muramasa is another essential blade in Momohime's weaponry. Not only does it have the highest base damage of any sword available at that level, but it also gives a passive 5% damage increase to the other two swords you have equipped, which makes it stay useful until the end of the game.
	$LF
]p
[p 
	[b 
		"Wanyudo:
	]b
	" This boss was one of the trickier bosses to manipulate without generating extraneous hit lag since he likes to move around a lot, and getting a long horizontal dash makes it pretty much impossible to make a 30% threshold on time with just blade dashes. Wanyudo automatically gets knocked into the air after his first phase which gives him a long period of invulnerability at the start of phase 2, which pretty much mandates a 40% decrement for that phase. Manyudo must also be manipulated to a specific permutation of actions so you can force him to start a rotating fire move just before his final phase to get him to stay still. This needs to last long enough for you to finish him off, otherwise he will dash in between the two fire puddles he created to do his desperation attack.
	$LF
]p
[h4 
	" Act 3
	$LF
]h4
[p 
	"The Tengu Mask, which gives +1 str/+1 vit, is acquired so that I can equip the Hibari Muramasa at level 5, which yields a 67% DPS increase over the Botan Muramasa which I was previously using. I also fight a birdmen encounter to hit level 5, since wooly eyeballs don't give as much XP.
	$LF
]p
[p 
	"Along with the Hibari Muramasa, the Umitsubame Muramasa is also equipped in this act. The Umitsubame Muramasa is by far the best sword in this run and is used in the primary sword slot for all but one of the remaining boss fights. Not only is its passive, Income Boost, useful for buying more smoke bombs throughout the run, but it's special ability, Flash, is one of the most versatile abilities in the game. Momohime unaffected by attacks while casting it, it interrupts any animation while on the ground(making it a faster combo finisher than any other slash), it receives all the benefits of the damage overwrite glitch, and it can hit enemies from range if need be. The only drawback to this ability(other than being restricted by Soul Power constraints like all special abilities are) is that its target and trajectory are determined by RNG, and it has a high likelihood to miss its target, so each use must be manipulated.
	$LF
]p
[p 
	"I don't take a detour above the Yukinojo fight to visit a shrine to teleport to later since the one I tagged in Act 2 happens to be closer to Kai, just from the opposite direction.
	$LF
]p
[p 
	[b 
		"Yukinojo:
	]b
	" The drawn back slash the most effective attack for breaking Yukinojo's sword since it isn't worth using a quick draw on a single samurai. Also, quick drawing nullifies the effects of the base damage overwrite glitch, and I want to keep the Hibari Muramasa's base damage on my Umitsubame Muramasa for the entire fight. You have to roll to dodge Yukinojo's telegraphed attacks in the first 3 phases, but Flash can be used to dodge the attacks in the 4th phase without sacrificing DPS. The drawn back slash at the end is used to juggle Yukinojo, otherwise he will pull out another sword, which has a much faster timer on it in desperation mode.
	$LF
]p
[h4 
	" Act 4
	$LF
]h4
[p 
	"It was relatively easy to make it through Mt. Hida without using any smoke bombs since snow offers much greater opportunity for RNG manipulation than most other terrains.
	$LF
]p
[p 
	[b 
		"Ippondatara:
	]b
	" I had originally anticipated Ippondata's first foot phase to be one of the harder phases to execute since his foot is either high up in the air or offscreen for most of the time. Conveniently, you can stunlock him in place by spamming blade dash cancels. Attacking Ippondatara's hand in his body phase with a special attack like blade dash will cause his eyes to stop shooting out onion rings and shoot explosive orbs instead. This must be avoided since reflecting the rings back at his eyes deals significant damage, and has an extremely high damage to hit lag ratio. It is possible to bring Ippondata to 0 hp during his last foot phase, but you will still have to wait out the next transition and attack the boar once to kill him, so it's better to bring his foot to 1 Flash from death.
	$LF
]p
[h4 
	" Act 5
	$LF
]h4
[p 
	"The two Doburokus from the shack are essential to meet the Spirit needs to forge the two remaining swords I need to forge in this run.
	$LF
]p
[p 
	[b 
		"Chimera:
	]b
	" You always want to manipulate Chimera to do his dive bomb attack in phases 2-4 each time he does a random action since he takes a long time to recover from it, letting you get plenty of blade dashes in phases 2/3 and high damage Flash combos in phase 4.
	$LF
]p
[h4 
	" Act 6
	$LF
]h4
[p 
	"The Shura Mask is needed in order to equip the Kisaragi Muramasa before the Big Oni fight, which has 63% increase in damage over the Hibari Muramasa, irrespective of the additional DPS provided by the mask's superior stats.
	$LF
]p
[p 
	"This is where RNG manipulation starts to get really difficult since there's no dirt in hell and each screen has has a very high chance of spawning an encounter that has to be smoke bombed.
	$LF
]p
[p 
	[b 
		"Big Oni:
	]b
	" The Big Oni takes significantly more damage from inside his stomach than his body does, so I let him eat Momohime in phases 2 and 3. Since one of these phases has to be 30% and one has to be 40%, the 30% requires maximum DPS to make it in time whereas the 40% can be done with all blade dashes. I have to get out of the Big Oni's field of view for a brief moment in the final phase to prevent him from enraging.
	$LF
]p
[h4 
	" Act 7
	$LF
]h4
[p 
	"Kumori stones are very powerful items which apply a buff that prevents the decay of Soul Power for a certain period of time, and Jyokenji stones refill Soul Power. I need 4 Kumori stones and 1 Jyokenji stone for the final boss fight.
	$LF
]p
[p 
	[b 
		"Raijin:
	]b
	" This is the one fight you go back to the Chizuru Muramasa since Misty Slash can force Raijin out of the air in each phase, allowing you spam blade dash cancels all fight and prevent her desperation attacks which make her become immune to damage.
	$LF
]p
[h4 
	" Act 8
	$LF
]h4
[p 
	"I kill 2 ninjas in one of the fixed enemy encounter zones so that I can buy an additional smoke bomb from the upcoming shop.
	$LF
]p
[p 
	"This act is the worst for manipulation since once you get inside the temple there is no more dirt, and nearly every other screen is a fixed encounter zone, which prevents you from repeatedly screen transitioning for manipulation, so all of the random encounter manipulation has to be done during the fixed enemy encounters.
	$LF
]p
[p 
	[b 
		"Fudo-Myoou:
	]b
	" As far as I'm concerned, it's effectively impossible to maintain constant Flash spamming throughout this fight because there is no way to advance RNG on the floating rocks other than waiting for the boss to do it for you, and Flash really likes to hit random stuff or just miss its target completely. After the statue's weak spots become exposed, they have a very long period of invulnerability in between each set of 4 instances of damage. For whatever reason, Flash completely bypasses this immunity, which is why its so important to load up on Kumori stones before this fight.
	$LF
]p
[h3 
	" Closing Remarks
	$LF
]h3
[h4 
	" Possible Improvements
	$LF
]h4
[p 
	"Since random encounter manipulation poses the majority of the difficulty in this run, and encounter luck isn't simple enough to be able to manipulate all unwanted encounters away, Muramasa is in desperate need of some RNG disassembly. I did the best I could with trial and error, but it would be invaluable to be able to plan out the entire random encounter/smoke bomb route for the whole run. Hopefully with aldelaro5's new Dolphin debugger tutorial out I'll be able to convince Flameberger or someone to help me with this for a v2 and/or Kisuke improvement.
	$LF
]p
[h4 
	" Acknowledgements
	$LF
]h4
[p 
	[b 
		"RachelB:
	]b
	" for her published Momohime run and the work she did on Dolphin development to make TASing Wii games possible.
	$LF
]p
[p 
	[b 
		"Bernka:
	]b
	" for his recent Kisuke run, through which I discovered this gem of a game and became interested in TASing it.
	$LF
]p
[p 
	[b 
		"Trineas:
	]b
	" for his Momohime RTA runs which I also used as a reference for making this TAS. A number of the routing/boss strategy improvements over the published run came from RTA developments.
	$LF
]p
[h4 
	" Screenshot Suggestion(102584)
	$LF
]h4
[p 
	"Because how could the screenshot not involve bathing in a hot spring with a giant mountain boar god?
	$LF
]p
[p 
	[img class=embed src=http://i.imgur.com/iKrixJ0.png 
	]img
	$LF
]p
[p 
	"Alternatively, I suppose something like frame 7152 would also be acceptable.
	$LF
]p
[p 
	[img class=embed src=http://i.imgur.com/Sqbj1OO.png 
	]img
	$LF
]p
[hr 
]hr
[p 
	(__wikiLink|user:GoddessMaria)
	": Judging!
	$LF
]p
[p 
	(__wikiLink|user:GoddessMaria)
	": Alright, so I have to say that this is an interesting movie. Despite the difficulty change-up caused from NG versus NG+, it still manages to hold up well in entertainment and be faster than the previous movie. I also must commend the inclusion of the previous author as this movie has taken quite a bit of inspiration from. As far as the decision for the placement of this movie is concerned...
	$LF
]p
[p 
	"Accepting for Moons as an improvement to the previous movie.
	$LF
]p
[p 
	(__wikiLink|user:RGamma)
	": Publishing...
]p
