14
[p 
	(youtube|v=B8SpP1dguTI|w=320|h=288)
	$LF
]p
[h3 
	" Objectives
	$LF
]h3
[ul 
	[li 
		" Plays on hardest difficulty
		$LF
	]li
	[li 
		" Takes damage to save time
		$LF
	]li
	[li 
		" Uses warps (glitch warp in Act 1)
		$LF
	]li
	[li 
		" Genre: Platform
		$LF
	]li
	[li 
		" 
		[b 
			"Bizhawk 2.2 (Gambatte core)
		]b
		$LF
	]li
]ul
[h3 
	" About the run
	$LF
]h3
[p 
	"While rewatching my run recently, I had an idea to improve Act 6 and in my quick test I managed to save 90 frames. So I started working on a new run on Bizhawk pretty much right away.
	$LF
]p
[p 
	"Because of timing differences between VBA-v23 and Bizhawk-Gambatte, this run ends up being 
	[b 
		"10 seconds
	]b
	" slower than the 
	(__wikiLink|1848M|previous run)
	". VBA skipped most of the screen transition lag that I ran into on Bizhawk, and also, the old 08:28.18 time was timed at 60FPS, whereas this new 8:38.04 time is timed at ~59.7FPS.
	$LF
]p
[p 
	"This run aimed to improve the remaining in-game time per level and I saved 
	[b 
		"170 frames
	]b
	" thanks to optimizations and new strategies. See the level comments below for details on the improvements.
	$LF
]p
[p 
	"I created a 
	[a class=extlink href=https://pastebin.com/H1qur9t6 rel=nofollow 
		"luascript
	]a
	" to keep a look at velocity and positioning, which helped squeeze some frames. I 
	[a class=extlink href=https://pastebin.com/YbE8AQrp rel=nofollow 
		"converted
	]a
	" the script to VBA and AVI-recorded the whole run with the display on top so I could always compare to any point of the previous run.
	$LF
]p
[p 
	"I noticed the previous run sometimes forgot that you could move 1 frame before the level fades in which guaranteed a time save in some of the later levels.
	$LF
]p
[p 
	"Sometimes I copy-pasted from the previous run. To do this, I dragged the 
	[em 
		".VBM
	]em
	" on Bizhawk to create a new 
	[em 
		".BK2
	]em
	" and then I simply copied from the 
	[em 
		"Input Log.txt
	]em
	". (I don't want to learn how to use TAStudio.)
	$LF
]p
[h3 
	" Note about lag reduction
	$LF
]h3
[p 
	"Due to switching from VBA to Bizhawk, the in-game time became the main priority. But throughout the run I would run into lag frames that would freeze the in-game timer. At the Dragon boss, I could have gone for a strategy that had the fastest in-game time but it would also have produced tons of lag. So I decided to keep lag to a minimum at the cost of a few in-game frames, in order to have a better looking run. In other places of the game it wasn't a problem, because I would only run into single lag frames that already existed in the VBA run and were unavoidable anyway. Add these tags as you see fit:
	$LF
]p
[ul 
	[li 
		" Aims for in-game time instead of real-time
		$LF
	]li
	[li 
		" Contains speed/entertainment tradeoffs
		$LF
	]li
]ul
[p 
	"This is the set of priorities this run follows:
	$LF
]p
[ol 
	[li 
		" Fastest realtime (in levels only)
		$LF
	]li
	[li 
		" Fastest level time aka. in-game time
		$LF
	]li
	[li 
		" Fastest realtime (whole run)
		$LF
	]li
]ol
[p 
	"(Stars that you collect in the levels and are counted on the score tally screen count towards 1) for the sake of this ruleset.)
	$LF
]p
[h3 
	" Level comments
	$LF
]h3
[table 
	[tbody 
		[tr 
			[th 
				"Level
			]th
			[th 
				"Ingame frames saved
			]th
			[th 
				"Comments
			]th
		]tr
		[tr 
			[td 
				"Menu
			]td
			[td 
				"				0
			]td
			[td 
				"		Same as previous run. But it was at this point that I quickly realized, the new run would fall behind the previous run a lot due to the difference in timing. So I decided to go for in-game time savings and ignore real-time.
			]td
		]tr
		[tr 
			[td 
				"Act 1
			]td
			[td 
				"				0
			]td
			[td 
				"		Re-TASed, but no time save.
			]td
		]tr
		[tr 
			[td 
				"Act 2
			]td
			[td 
				"				0
			]td
			[td 
				"		Copy-pasted from previous run.
			]td
		]tr
		[tr 
			[td 
				"Act 3
			]td
			[td 
				"				0
			]td
			[td 
				"		Re-TASed, but no time save.
			]td
		]tr
		[tr 
			[td 
				"Act 4
			]td
			[td 
				"				7
			]td
			[td 
				"		New strat: bounce off of fish at the middle of the level. The end of this level is the only place where RNG matters; depending on if I let the mosquito live, or kill it on a certain frame, I can manipulate the Snake's pattern. This time I didn't have to add any waiting time.
			]td
		]tr
		[tr 
			[td 
				"Snake
			]td
			[td 
				"				0
			]td
			[td 
				"		I couldn't save any time so I copy-pasted from previous run.
			]td
		]tr
		[tr 
			[td 
				"Act 5
			]td
			[td 
				"				0
			]td
			[td 
				"		I couldn't save any time so I copy-pasted from previous run.
			]td
		]tr
		[tr 
			[td 
				"Act 6 (part 1)
			]td
			[td 
				"			7
			]td
			[td 
				"		Some slight optimization.
			]td
		]tr
		[tr 
			[td 
				"Act 6 (part 2)
			]td
			[td 
				" 		94
			]td
			[td 
				"		Major improvement in this run, and reason why I started this run. There was no need to wait for the bird to go all the way down and then up.
			]td
		]tr
		[tr 
			[td 
				"Act 7
			]td
			[td 
				"				2
			]td
			[td 
				"		Copy-pasted from previous run, and killed the one crow that I missed in previous run due to poor hex-editing (I'm talking about 
				[a class=extlink href=https://imgur.com/a/BCkHf rel=nofollow 
					"this
				]a
				".) Saved 2 frames mysteriously.. maybe previous run didn't go into the goal at the earliest moment?
			]td
		]tr
		[tr 
			[td 
				"Act 8
			]td
			[td 
				"				1
			]td
			[td 
				"		This was one of the most puzzling and annoying levels to TAS. Long story short: The VBA run could move 1 frame for free at the start, without the in-game timer depleting. I tried quite a few things but didn't manage to reproduce this situation in Bizhawk, so I went through this level 1 frame behind. I optimized jumping up the slopes as best as I could, having the exact coordinates and velocity value in front of my eyes this time. But I still ended up equal to the previous run (I guess I did a good job at trial-and-erroring through this level in 2011). I saved back two frames at the end, however, for a net gain of 1 frame. I also used a new trick at the beginning to 
				[a class=extlink href=https://imgur.com/9keTTo8 rel=nofollow 
					"fall through the ground
				]a
				", for style.
			]td
		]tr
		[tr 
			[td 
				"Act 9
			]td
			[td 
				"				6
			]td
			[td 
				"		New route through this level, which I already knew about back then. But this time, through optimization, it turned out slightly faster compared to the standard route.
			]td
		]tr
		[tr 
			[td 
				"Dragon
			]td
			[td 
				"				5
			]td
			[td 
				"		Some small optimizations. The first present throw has to make sure the dragon's fire doesn't touch a platform. The second present throw could be done like the subsequent throws, but the 1st fire doesn't despawn fast enough causing a ton of lag. So I had to move slightly closer and throw differently, costing a bit of in-game time but removing the lag.
			]td
		]tr
		[tr 
			[td 
				"Act 10
			]td
			[td 
				"				0
			]td
			[td 
				"		Re-TASed, but no time save.
			]td
		]tr
		[tr 
			[td 
				"Act 11
			]td
			[td 
				"				0
			]td
			[td 
				"		Re-TASed, but no time save. The vultures always come out at the same time throughout the level, so it's not possible to manipulate them. I take a raspberry because I need it in Act 12 part 2.
			]td
		]tr
		[tr 
			[td 
				"Act 12 (part 1)
			]td
			[td 
				"			3
			]td
			[td 
				"		Pretty much unchanged from the previous run, but I somehow squeezed 3 frames at the springboard jump.
			]td
		]tr
		[tr 
			[td 
				"Act 12 (part 2)
			]td
			[td 
				"			40
			]td
			[td 
				"		I found more shortcuts with the apples to save some time. Unlike VBA, Bizhawk creates some lag frames here but it doesn't slow down the game. It only prevents input from being polled. The in-game timer acknowledges those frames by skipping ahead two frames.
			]td
		]tr
		[tr 
			[td 
				"Gargamel
			]td
			[td 
				"			5
			]td
			[td 
				"		Optimized for faster key grab. Turns out you can grab it 2 frames earlier by jumping after crouching.
			]td
		]tr
	]tbody
]table
[p 
	"= 170 in-game frames saved
	$LF
]p
[h3 
	" Dragon boss glitch
	$LF
]h3
[p 
	[img class=embed src=https://imgur.com/1XH1Mel.gif 
	]img
	$LF
]p
[p 
	"There is a glitch in the Dragon fight, when you pull many presents at once, after about 14 presents you can't pull any more and the Dragon's head is despawned. I ran into this first in 2010 or so, when playing on VBA v19-22. Due to VBA versions prior to VBA-24m causing many emulation glitches at the time, especially in Gameboy games, and because I couldn't reproduce the bug on my real console, I was quick to conclude that this Dragon glitch must be an emulation glitch, too.
	$LF
]p
[p 
	"Years passed, I made a Smurfs TAS or two. While working on this run on Bizhawk-Gambatte, during testing I stumbled upon the glitch again! I was dumbfounded how this old VBA bug slipped into the much more accurate Gambatte emulator. I even tested the bug on Gambatte at one point (somewhere in 2013~2015) and it didn't happen then.
	$LF
]p
[p 
	"It soon occurred to me that it could be a bug related to game version, and I was right. It only happens in v1.0 and doesn't on v1.1. VBA didn't do anything wrong. So I 
	[a href=/forum/viewtopic.php?p=460576#460576 
		"cleared things up
	]a
	", 
	[a class=extlink href=https://tcrf.net/The_Smurfs_(Game_Boy)#Dragon_Boss_Glitch rel=nofollow 
		"added that tidbit to TCRF
	]a
	" and moved along.
	$LF
]p
[h3 
	" Please fix an error
	$LF
]h3
[p 
	"The (USA/Europe v1.0) tag must be changed to (Europe v1.0) on the previous movies.
	$LF
]p
[p 
	"Version 1.0 was only released in Europe. Version 1.1 was released in Europe & USA.
	$LF
]p
[h3 
	" Possible improvements
	$LF
]h3
[p 
	"You could save more in-game time if you ignore lag (during the Dragon fight) and possibly by ignoring post-level bonus effects, so you can move through Stars freely (each Star you collect costs 10 frames on the score tallying screen). But I would not recommend doing either of the two; it would make the run slower real-time wise.
	$LF
]p
[h3 
	" Screenshot
	$LF
]h3
[p 
	"I'd like to request Act 8, the beginning where I 
	[a class=extlink href=https://imgur.com/9keTTo8 rel=nofollow 
		"fall through the tracks and ride the cart on the rocks
	]a
	", to be the screenshot.
	$LF
]p
[h3 
	" Closing words
	$LF
]h3
[p 
	"This run is perfected in my eyes. I don't expect to come back to this game unless for some joke category. I'll be busy with life stuff, so it might take some time before I can make another run. There is still 
	[em 
		"Kirby & The Amazing Mirror 100%
	]em
	" and 
	[em 
		"Mario & Luigi Superstar Saga any%
	]em
	" that I absolutely must do, or I won't be happy.
	$LF
]p
[p 
	"I'm a little annoyed at the fact that VBA skips the LCD lag and every time I want to improve an old run, I have to accept the fact I'm going to be slower than the old run. This aspect kills my motivation to improve 
	[em 
		"Super Mario Land
	]em
	", to name an example. Because putting in hours and hours of work to have a run that's 5 seconds slower is not worth it. Last time I checked, the autoscroller levels even lagged like crazy on Bizhawk. No thanks. However, I'll be the first to start working on it if someone finds a new 
	[a href=/Mugg/UnexplainedGlitches.html#GbSuperMarioLandCheckpointGlitch 
		"technqiue
	]a
	"... 
	$LF
]p
[hr 
]hr
[p 
	(__wikiLink|user:feos)
	": I compared each level from the first frame of movement to the last frame of movement (and sometimes to the first fade out frame), and improvement is indeed always there, it's just sometimes a bit different from the info in the table above. Quite a few times gameplay ends even sooner.
	$LF
]p
[p 
	"Accepting as an improvement over 
	(__wikiLink|1848M)
	".
	$LF
]p
[p 
	"PS: The music in this game is so great!
	$LF
]p
[p 
	(__wikiLink|user:fsvgm777)
	": Processing.
	$LF
]p
[p 
	"PS: I agree.
]p
