5
[div class=p 
	[em 
		[a href=https://en.wikipedia.org/wiki/Mixed-Up_Mother_Goose rel=noopener external nofollow 
			"Mixed-Up Mother Goose
		]a
	]em
	" is a Sierra adventure game,
	$LF
	"in the lineage of classics like 
	[em 
		(__wikiLink|displaytext=King's Quest|href=/2071G)
	]em
	" and 
	[em 
		(__wikiLink|displaytext=Space Quest|href=/1976G)
	]em
	".
	$LF
	"It is designed for small children, with simplified mechanics and no reading requirement.
	$LF
	"The game was remade multiple times;
	$LF
	"this TAS is of the original
	$LF
	[a href=https://en.wikipedia.org/wiki/Adventure_Game_Interpreter rel=noopener external nofollow 
		"AGI
	]a
	" version from 1987.
	$LF
]div
[div class=p 
	"The run features computer-optimized routing,
	$LF
	"careful micro optimization,
	$LF
	"and a few fun movement glitches.
	$LF
	"The most significant aspect is exhaustive enumeration
	$LF
	"of random seeds to find
	$LF
	"an item assignment that can be solved quickly.
	$LF
	"These submission comments highlight the most interesting parts;
	$LF
	"for chronological development notes
	$LF
	"see 
	(__wikiLink|displaytext=thread #23454|href=/Forum/Topics/23454)
	".
	$LF
]div
[div class=p 
	[a href=https://archive.org/details/Mixed-Up_Mother_Goose_AGI_TAS_25_52_83 rel=noopener external nofollow 
		[img alt=Video thumbnail, a screenshot of the clouds in the dream sequence. class=embed mw-100 src=https://archive.org/download/Mixed-Up_Mother_Goose_AGI_TAS_25_52_83/__ia_thumb.jpg 
		]img
	]a
	[br 
	]br
	$LF
	[a href=https://archive.org/details/Mixed-Up_Mother_Goose_AGI_TAS_25_52_83 rel=noopener external nofollow 
		"(link to video)
	]a
	$LF
]div
[div class=p 
	"Suggested screenshot: frame 19277
	$LF
]div
[h2 id=Emulation 
	" Emulation
	$LF
]h2
[div class=p 
	"Mixed-Up Mother Goose (1987) 1.00D, AGI version 2.915
	[br 
	]br
	$LF
	"goodolddays.net ID: 168
	[br 
	]br
	$LF
	"SHA-256 checksum:
	$LF
]div
[pre 
	"e33dea30ceb5692d4111f3a92037cbd15b9c62f2dd2ea2a251ee1ce3e5e354fc  000168_mixed-up_mother_goose/disk1.img
	$LF
]pre
[div class=p 
	"PCem 17+st-1
	[br 
	]br
	$LF
	"libTAS 1.4.3
	[br 
	]br
	$LF
	"Debian bullseye amd64, Linux 5.10.0-13-amd64
	$LF
]div
[div class=p 
	"Music is an important part of this game,
	$LF
	"which is why I chose to play it on an emulated
	$LF
	[a href=https://en.wikipedia.org/wiki/Tandy_1000 rel=noopener external nofollow 
		"Tandy 1000
	]a
	$LF
	"rather than one of the
	$LF
	(__wikiLink|displaytext=premade PC configurations|href=/EmulatorResources/PCem/DOS#PremadeConfigurations)
	".
	$LF
	[em 
		"Mixed-Up Mother Goose
	]em
	" uses the Tandy's multi-channel sound hardware for
	$LF
	[a href=https://archive.org/details/Mixed-Up_Mother_Goose_AGI_PC_vs_Tandy rel=noopener external nofollow 
		"better music
	]a
	$LF
	"than is possible with the PC speaker.
	$LF
]div
[h3 id=Pcem 
	" PCem
	$LF
]h3
[div class=p 
	"Machine: [8086] Tandy 1000 SL/2
	[br 
	]br
	$LF
	"CPU: 8086/8
	[br 
	]br
	$LF
	"Memory: 512 KB
	[br 
	]br
	$LF
	"HDD: None
	[br 
	]br
	$LF
	"FDD1: 3.5" 720k
	[br 
	]br
	$LF
	"FDD2: None
	$LF
]div
[div class=p 
	"PCem ROMs and SHA-256 checksums:
	$LF
]div
[pre 
	"37527f661580e5a09710051cec67422abfadf31c61b841537a91e7f27be19304  mda.rom
	$LF
	"2143765cebd59c2ef024f56284e17259b2dfaa8fca6cf419f48d533c5f3c55af  wy700.rom
	$LF
	"f17b4f9c063f88a096b02681b203178705796f0abcdffc696f2a1d605e3af84d  8x12.bin
	$LF
	"7fe228566de37a2f06ca6703a9f1280fd75db2f2d0e0e635b7c3b1e214680866  tandy1000sl2/8079047.hu1
	$LF
	"160116f3ad6788af7faa7a5f12de636de58ea18e2021ddba242ac1e801a927af  tandy1000sl2/8079048.hu2
	$LF
]pre
[h2 id=GameMechanics 
	" Game mechanics
	$LF
]h2
[div class=p 
	"The object of the game is to complete nursery rhymes
	$LF
	"by finding 20 items
	$LF
	"that have been randomly scattered over the game map
	$LF
	"and delivering each to its proper place.
	$LF
	"After completing a rhyme, you are rewarded with a musical cutscene.
	$LF
]div
[div class=p 
	"The 20 items are internally numbered from 11 to 30.
	$LF
	"They are divided into two types:
	$LF
	""walking" items and "pocket" items.
	$LF
	"The walking items have an animated sprite
	$LF
	"that follows you around the screen.
	$LF
	"The pocket items, when collected,
	$LF
	"simply disappear from the screen
	$LF
	"and are understood to be carried by the player.
	$LF
]div
[table 
	[tbody 
		[tr 
			[th 
				"#
			]th
			[th 
				"Item
			]th
			[th 
				"Type
			]th
			[th 
				"Delivery room
			]th
			[th 
				"Nursery rhyme
			]th
		]tr
		[tr 
			[td 
				"11
			]td
			[td 
				"Wife
			]td
			[td 
				"walking
			]td
			[td 
				"12
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Peter,_Peter,_Pumpkin-Eater rel=noopener external nofollow 
					"Peter, Peter, Pumpkin Eater
				]a
			]td
		]tr
		[tr 
			[td 
				"12
			]td
			[td 
				"Miss Muffet
			]td
			[td 
				"walking
			]td
			[td 
				"9
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Little_Miss_Muffet rel=noopener external nofollow 
					"Little Miss Muffet
				]a
			]td
		]tr
		[tr 
			[td 
				"13
			]td
			[td 
				"Mouse
			]td
			[td 
				"walking
			]td
			[td 
				"41
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Hickory_Dickory_Dock rel=noopener external nofollow 
					"Hickory Dickory Dock
				]a
			]td
		]tr
		[tr 
			[td 
				"14
			]td
			[td 
				"Fiddlers Three
			]td
			[td 
				"walking
			]td
			[td 
				"37
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Old_King_Cole rel=noopener external nofollow 
					"Old King Cole
				]a
			]td
		]tr
		[tr 
			[td 
				"15
			]td
			[td 
				"Sheep
			]td
			[td 
				"walking
			]td
			[td 
				"23
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Little_Bo-Peep rel=noopener external nofollow 
					"Little Bo-Peep
				]a
			]td
		]tr
		[tr 
			[td 
				"16
			]td
			[td 
				"Little Dog
			]td
			[td 
				"walking
			]td
			[td 
				"27
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Oh_Where,_Oh_Where_Has_My_Little_Dog_Gone%3F rel=noopener external nofollow 
					"Oh Where, Oh Where Has My Little Dog Gone?
				]a
			]td
		]tr
		[tr 
			[td 
				"17
			]td
			[td 
				"Little Lamb
			]td
			[td 
				"walking
			]td
			[td 
				"13
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Mary_Had_a_Little_Lamb rel=noopener external nofollow 
					"Mary Had a Little Lamb
				]a
			]td
		]tr
		[tr 
			[td 
				"18
			]td
			[td 
				"Fiddle
			]td
			[td 
				"pocket
			]td
			[td 
				"7
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Hey_Diddle_Diddle rel=noopener external nofollow 
					"Hey Diddle Diddle
				]a
			]td
		]tr
		[tr 
			[td 
				"19
			]td
			[td 
				"Pie
			]td
			[td 
				"pocket
			]td
			[td 
				"43
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Little_Jack_Horner rel=noopener external nofollow 
					"Little Jack Horner
				]a
			]td
		]tr
		[tr 
			[td 
				"20
			]td
			[td 
				"Knife
			]td
			[td 
				"pocket
			]td
			[td 
				"3
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Little_Tommy_Tucker rel=noopener external nofollow 
					"Little Tommy Tucker
				]a
			]td
		]tr
		[tr 
			[td 
				"21
			]td
			[td 
				"Steak
			]td
			[td 
				"pocket
			]td
			[td 
				"36
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Jack_Sprat rel=noopener external nofollow 
					"Jack Sprat
				]a
			]td
		]tr
		[tr 
			[td 
				"22
			]td
			[td 
				"Pipe
			]td
			[td 
				"pocket
			]td
			[td 
				"37
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Old_King_Cole rel=noopener external nofollow 
					"Old King Cole
				]a
			]td
		]tr
		[tr 
			[td 
				"23
			]td
			[td 
				"Bowl
			]td
			[td 
				"pocket
			]td
			[td 
				"37
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Old_King_Cole rel=noopener external nofollow 
					"Old King Cole
				]a
			]td
		]tr
		[tr 
			[td 
				"24
			]td
			[td 
				"Broth
			]td
			[td 
				"pocket
			]td
			[td 
				"21
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/There_was_an_Old_Woman_Who_Lived_in_a_Shoe rel=noopener external nofollow 
					"There was an Old Woman Who Lived in a Shoe
				]a
			]td
		]tr
		[tr 
			[td 
				"25
			]td
			[td 
				"Candlestick
			]td
			[td 
				"pocket
			]td
			[td 
				"33
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Jack_Be_Nimble rel=noopener external nofollow 
					"Jack Be Nimble
				]a
			]td
		]tr
		[tr 
			[td 
				"26
			]td
			[td 
				"Pail
			]td
			[td 
				"pocket
			]td
			[td 
				"1
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Jack_and_Jill_(nursery_rhyme) rel=noopener external nofollow 
					"Jack and Jill
				]a
			]td
		]tr
		[tr 
			[td 
				"27
			]td
			[td 
				"Watering Can
			]td
			[td 
				"pocket
			]td
			[td 
				"31
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Mary,_Mary,_Quite_Contrary rel=noopener external nofollow 
					"Mary, Mary, Quite Contrary
				]a
			]td
		]tr
		[tr 
			[td 
				"28
			]td
			[td 
				"Sixpence
			]td
			[td 
				"pocket
			]td
			[td 
				"15
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/There_Was_a_Crooked_Man rel=noopener external nofollow 
					"There Was a Crooked Man
				]a
			]td
		]tr
		[tr 
			[td 
				"29
			]td
			[td 
				"Ladder
			]td
			[td 
				"pocket
			]td
			[td 
				"5
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Humpty_Dumpty rel=noopener external nofollow 
					"Humpty Dumpty
				]a
			]td
		]tr
		[tr 
			[td 
				"30
			]td
			[td 
				"Horse
			]td
			[td 
				"pocket
			]td
			[td 
				"18
			]td
			[td 
				[a href=https://en.wikipedia.org/wiki/Ride_a_cock_horse_to_Banbury_Cross rel=noopener external nofollow 
					"Ride a Cock Horse to Banbury Cross
				]a
			]td
		]tr
	]tbody
]table
[div class=p 
	"The map consists of 44 
	[a href=http://agiwiki.sierrahelp.com/index.php?title=Room rel=noopener external nofollow 
		"rooms
	]a
	".
	$LF
	"Rooms 1–35 are "overworld" rooms arranged in a 7×5 grid.
	$LF
	"Rooms 36–44 are "interior" rooms, accessed via doors in the overworld.
	$LF
	"There are barriers (shown as black lines in the graphic below) that prevent you from walking
	$LF
	"between or within certain rooms.
	$LF
	"Gold squares show where where items may be placed;
	$LF
	"blue circles are the rooms they must be delivered to.
	$LF
	"For example: item 12, Miss Muffet,
	$LF
	"wherever she may be placed initially,
	$LF
	"must be delivered to her tuffet in room 9 (blue circle marked 12).
	$LF
	"There are 22 rooms eligible for item placement
	$LF
	"and only 20 items to place,
	$LF
	"so 2 of the gold squares will be unused in any item assignment.
	$LF
	"Item 27, the Watering Can, is the only item whose location is
	$LF
	[a href=https://archive.org/details/msdos_Mixed-Up_Mother_Goose_1987_feelies/page/n14/mode/1up rel=noopener external nofollow 
		"not randomized
	]a
	".
	$LF
	"It always starts in room 34.
	$LF
]div
[div class=p 
	[a href=https://www.bamsoftware.com/computers/tasvideos/mumg-map-revised.svg rel=noopener external nofollow 
		[img alt=Game map, a grid of 7×5 overworld rooms where rooms 4, 10, 12, 13, 15, 21, 24, 26, and 32 additionally link to an interior room. Black lines show where there are barriers between or within adjacent rooms. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-map-revised.png 
		]img
	]a
	$LF
]div
[div class=p 
	"The map shown is roughly the one used for 
	(__wikiLink|displaytext=computer-assisted routing|href=/Forum/Posts/516005)
	$LF
	"and 
	(__wikiLink|displaytext=random seed optimization|href=/Forum/Posts/516145)
	".
	$LF
	"It simplifies and omits some details that are important
	$LF
	"for small-scale optimization and
	$LF
	"point-to-point movement between route waypoints.
	$LF
	"For example, at 19:08 we will comment on a wall-hugging strategy
	$LF
	"that gives faster vertical movement between rooms.
	$LF
	"The one-way passage from room 24 to room 17 is a movement glitch
	$LF
	"we will see exploited at 11:08.
	$LF
]div
[div class=p 
	"The player's inventory can hold only one item at a time.
	$LF
	"When holding an item,
	$LF
	"there are only two ways to remove it from the inventory:
	$LF
	"deliver it to its destination,
	$LF
	"or 
	[em 
		"swap
	]em
	" it with a different item.
	$LF
	"This is where the distinction between walking items and pocket items comes into play.
	$LF
	"The rule is: walking items cannot remain in an interior room.
	$LF
	"If you try to swap a walking item in an interior room,
	$LF
	"the walking item will not stay in the room,
	$LF
	"but will instead 
	(__wikiLink|displaytext="warp"|href=/Forum/Posts/515677)
	" to some other overworld room.
	$LF
	"The route used in this TAS uses one swap,
	$LF
	"but the warp mechanic turns out not to save time.
	$LF
]div
[div class=p 
	"There are 20 items, but only 18 nursery rhymes.
	$LF
	"That is because Old King Cole demands not one, but three items:
	$LF
	"Pipe, Bowl, and Fiddlers Three,
	$LF
	"which must be delivered in exactly that order.
	$LF
	"Apart from that restriction, any item may be delivered at any time.
	$LF
	"The open-world nature of the game,
	$LF
	"and the possibility of item swaps and warps,
	$LF
	"makes optimizing a specific random item assignment nontrivial.
	$LF
]div
[h2 id=TimeBasedRandomSeedManipulation 
	" Time-based random seed manipulation
	$LF
]h2
[div class=p 
	"The single most important optimization
	$LF
	"is setting the system clock immediately after boot.
	$LF
	"This is to control the RNG seed and get a favorable item assignment.
	$LF
	"The Tandy 1000 
	[a href=https://www.homecomputermuseum.nl/en/collectie/tandy/tandy-1000sl/ rel=noopener external nofollow 
		"does not have a hardware real-time clock
	]a
	",
	$LF
	"so setting the time in libTAS has no effect.
	$LF
	"Instead, we run the
	$LF
	[a href=https://archive.org/details/epson-ms-dos-3.3-ref/page/n220/mode/1up rel=noopener external nofollow 
		"TIME
	]a
	$LF
	"command at the DOS prompt.
	$LF
]div
[div class=p 
	[img alt=DOS prompt showing the command "A>time 3:40:5.3". class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-time-3:40:5.3.png 
	]img
	$LF
]div
[div class=p 
	"The item assignment algorithm is based on a
	$LF
	(__wikiLink|displaytext=random number generator|href=/Forum/Posts/515748)
	$LF
	"that is seeded by the time of day,
	$LF
	"specifically a
	$LF
	[a href=https://www.delorie.com/djgpp/doc/rbinter/id/80/22.html rel=noopener external nofollow 
		"16-bit counter that increments at 18.2 Hz
	]a
	".
	$LF
	"There are 65,536 possible random seeds,
	$LF
	"but only 24,110 distinct item assignments:
	$LF
	"many seeds result in the same effective assignment.
	$LF
	"(I ignored 131 seeds that cause the RNG to re-seed itself from the current time again
	$LF
	"before item assignment is finished, and that therefore
	$LF
	"produce different assignments depending on the CPU speed.)
	$LF
]div
[div class=p 
	"I wrote 
	(__wikiLink|displaytext=an optimizer|href=/Forum/Posts/516005)
	" to test every one
	$LF
	"of the 24,110 possible item assignments
	$LF
	"and find the one with the fastest route.
	$LF
	"The optimizer knows about distances and inter-room connectivity,
	$LF
	"but it ignores some fixed costs, like delivery cutscenes,
	$LF
	"and makes a few approximations.
	$LF
	"The game's state space is too large to search exhaustively,
	$LF
	"so the optimizer is an approximate one,
	$LF
	"based on 
	[a href=https://en.wikipedia.org/wiki/Simulated_annealing rel=noopener external nofollow 
		"simulated annealing
	]a
	".
	$LF
	"Running the optimizer on all item assignments took about 1,800 CPU-hours.
	$LF
	"One assignment emerged as the best by a wide margin.
	$LF
	"There are three seeds that result in it:
	$LF
	"34871, 44046, and 52929.
	$LF
]div
[div class=p 
	[img alt=Histogram of route costs according to the optimizer, with the bin corresponding to seeds 34871, 44046, and 52929 highlighted as the minimum. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-approx-histogram.png 
	]img
	$LF
]div
[div class=p 
	"The difference in estimated time between the worst and best item assignments
	$LF
	"is large, over 5 minutes.
	$LF
	"Because the 16-bit 18.2 Hz counter wraps about once per hour,
	$LF
	"and there are three usable seeds,
	$LF
	"there are 
	(__wikiLink|displaytext=72 moments in each 24-hour day|href=/Forum/Posts/516416)
	$LF
	"that we might use.
	$LF
	"The time specification "3:40:5.3" was chosen because
	$LF
	"it fits in the BIOS keyboard buffer.
	$LF
	"The timestamp we're actually aiming for
	$LF
	"is 3:40:18.02,
	$LF
	"which is when we start a new game and
	$LF
	"item assignment happens.
	$LF
]div
[div class=p 
	"The item assignment we get is shown below.
	$LF
	"The arrows are just a visual guide to help associate items' locations
	$LF
	"with their delivery rooms,
	$LF
	"and do not necessarily reflect movement in the run.
	$LF
]div
[div class=p 
	[a href=https://www.bamsoftware.com/computers/tasvideos/mumg-map-revised-34871.svg rel=noopener external nofollow 
		[img alt=Game map, with item assignment of seeds 34871, 44046, and 52929 shown. A faint arrow connects each item location to its destination room. Item locations are as in the route table below. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-map-revised-34871.png 
		]img
	]a
	$LF
]div
[div class=p 
	"The route optimizer outputs the plan below.
	$LF
	"(Actually, the optimizer outputs 24 routes that it thinks are equivalent,
	$LF
	"because of its connectivity and movement approximations.
	$LF
	"I arrived at this one, out of the 24,
	$LF
	"after analyzing 
	(__wikiLink|displaytext=small|href=/Forum/Posts/517062)
	" 
	(__wikiLink|displaytext=differences|href=/Forum/Posts/517431)
	" between the different options.)
	$LF
]div
[table 
	[tbody 
		[tr 
			[th 
				"Room
			]th
			[th 
				"Actions
			]th
			[th 
				"Timestamp in this run
			]th
		]tr
		[tr 
			[td 
				"start in room 32 (Mother Goose's house exterior)
			]td
			[td 
				" 
			]td
			[td 
				"02:00
			]td
		]tr
		[tr 
			[td 
				"go to room 30
			]td
			[td 
				"get Little Dog
			]td
			[td 
				"02:20
			]td
		]tr
		[tr 
			[td 
				"go to room 27
			]td
			[td 
				"deliver Little Dog to boy
			]td
			[td 
				"03:02
			]td
		]tr
		[tr 
			[td 
				"go to room 28
			]td
			[td 
				"get Broth
			]td
			[td 
				"03:41
			]td
		]tr
		[tr 
			[td 
				"go to room 21 (shoe house exterior)
			]td
			[td 
				"deliver Broth to old woman
			]td
			[td 
				"03:50
			]td
		]tr
		[tr 
			[td 
				"go to room 44 (shoe house interior)
			]td
			[td 
				"get Candlestick
			]td
			[td 
				"04:44
			]td
		]tr
		[tr 
			[td 
				"go to room 33
			]td
			[td 
				"deliver Candlestick to Jack
			]td
			[td 
				"05:20
			]td
		]tr
		[tr 
			[td 
				"go to room 34
			]td
			[td 
				"get Watering Can
			]td
			[td 
				"05:51
			]td
		]tr
		[tr 
			[td 
				"go to room 31
			]td
			[td 
				"deliver Watering Can to Mary Quite Contrary
			]td
			[td 
				"06:24
			]td
		]tr
		[tr 
			[td 
				"go to room 29
			]td
			[td 
				"get Bowl
			]td
			[td 
				"07:27
			]td
		]tr
		[tr 
			[td 
				"go to room 37 (castle interior)
			]td
			[td 
				"swap Bowl for Ladder
			]td
			[td 
				"08:24
			]td
		]tr
		[tr 
			[td 
				"go to room 5 (castle courtyard east)
			]td
			[td 
				"deliver Ladder to Humpty Dumpty
			]td
			[td 
				"08:42
			]td
		]tr
		[tr 
			[td 
				"go to room 11
			]td
			[td 
				"get Pipe
			]td
			[td 
				"09:13
			]td
		]tr
		[tr 
			[td 
				"go to room 37 (castle interior)
			]td
			[td 
				"deliver Pipe to Old King Cole, get Bowl, deliver Bowl
			]td
			[td 
				"09:30
			]td
		]tr
		[tr 
			[td 
				"go to room 19 (Horner house side yard)
			]td
			[td 
				"get Mouse
			]td
			[td 
				"10:36
			]td
		]tr
		[tr 
			[td 
				"go to room 41 (clock house interior)
			]td
			[td 
				"deliver Mouse, get Steak
			]td
			[td 
				"11:06
			]td
		]tr
		[tr 
			[td 
				"go to room 36 (Sprat house interior)
			]td
			[td 
				"deliver Steak to Sprats, get Pie
			]td
			[td 
				"12:03
			]td
		]tr
		[tr 
			[td 
				"go to room 43 (Horner house interior)
			]td
			[td 
				"deliver Pie to Jack Horner, get Sixpence
			]td
			[td 
				"13:09
			]td
		]tr
		[tr 
			[td 
				"go to room 15 (crooked house exterior)
			]td
			[td 
				"deliver Sixpence to Crooked Man
			]td
			[td 
				"14:26
			]td
		]tr
		[tr 
			[td 
				"go to room 40 (crooked house interior)
			]td
			[td 
				"get Horse
			]td
			[td 
				"15:09
			]td
		]tr
		[tr 
			[td 
				"go to room 18 (Banbury Cross)
			]td
			[td 
				"deliver Horse
			]td
			[td 
				"15:44
			]td
		]tr
		[tr 
			[td 
				"go to room 16
			]td
			[td 
				"get Sheep
			]td
			[td 
				"16:38
			]td
		]tr
		[tr 
			[td 
				"go to room 23
			]td
			[td 
				"deliver Sheep to Little Bo-Peep
			]td
			[td 
				"16:44
			]td
		]tr
		[tr 
			[td 
				"go to room 22
			]td
			[td 
				"get Pail
			]td
			[td 
				"17:20
			]td
		]tr
		[tr 
			[td 
				"go to room 1 (well)
			]td
			[td 
				"deliver Pail to Jack and Jill
			]td
			[td 
				"17:47
			]td
		]tr
		[tr 
			[td 
				"go to room 8
			]td
			[td 
				"get Miss Muffet
			]td
			[td 
				"18:19
			]td
		]tr
		[tr 
			[td 
				"go to room 9
			]td
			[td 
				"deliver Miss Muffet
			]td
			[td 
				"18:33
			]td
		]tr
		[tr 
			[td 
				"go to room 2
			]td
			[td 
				"get Knife
			]td
			[td 
				"19:13
			]td
		]tr
		[tr 
			[td 
				"go to room 3 (castle courtyard west)
			]td
			[td 
				"deliver Knife to Tommy Tucker
			]td
			[td 
				"19:53
			]td
		]tr
		[tr 
			[td 
				"go to room 20
			]td
			[td 
				"get Little Lamb
			]td
			[td 
				"21:01
			]td
		]tr
		[tr 
			[td 
				"go to room 13 (school exterior)
			]td
			[td 
				"deliver Little Lamb to Mary
			]td
			[td 
				"21:10
			]td
		]tr
		[tr 
			[td 
				"go to room 39
			]td
			[td 
				"get Fiddle
			]td
			[td 
				"21:58
			]td
		]tr
		[tr 
			[td 
				"go to room 7
			]td
			[td 
				"deliver Fiddle to cat
			]td
			[td 
				"22:16
			]td
		]tr
		[tr 
			[td 
				"go to room 14
			]td
			[td 
				"get Wife
			]td
			[td 
				"22:58
			]td
		]tr
		[tr 
			[td 
				"go to room 12 (pumpkin house exterior)
			]td
			[td 
				"deliver Wife to Peter Pumpkin Eater
			]td
			[td 
				"23:33
			]td
		]tr
		[tr 
			[td 
				"go to room 6
			]td
			[td 
				"get Fiddlers Three
			]td
			[td 
				"24:18
			]td
		]tr
		[tr 
			[td 
				"go to room 37 (castle interior)
			]td
			[td 
				"deliver Fiddlers Three to Old King Cole
			]td
			[td 
				"25:17
			]td
		]tr
	]tbody
]table
[h2 id=FloppyDriveDelay 
	" Floppy drive delay
	$LF
]h2
[div class=p 
	"The game runs directly from the A: floppy drive.
	$LF
	"A hard disk drive was an
	$LF
	[a href=https://archive.org/details/Tandy1000SL2InstalationAndOperationManual/page/n27/mode/1up rel=noopener external nofollow 
		"optional upgrade
	]a
	$LF
	"for the Tandy SL/2,
	$LF
	"and even on other PC-compatibles,
	$LF
	"directly from floppy is how
	$LF
	"many would have played back in the day.
	$LF
	"The floppy drive adds another dimension to optimization,
	$LF
	"namely 
	(__wikiLink|displaytext=the time needed to read data|href=/Forum/Posts/516532)
	".
	$LF
	"When you enter a new room, deliver an item,
	$LF
	"or collect certain items,
	$LF
	"there is a delay while the game reads data from the drive.
	$LF
	"It's obviously a good idea to minimize the number of floppy drive accesses,
	$LF
	"but it's even a little more complicated than that.
	$LF
	"The disk drive motor needs to spin up before you can read data,
	$LF
	"which takes about 1.2 seconds.
	$LF
	"The OS keeps the motor spinning ("hot")
	$LF
	"for about 1.5 seconds after the drive is used.
	$LF
	"If you do another access while the drive is still hot,
	$LF
	"you avoid the cost of spinning it up.
	$LF
	"But if too much time passes,
	$LF
	"you must pay the spin-up cost again
	$LF
	"at the next disk access.
	$LF
]div
[div class=p 
	"So, while you want to access the drive
	$LF
	"as little as possible,
	$LF
	"when you 
	[em 
		"do
	]em
	" need to access it,
	$LF
	"you want to batch as many consecutive accesses together as possible,
	$LF
	"in order to amortize the drive motor delay.
	$LF
	"In most cases, the most accesses we can string together is 1 or 2,
	$LF
	"but sometimes we manage 3 or 4.
	$LF
]div
[h2 id=0015NameEntry 
	" 00:15 Name entry
	$LF
]h2
[div class=p 
	"A one-character name is quickest to enter.
	$LF
	"The traditional TAS name "A" doesn't work,
	$LF
	"because the AGI 
	[a href=http://agiwiki.sierrahelp.com/index.php?title=Parse rel=noopener external nofollow 
		"text parser
	]a
	$LF
	"treats the word "a" specially.
	$LF
	"For the same reason, the name "I" doesn't work
	$LF
	"(and actually softlocks).
	$LF
	"I used the name "@"
	$LF
	"in honor of the 
	[a href=http://www.roguebasin.com/index.php/%40 rel=noopener external nofollow 
		"classic roguelike protagonist
	]a
	".
	$LF
]div
[h2 id=0200GameSpeed 
	" 02:00 Game speed
	$LF
]h2
[div class=p 
	[img alt=Screenshot showing "Fast" being selected from the "Speed" menu. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-fast.png 
	]img
	$LF
]div
[div class=p 
	"For this TAS,
	$LF
	"I decided to break with tradition
	$LF
	"and play the game on "Fast" speed rather than "Fastest".
	$LF
	"On Fastest, the game's speed depends on the speed
	$LF
	"of the emulated CPU.
	$LF
	"On Fast, the game runs at a fixed rate of 20 cycles per second.
	$LF
]div
[div class=p 
	"The player character can move 1 pixel per game cycle
	$LF
	"(horizontally or vertically or both).
	$LF
	"It may look like the player moves 2 pixels per cycle horizontally,
	$LF
	"but that is because the game's graphics are
	$LF
	"stretched 2× horizontally—internally, the 
	[em 
		"x
	]em
	"-coordinate
	$LF
	"only changes by 1 unit.
	$LF
	"Therefore it takes 1 second to move 20 pixels.
	$LF
	"If you need to move both horizontally and vertically,
	$LF
	"the time needed
	$LF
	"is proportional to the 
	[em 
		"maximum
	]em
	" of the
	$LF
	"horizontal and vertical distances
	$LF
	"(
	[a href=https://en.wikipedia.org/wiki/Chebyshev_distance rel=noopener external nofollow 
		"Chebyshev distance
	]a
	");
	$LF
	"i.e., diagonal movement is free.
	$LF
	"The walkable area of rooms is usually
	$LF
	"160 pixels wide and 80 pixels tall,
	$LF
	"but there are many exceptions.
	$LF
]div
[h2 id=0200ShortcutBehindMotherGooseSHouse 
	" 02:00 Shortcut behind Mother Goose's house
	$LF
]h2
[div class=p 
	"We start in room 32, at the bottom center of the map.
	$LF
	"The route calls for
	$LF
	"moving left, into room 31.
	$LF
	"Instead of walking immediately left,
	$LF
	"we first walk up, to the back of the house,
	$LF
	"then left.
	$LF
]div
[div class=p 
	"AGI adventure games are programmed in a bytecode called
	$LF
	[a href=http://agiwiki.sierrahelp.com/index.php?title=Logic_Resource_(AGI) rel=noopener external nofollow 
		"logic
	]a
	".
	$LF
	"The connections between rooms are not represented in any
	$LF
	"systematic or structured way,
	$LF
	"but as snippets of logic code in each room.
	$LF
	"This is one of many places
	$LF
	"where custom, room-specific logic
	$LF
	"alters room connectivity in a way that is not visually apparent.
	$LF
	"This is the relevant logic in room 32:
	$LF
]div
[pre 
	"get.posn(O_EGO, v212, v213);
	$LF
	"if (v212 < 62 && v213 < 95) {
	$LF
	"  new.room(31);
	$LF
	"}
	$LF
]pre
[div class=p 
	"It says: if the player's 
	[em 
		"y
	]em
	"-coordinate
	$LF
	"is less than (closer to the top of the screen than) 95,
	$LF
	"and their 
	[em 
		"x
	]em
	"-coordinate is less than 62,
	$LF
	"then immediately move into room 31.
	$LF
	"It means that the threshold for entering room 31,
	$LF
	"when you're behind the house,
	$LF
	"is 
	[em 
		"x
	]em
	"-coordinate 62,
	$LF
	"which is faster to get to than
	$LF
	"walking to 
	[em 
		"x
	]em
	"-coordinate 0
	$LF
	"from the front of the house.
	$LF
	"Visually, it looks like this:
	$LF
]div
[div class=p 
	[a href=https://www.bamsoftware.com/computers/tasvideos/mumg-D5-connectivity.svg rel=noopener external nofollow 
		[img alt=Picture of room 32 with zones that transfer to other rooms highlighted. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-D5-connectivity.png 
		]img
	]a
	$LF
]div
[div class=p 
	"(The game internally locates the player
	$LF
	"by the bottom left pixel of their sprite,
	$LF
	"but in connectivity graphics like this one
	$LF
	"I have adjusted the visual zones to be relative
	$LF
	"to the bottom center of the sprite.
	$LF
	"The player sprite is 7 pixels wide.)
	$LF
]div
[div class=p 
	"Nearly every room has custom logic like this
	$LF
	"that controls movement to neighboring rooms.
	$LF
	"There is no way to infer the rules from the graphics;
	$LF
	"in every room you have to read the logic and check for exceptions.
	$LF
	"We will use this shortcut behind the house again, in the reverse direction,
	$LF
	"when we return with the Little Dog—only then,
	$LF
	"it will be defined in the logic of room 31.
	$LF
	"A shortcut in one direction does not automatically imply
	$LF
	"a shortcut in the opposite direction.
	$LF
]div
[h2 id=0242LittleDogDelivery 
	" 02:42 Little Dog delivery
	$LF
]h2
[div class=p 
	"The first item we collect and deliver is the Little Dog.
	$LF
	"We must take the dog from room 30 to room 27,
	$LF
	"which means moving 4 rooms east and 1 room north.
	$LF
	"Here is one of the places where we
	$LF
	"batch floppy drive accesses.
	$LF
	"We go north from room 32 to room 25 near the right edge of the screen,
	$LF
	"so that we can then go east from room 25 to room 26
	$LF
	"while the floppy drive is still hot.
	$LF
	"This "corner cutting" technique will be used repeatedly.
	$LF
	"I tested every corners on the path between room 30 and room 27,
	$LF
	"and this one was the fastest.
	$LF
]div
[h2 id=0439OutOfBoundsCandlestick 
	" 04:39 Out-of-bounds Candlestick
	$LF
]h2
[div class=p 
	"We collect the Broth from room 28 and deliver it to
	$LF
	"the old woman who lives in a shoe,
	$LF
	"one room to the north.
	$LF
	"Inside the shoe is the next item, the Candlestick.
	$LF
]div
[div class=p 
	[img alt=Animated gameplay capture showing the player walking out of bounds in room 44 to collect the Candlestick. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-G3I-oob.gif 
	]img
	$LF
]div
[div class=p 
	"Although it's not visually obvious, the player
	$LF
	"takes a shortcut out of bounds in the shoe house.
	$LF
	"The trick takes advantage of an oversight in this room's
	$LF
	[a href=http://agiwiki.sierrahelp.com/index.php?title=An_Explanation_of_AGI_Priority_Screens rel=noopener external nofollow 
		"priority screen
	]a
	",
	$LF
	"the hidden layer of graphics that defines where
	$LF
	"the player is allowed to walk, among other things.
	$LF
	"This is what the room's priority screen looks like,
	$LF
	"with the relevant part magnified:
	$LF
]div
[div class=p 
	[img alt=The priority of room 44, with a 4× zoom near the door showing that a black line does not reach the bottom row of pixels. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-G3I-priority-exploded.png 
	]img
	$LF
]div
[div class=p 
	"The blue and black lines define the walkable area:
	$LF
	"the player may not cross these lines.
	$LF
	"The area by the door is marked with a green line
	$LF
	"(a 
	[a href=http://agiwiki.sierrahelp.com/index.php?title=Vortex_AGI_Tutorials_-_Visual_vs_Priority#Control_Lines rel=noopener external nofollow 
		"signal line
	]a
	")
	$LF
	"as if it were a door,
	$LF
	"but the logic of the room does not actually treat it as a door.
	$LF
	"Instead, the green pixels are inert,
	$LF
	"walkable pixels, which form a 1-pixel gap
	$LF
	"at the bottom of the screen that
	$LF
	"leads outside the intended walkable area.
	$LF
	"Though out of bounds,
	$LF
	"we can still get close enough to be within the Candlestick's collection radius.
	$LF
	"Being out of bounds saves time
	$LF
	"in exiting the room,
	$LF
	"because we can walk straight down
	$LF
	"rather than having to walk all the way back to the door.
	$LF
]div
[h2 id=0519CandlestickDelivery 
	" 05:19 Candlestick delivery
	$LF
]h2
[div class=p 
	"We enter room 33, to deliver the Candlestick, from the north,
	$LF
	"because entering from the north provides us with about 43 pixels of free horizontal movement.
	$LF
	"To avoid the player being hidden by foreground objects,
	$LF
	"like trees,
	$LF
	"room logic sometimes forces the player's position to
	$LF
	"certain values.
	$LF
	"On entering room 33 from the north,
	$LF
	"if the player's 
	[em 
		"x
	]em
	"-coordinate is greater than 130
	$LF
	"(i.e., behind the tree),
	$LF
	"it gets set to 110 instead.
	$LF
	"(Something similar would happen near the left edge of the screen.)
	$LF
]div
[pre 
	"get.posn(O_EGO, v212, v213);
	$LF
	"if (prev_room_no == 26) {
	$LF
	"  if (v212 > 130) {
	$LF
	"    position(O_EGO, 110, 86);
	$LF
	"  } else {
	$LF
	"    if (v212 > 80) {
	$LF
	"      position(O_EGO, 80, 86);
	$LF
	"    }
	$LF
	"  }
	$LF
	"}
	$LF
]pre
[div class=p 
	"The delivery of the Candlestick,
	$LF
	"like most deliveries in this game,
	$LF
	"is based on distance from a point.
	$LF
	"Delivery is triggered when the player is within
	$LF
	"19 pixels of Jack.
	$LF
	[a href=http://agiwiki.sierrahelp.com/index.php?title=Distance rel=noopener external nofollow 
		"Distance
	]a
	" in AGI
	$LF
	"is defined as the sum of horizontal distance and vertical displacement
	$LF
	"(
	[a href=https://en.wikipedia.org/wiki/Taxicab_geometry rel=noopener external nofollow 
		"Manhattan distance
	]a
	").
	$LF
	"Therefore the delivery radius defines a diamond-shaped area:
	$LF
]div
[div class=p 
	[a href=https://www.bamsoftware.com/computers/tasvideos/mumg-E5-deliver.svg rel=noopener external nofollow 
		[img alt=Picture of room 33 with the delivery zone highlighted. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-E5-deliver.png 
		]img
	]a
	$LF
]div
[div class=p 
	"But the goal is not simply to get inside the delivery area as fast as possible.
	$LF
	"The player is usually scripted to move
	$LF
	"to fixed waypoints after initiating the delivery,
	$LF
	"and during cutscenes,
	$LF
	"the player moves at half speed.
	$LF
	"It is usually best to move the player to the point in
	$LF
	"the delivery area that is closest to the first waypoint.
	$LF
	"In the graphic above,
	$LF
	"the first waypoint is marked by a black dot.
	$LF
	"In this room, the player walks down and right,
	$LF
	"in order to get close to the waypoint
	$LF
	"before starting the delivery.
	$LF
]div
[div class=p 
	"The delivery cutscene must be loaded from disk.
	$LF
	"Here, we were able to start the delivery
	$LF
	"with the floppy drive still hot
	$LF
	"from entering the room.
	$LF
]div
[h2 id=0727BowlLadderAndPipe 
	" 07:27 Bowl, Ladder, and Pipe
	$LF
]h2
[div class=p 
	"After collecting and delivering the Watering Can,
	$LF
	"the route has us collect the Bowl in room 29
	$LF
	"and move it to Old King Cole's castle (room 37).
	$LF
	"We cannot actually deliver the Bowl yet, because Old King Cole
	$LF
	"will demand his Pipe first.
	$LF
	"What we can do is take the Bowl to the castle now
	$LF
	"and swap it with the Ladder there.
	$LF
]div
[div class=p 
	"The Ladder needs to go to Humpty Dumpty,
	$LF
	"who is two rooms away in room 5.
	$LF
	"Exiting room 5 to the south causes diagonal movement to room 11,
	$LF
	"where the Pipe is.
	$LF
]div
[div class=p 
	"We take the Pipe to the castle and deliver it to Old King Cole,
	$LF
	"then immediately deliver the Bowl that we stashed there earlier.
	$LF
	"The king now asks for his Fiddlers Three,
	$LF
	"which will be our last delivery.
	$LF
]div
[h2 id=1136ClockHouseShortcut 
	" 11:36 Clock house shortcut
	$LF
]h2
[div class=p 
	"After visiting the castle, we begin
	$LF
	"a circuit through the houses in town.
	$LF
	"The first stop is room 19,
	$LF
	"Jack Horner's side yard,
	$LF
	"where we collect the Mouse.
	$LF
	"We take the Mouse across the street
	$LF
	"and deliver it at the clock house, room 41.
	$LF
]div
[div class=p 
	"In the clock house we collect the Steak,
	$LF
	"whose destination is room 36, to the north.
	$LF
	"Because there is a hedge dividing room 17 horizontally,
	$LF
	"if we were to obey the intended map connectivity,
	$LF
	"we would have to go east to the main road (room 25),
	$LF
	"then northwest to room 17, then north to rooms 10 and 36.
	$LF
	"Instead, we use a connectivity glitch to shortcut directly to
	$LF
	"the other side of the hedge in room 17.
	$LF
]div
[div class=p 
	[a href=https://www.bamsoftware.com/computers/tasvideos/mumg-C4-connectivity.svg rel=noopener external nofollow 
		[img alt=Picture of room 24 with zones that transfer to other rooms highlighted. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-C4-connectivity.png 
		]img
	]a
	$LF
]div
[div class=p 
	"It is intended that the player be able to walk around the back of the house
	$LF
	"to arrive at the side yard, inside the hedge in room 17.
	$LF
	"The logic of room 24
	$LF
	"defines a special connectivity zone that juts down from the horizon,
	$LF
	"behind the house,
	$LF
	"to make this transition easier.
	$LF
	"The logic in room 17 decides where to place the player
	$LF
	"based on their 
	[em 
		"x
	]em
	"-coordinate:
	$LF
	"if the player is sufficiently far to the left,
	$LF
	"it assumes the player must have come from outside
	$LF
	"the town wall;
	$LF
	"otherwise it places the player inside the yard.
	$LF
	"But the logic in room 17 is slightly out of sync
	$LF
	"with the dimensions of the special connectivity zone in room 24.
	$LF
	"There is a 1-pixel-wide strip inside the wall in room 24
	$LF
	"that is far enough to the left to be considered outside the wall in room 17.
	$LF
	"This shortcut not only avoids having to enter room 25,
	$LF
	"it also puts the player closer to the gate in room 17.
	$LF
]div
[h2 id=1736MissMuffetDodge 
	" 17:36 Miss Muffet dodge
	$LF
]h2
[div class=p 
	"The next few deliveries are straightforward.
	$LF
	"We deliver the Steak to the Sprats
	$LF
	"and the Pie to Jack Horner,
	$LF
	"then make a round trip to the Crooked Man's house
	$LF
	"to deliver the Sixpence and bring back the Horse.
	$LF
	"Then we go to room 22 to collect the Pail.
	$LF
	"In taking the Pail north,
	$LF
	"we benefit from having already delivered the Sixpence.
	$LF
	"If we had not,
	$LF
	"a short cutscene would play as we passed by
	$LF
	"the Crooked Man outside his house.
	$LF
]div
[div class=p 
	[img alt=Animated gameplay capture showing the player narrowly avoiding the item collection radius of Miss Muffet in room 8. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-A2-dodge.gif 
	]img
	$LF
]div
[div class=p 
	"In room 8 we narrowly avoid getting too close
	$LF
	"to Miss Muffet, which would trigger an undesired item swap
	$LF
	"and a cutscene.
	$LF
	"The dodge is just barely possible.
	$LF
	"The zigzag movement
	$LF
	"to avoid Miss Muffet and the tree
	$LF
	"does not lose any time,
	$LF
	"because in this room and the next
	$LF
	"we are bottlenecked on vertical movement,
	$LF
	"not horizontal.
	$LF
]div
[h2 id=1908KnifeDelivery 
	" 19:08 Knife delivery
	$LF
]h2
[div class=p 
	"After delivering the Pail to Jack and Jill,
	$LF
	"we return to Miss Muffet
	$LF
	"and take her to her tuffet, one room away.
	$LF
]div
[div class=p 
	"The next step in the route is to get the Knife
	$LF
	"from room 2 and take it to Tommy Tucker in room 3.
	$LF
	"Although the rooms are adjacent,
	$LF
	"there is a wall between them.
	$LF
	"It looks like a long walk around the wall and into town,
	$LF
	"and it is,
	$LF
	"but we speed it up by batching four consecutive floppy drive accesses
	$LF
	"and taking advantage of some unintuitive room connectivity.
	$LF
]div
[div class=p 
	[img alt=Animated composite of the player walking from room 9 to room 2, collecting the Knife and returning to room 9, clipping the corner of room 10, and then entering room 17. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-knife-return.gif 
	]img
	$LF
]div
[div class=p 
	"After delivering Miss Muffet in room 9,
	$LF
	"we walk north to room 2 to collect the Knife,
	$LF
	"then return south to room 9.
	$LF
	"While we have to spin up the floppy drive
	$LF
	"to cross from room 9 to room 2,
	$LF
	"the Knife is close enough to the bottom of room 2
	$LF
	"that we can dip in and out while the drive is still hot.
	$LF
]div
[div class=p 
	"If we were to follow the game map graphic,
	$LF
	"from room 9 we would next
	$LF
	"walk one room south to room 16,
	$LF
	"then one room east to room 17.
	$LF
	"That would require traversing the whole of room 9 vertically,
	$LF
	"which is not only slow in itself (about 4 seconds),
	$LF
	"but would let the floppy drive spin down.
	$LF
	"Instead, we go east to room 10,
	$LF
	"where there is a little triangle of walkable area
	$LF
	"outside the wall.
	$LF
	"The connectivity from this little region of the map is not intuitive.
	$LF
	"If the player's 
	[em 
		"y
	]em
	"-coordinate is higher on the screen than row 113,
	$LF
	"touching the left edge of the screen takes you west, as you might expect.
	$LF
	"But if you are lower than that threshold,
	$LF
	"touching the left edge of the screen takes you 
	[em 
		"south
	]em
	", to room 17:
	$LF
]div
[pre 
	"if (ego_edge_code == 4) { // left edge of screen
	$LF
	"  get.posn(O_EGO, v212, v213);
	$LF
	"  if (v213 > 112) {
	$LF
	"    new.room(17);
	$LF
	"  } else {
	$LF
	"    new.room(9);
	$LF
	"  }
	$LF
	"}
	$LF
]pre
[div class=p 
	"Besides batching floppy drive accesses,
	$LF
	"this technique saves vertical movement.
	$LF
	"The player is hardcoded to enter room 10
	$LF
	"at 
	[em 
		"y
	]em
	"-coordinate 105.
	$LF
	"Going south from room 10 therefore only requires
	$LF
	"walking down 8 pixels,
	$LF
	"rather than all the way to the bottom edge
	$LF
	"as would be required in room 9.
	$LF
]div
[div class=p 
	"When we finally deliver the Knife to Tommy Tucker
	$LF
	"in room 3,
	$LF
	"see how we walk to the left side before entering
	$LF
	"the delivery area.
	$LF
	"This is for the same reason that we delayed delivering the Candlestick to Jack:
	$LF
	"the delivery cutscene
	$LF
	"automatically moves the player to a waypoint
	$LF
	"towards the left,
	$LF
	"and the player moves at half speed during cutscenes.
	$LF
]div
[h2 id=2329PumpkinHouseShortcut 
	" 23:29 Pumpkin house shortcut
	$LF
]h2
[div class=p 
	"The last four items are in the northeast part of the map.
	$LF
	"Mary's lost Little Lamb is one room south of where it needs to be;
	$LF
	"and then inside the schoolhouse is the Fiddle
	$LF
	"that needs to be delivered to the cat in room 7.
	$LF
]div
[div class=p 
	"In taking Peter Pumpkin Eater's Wife
	$LF
	"back to her house,
	$LF
	"we take advantage of a connectivity glitch
	$LF
	"similar to the one we used at the clock house.
	$LF
	"The intended way of entering the yard of room 12
	$LF
	"is to walk through the front gate from room 19.
	$LF
	"But in another instance of room logic not
	$LF
	"exactly agreeing with the walkable area of rooms,
	$LF
	"we can "jump the wall" from the right side of room 19.
	$LF
	"We walk south from room 12 to room 19
	$LF
	"along the east wall,
	$LF
	"then immediately return to room 12 by walking north,
	$LF
	"far enough to the left that the logic of room 12 places the player inside the yard.
	$LF
]div
[div class=p 
	[a href=https://www.bamsoftware.com/computers/tasvideos/mumg-E3-connectivity.svg rel=noopener external nofollow 
		[img alt=Picture of room 19 with zones that transfer to other rooms highlighted. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-E3-connectivity.png 
		]img
	]a
	$LF
]div
[div class=p 
	"The shortcut is not symmetric:
	$LF
	"there is no reciprocal direct connection from inside the yard
	$LF
	"in room 12
	$LF
	"to outside the wall in room 19.
	$LF
]div
[h2 id=2517FinalDelivery 
	" 25:17 Final delivery
	$LF
]h2
[div class=p 
	"We return to the northeast portion of the map to collect the Fiddlers Three,
	$LF
	"again hugging the wall
	$LF
	"for faster vertical movement.
	$LF
]div
[div class=p 
	"After the delivery cutscene plays,
	$LF
	"we have to press a key to dismiss the text.
	$LF
	"After that, the ending cutscene plays out by itself.
	$LF
]div
[h2 id=FrameCountsByCategory 
	" Frame counts by category
	$LF
]h2
[div class=p 
	"Like 
	[em 
		"Ocarina of Time
	]em
	",
	$LF
	"the speedrun of this game consists more of cutscenes
	$LF
	"than gameplay.
	$LF
]div
[table 
	[tbody 
		[tr 
			[th 
				"Category
			]th
			[th 
				"Frames
			]th
			[th 
				"Minutes
			]th
			[th 
				"Percentage
			]th
		]tr
		[tr 
			[td 
				"Boot and DOS prompt
			]td
			[td 
				"175
			]td
			[td 
				"0:02
			]td
			[td 
				"0.1%
			]td
		]tr
		[tr 
			[td 
				"Menuing
			]td
			[td 
				"87
			]td
			[td 
				"0:01
			]td
			[td 
				"0.0%
			]td
		]tr
		[tr 
			[td 
				"Gameplay
			]td
			[td 
				"42558
			]td
			[td 
				"7:06
			]td
			[td 
				"27.4%
			]td
		]tr
		[tr 
			[td 
				"Cutscenes
			]td
			[td 
				"65479
			]td
			[td 
				"10:55
			]td
			[td 
				"42.2%
			]td
		]tr
		[tr 
			[td 
				"Floppy drive motor delay
			]td
			[td 
				"10230
			]td
			[td 
				"1:42
			]td
			[td 
				"6.6%
			]td
		]tr
		[tr 
			[td 
				"Floppy drive data access
			]td
			[td 
				"18109
			]td
			[td 
				"3:01
			]td
			[td 
				"11.7%
			]td
		]tr
		[tr 
			[td 
				"Room loading
			]td
			[td 
				"18086
			]td
			[td 
				"3:01
			]td
			[td 
				"11.7%
			]td
		]tr
		[tr 
			[td 
				"Doors opening/closing
			]td
			[td 
				"458
			]td
			[td 
				"0:05
			]td
			[td 
				"0.3%
			]td
		]tr
	]tbody
]table
[h2 id=Utilities 
	" Utilities
	$LF
]h2
[pre 
	"git clone https://www.bamsoftware.com/git/mumg.git
	$LF
]pre
[div class=p 
	"The tools and notes I made
	$LF
	"in the course of creating this TAS
	$LF
	"are available in the Git repository above.
	$LF
	"They include:
	$LF
]div
[ul 
	[li 
		" A reimplementation of the game's random assignment algorithm
		$LF
	]li
	[li 
		" Extracted picture and priority graphics
		$LF
	]li
	[li 
		" Decompiled and lightly annotated logic resources
		$LF
	]li
	[li 
		" The simulated annealing–based route optimizer
		$LF
	]li
	[li 
		" A watch file with useful RAM addresses
		$LF
	]li
]ul
[div class=p 
	[img alt=Screenshot of PCem in room 27, just before delivering the Little Dog. RAM watch values are overlaid: ego_x: 0, ego_y: 164, room_no: 27, new_room: 0, inv: 0, inv_x: 0, inv_y: 162, item_dist: 139, item_radius: 167, f117: c, floppy status: 1, floppy timer: 36. class=embed mw-100 src=https://www.bamsoftware.com/computers/tasvideos/mumg-pcem-watch.png 
	]img
	$LF
]div
[h2 id=Thanks 
	" Thanks
	$LF
]h2
[ul 
	[li 
		" 
		[a href=http://agiwiki.sierrahelp.com/index.php?title=Agikit rel=noopener external nofollow 
			"agikit
		]a
		" by Nat Budin, which was indispensable for its ability to decompile AGI logic resources.
		$LF
	]li
	[li 
		" 
		[a href=http://agiwiki.sierrahelp.com/index.php?title=Main_Page rel=noopener external nofollow 
			"AGI Programmers' Wiki
		]a
		", with references for logic commands and file formats.
		$LF
	]li
	[li 
		" 
		[a href=https://www.scummvm.org/ rel=noopener external nofollow 
			"ScummVM
		]a
		", from which I ripped the AGI 
		[a href=http://agiwiki.sierrahelp.com/index.php?title=Picture_Resource_(AGI) rel=noopener external nofollow 
			"picture resource
		]a
		" renderer to make the game map and visualize obstacles in rooms. I tried some other renderers but ScummVM's was the only one accurate enough to draw all the rooms correctly.
		$LF
	]li
	[li 
		" 
		[a href=https://github.com/eviltrout/agi-upscale rel=noopener external nofollow 
			"agi-upscale
		]a
		" and its 
		[a href=https://www.youtube.com/watch?v=sclZDCjUVvI rel=noopener external nofollow 
			"associated video
		]a
		", which is what got me interested in AGI.
		$LF
	]li
]ul
[hr 
]hr
[div class=p 
	[a class=intlink href=/Users/Profile/slamo 
		"slamo
	]a
	": Replaced movie file to fix the platform, and judging!
	$LF
]div
[div class=p 
	[a class=intlink href=/Users/Profile/slamo 
		"slamo
	]a
	": Tremendously well-researched and planned as always. Great work.
	$LF
]div
[div class=p 
	"This run uses a configuration besides our three pre-made setups, which we allow as long as there are instructions on how to reproduce it. In this case, the Tandy is very easy to set up, having DOS built into the ROM, so only a .cfg file is required. The justification for this config is that the built-in sound is much better, which I think is a perfectly valid reason to use it. We were also able to sync the run, so all the information here is adequate.
	$LF
]div
[div class=p 
	"The only other thing to talk about is the game speed. There are faster runs out there, but they 1) use DOSBox, which is not exactly the paragon of accuracy, and 2) rely on a high cycle count and the Fastest speed setting, which is only limited by the CPU speed, and we explicitly disallow using unintended environments to make the gameplay faster. Fastest speed actually would have been fine in this case, since you're playing the game on intended hardware, but I'm not going to sweat the game speed too much, especially if you have ambitions to console-verify this. As long as the gameplay is optimized (which it is), then we're copacetic.
	$LF
]div
[div class=p 
	"Accepting!
	$LF
]div
[div class=p 
	[a class=intlink href=/Users/Profile/fsvgm777 
		"fsvgm777
	]a
	": Processing.
]div
