6
[div class=card mb-2 
	[div class=card-header 
		[strong 
			"Table of contents
		]strong
	]div
	[div class=card-body 
		[ul 
			[li 
				[a href=#Introduction 
					" Introduction
					$LF
				]a
				[ul 
					[li 
						[a href=#CategoryRules 
							" Category Rules
							$LF
						]a
					]li
				]ul
			]li
			[li 
				[a href=#Story 
					" Story
					$LF
				]a
			]li
			[li 
				[a href=#SoftwareHardware 
					" Software + Hardware
					$LF
				]a
				[ul 
					[li 
						[a href=#RomInformation 
							" Rom Information
							$LF
						]a
					]li
					[li 
						[a href=#Emulator 
							" Emulator
							$LF
						]a
					]li
					[li 
						[a href=#RoutingBot 
							" Routing Bot
							$LF
						]a
					]li
				]ul
			]li
			[li 
				[a href=#Timing 
					" Timing
					$LF
				]a
				[ul 
					[li 
						[a href=#Criteria 
							" Criteria
							$LF
						]a
					]li
					[li 
						[a href=#ComparisonMovie 
							" Comparison Movie
							$LF
						]a
					]li
					[li 
						[a href=#TimeTable 
							" Time Table
							$LF
						]a
					]li
				]ul
			]li
			[li 
				[a href=#LevelBreakdownNotesByChallenger 
					" Level Breakdown (Notes by Challenger)
					$LF
				]a
				[ul 
					[li 
						[a href=#Level01 
							" Level 01
							$LF
						]a
					]li
					[li 
						[a href=#Level02 
							" Level 02
							$LF
						]a
					]li
					[li 
						[a href=#Level03 
							" Level 03
							$LF
						]a
					]li
					[li 
						[a href=#Level04 
							" Level 04
							$LF
						]a
					]li
					[li 
						[a href=#Level05 
							" Level 05
							$LF
						]a
					]li
					[li 
						[a href=#Level06 
							" Level 06
							$LF
						]a
					]li
					[li 
						[a href=#Level07 
							" Level 07
							$LF
						]a
					]li
					[li 
						[a href=#Level08 
							" Level 08
							$LF
						]a
					]li
					[li 
						[a href=#Level09 
							" Level 09
							$LF
						]a
					]li
					[li 
						[a href=#Level10 
							" Level 10
							$LF
						]a
					]li
					[li 
						[a href=#Level11 
							" Level 11
							$LF
						]a
					]li
					[li 
						[a href=#Level12 
							" Level 12
							$LF
						]a
					]li
					[li 
						[a href=#Level13 
							" Level 13
							$LF
						]a
					]li
					[li 
						[a href=#Level14 
							" Level 14
							$LF
						]a
					]li
					[li 
						[a href=#Level15 
							" Level 15
							$LF
						]a
					]li
					[li 
						[a href=#Level16 
							" Level 16
							$LF
						]a
					]li
					[li 
						[a href=#Level17 
							" Level 17
							$LF
						]a
					]li
					[li 
						[a href=#Level18 
							" Level 18
							$LF
						]a
					]li
					[li 
						[a href=#Level19 
							" Level 19
							$LF
						]a
					]li
					[li 
						[a href=#Level20 
							" Level 20
							$LF
						]a
					]li
				]ul
			]li
			[li 
				[a href=#OpportunitiesForImprovement 
					" Opportunities for Improvement
					$LF
				]a
				[ul 
					[li 
						[a href=#BetterLagManagement 
							" Better Lag Management
							$LF
						]a
					]li
					[li 
						[a href=#FullGameRngManipulation 
							" Full-Game RNG Manipulation
							$LF
						]a
					]li
				]ul
			]li
			[li 
				[a href=#SuggestedScreenshots 
					" Suggested screenshots
					$LF
				]a
			]li
			[li 
				[a href=#OtherComments 
					" Other comments
					$LF
				]a
			]li
			[li 
				[a href=#EncoderInformation 
					" Encoder information
					$LF
				]a
			]li
			[li 
				[a href=#RamMap 
					" RAM Map
					$LF
				]a
			]li
		]ul
	]div
]div
[h3 id=Introduction 
	" Introduction
	$LF
]h3
[div class=p 
	"This movie improves on 
	(__wikiLink|href=/3271M|implicitdisplaytext=3271M)
	" by a bit more than a minute thanks for small optimizations all round and a few new tricks (detailed below).
	$LF
]div
[h4 id=CategoryRules 
	" Category Rules
	$LF
]h4
[ul 
	[li 
		" Aims for in-game time instead of real-time
		$LF
	]li
	[li 
		" Uses no passwords
		$LF
	]li
	[li 
		" Takes damage to save time
		$LF
	]li
	[li 
		" Uses death to save time (this is hard to notice, but we actually die on level 17 while completing the level)
		$LF
	]li
	[li 
		" Heavy glitch abuse
		$LF
	]li
	[li 
		" Heavy luck manipulation (uses pausing to influence enemy actions)
		$LF
	]li
]ul
[h3 id=Story 
	" Story
	$LF
]h3
[figure 
	[figcaption class=author 
		"Quoting [Challenger]
	]figcaption
	[div class=p 
		"First of all, something about the previous run: at the time I worked on this game, I did some mistakes because I wasn't aware the lag was very annoying to optimize, and I didn't use RAM watch or TAStudio to fix it (although I tried to fix it once).
		$LF
	]div
	[div class=p 
		"Second, before working on a new TAS, at the start of 2022 I decided to clean the input of the published run so I could use TAStudio smoothly. But the task ended up being a headache for me for one reason: the nature of the lag behavior.
		$LF
	]div
	[div class=p 
		"During the process, I found new improvements for the game with the main one requiring the guard (like the DOS version), perfect positioning and timing to skip some sections. The glitch was originally discovered by Shauning and enhanced by me.
		$LF
	]div
	[div class=p 
		"After several months, with the 2016 TAS recently cleaned, eien86 decided to work on the new TAS too, in November 2022. Although he submitted some snes runs this year, the Prince of Persia one technically is the first SNES project he has worked on. Using the Snes9x core and the Jaffar bot, we took around a month to create a first draft of the new TAS, beating it by around a minute.
		$LF
	]div
	[div class=p 
		"During the year of 2023, I continued the work finding small new improvements and squeezing more lag frames. As I said before, the lag can be a real problem and it means you should redo a level, some levels, or even the whole game just to try gaining a single frame at least. I put this game on hold sometimes just because of the problem. 
		$LF
	]div
	[div class=p 
		"The project was finally finished this month and before submitting this game, I decided to resync the project to BSNES core, which took a week.
		$LF
	]div
]figure
[figure 
	[figcaption class=author 
		"Quoting [eien86]
	]figcaption
	[div class=p 
		"Once again I have the tremendous privilege of working with Challenger (see, for instance 
		(__wikiLink|href=/4840M|implicitdisplaytext=4840M)
		"). I believe we bring the best of each other, each with different sets of skills, but with sheer perfectionism in common. However, although we share the same passion for TASing, he is in another level. He will work in a TAS for years and never give up until it fully satisfies his standards. This level of quality is hard to find and results in true gems.
		$LF
	]div
	[div class=p 
		"I watch every TAS we ever worked together in such awe, that it feels as if I hadn't participated. The end result is so beyond my own solo abilities that I just consider myself an accidental contributor. Anyway, I have nothing to add on the technical side, I just hope you enjoy this new instance of such magic. (In my opinion, watching the comparison movie is more entertaining!)
		$LF
	]div
]figure
[h3 id=SoftwareHardware 
	" Software + Hardware
	$LF
]h3
[h4 id=RomInformation 
	" Rom Information
	$LF
]h4
[ul 
	[li 
		" Name: Prince of Persia (Japan)
		$LF
	]li
	[li 
		" SHA1: DE1D327F90EE57C8B20E2489109638B8632F18F5
		$LF
	]li
	[li 
		" MD5: 6F49DF735CD2CF9D351D549F1CBFDAA9
		$LF
	]li
]ul
[h4 id=Emulator 
	" Emulator
	$LF
]h4
[ul 
	[li 
		" EmuHawk 2.9.0 (Core: BSNES)
		$LF
	]li
]ul
[div class=p 
	"Manually resynchronized by Challenger from a EmuHawk 2.9.0 + Snes9x movie.
	$LF
]div
[h4 id=RoutingBot 
	" Routing Bot
	$LF
]h4
[ul 
	[li 
		" Bot: 
		[a href=https://github.com/SergioMartin86/jaffarPlus rel=noopener external nofollow 
			"JaffarPlus
		]a
		$LF
	]li
	[li 
		" Routing Core: Snes9x
		$LF
	]li
	[li 
		" Platforms: 
		$LF
		[ul 
			[li 
				" AMD Ryzen Threadripper 3990X Processor (64 cores, 128 threads) + 256Gb RAM 
				$LF
			]li
		]ul
	]li
]ul
[h3 id=Timing 
	" Timing
	$LF
]h3
[h4 id=Criteria 
	" Criteria
	$LF
]h4
[div class=p 
	"We use the following addresses for timing:
	$LF
]div
[pre 
	[code 
		$UNPRINTABLE TEXT!!!
	]code
]pre
[div class=p 
	"And the following criteria:
	$LF
]div
[ul 
	[li 
		" Level Start: The first in game frame, as soon as the red zone ends.
		$LF
	]li
	[li 
		" Transition Start: The 'Current Level' value increases by one
		$LF
	]li
]ul
[h4 id=ComparisonMovie 
	" Comparison Movie
	$LF
]h4
[div class=p 
	"Here is a per-level comparison between this movie and the currently published TAS:
	$LF
]div
[div class=p 
	(Youtube|v=fmS4Uttjlms)
	$LF
]div
[h4 id=TimeTable 
	" Time Table
	$LF
]h4
[div class=p 
	"Here is a time table comparing frame timing between this movie and the currently published TAS:
	$LF
]div
[pre 
	[code 
		$UNPRINTABLE TEXT!!!
	]code
]pre
[h3 id=LevelBreakdownNotesByChallenger 
	" Level Breakdown (Notes by Challenger)
	$LF
]h3
[h4 id=Level01 
	" Level 01
	$LF
]h4
[div class=p 
	"No improvements.
	$LF
]div
[h4 id=Level02 
	" Level 02
	$LF
]h4
[div class=p 
	"Different route between the first and the second guard. Better optimization on the rooms before the third guard. 
	$LF
]div
[div class=p 
	"More optimization on the three rooms immediately after skipping the last guard and another one before going to the switch room.
	$LF
]div
[h4 id=Level03 
	" Level 03
	$LF
]h4
[div class=p 
	"A little improvement between the deadly trap and the last gate.
	$LF
]div
[h4 id=Level04 
	" Level 04
	$LF
]h4
[div class=p 
	"Different strategy at the beginning, a completely new strategy for the first guard and a little optimization at the end.
	$LF
]div
[h4 id=Level05 
	" Level 05
	$LF
]h4
[div class=p 
	"Different strategy for the automatic gate switch, a new strategy during the return until first guard skip (costs some real-time frames because guard appears on the next screen, but gains a few in-game time frames), and got a better rng for the second guard skip during the return after mirror path.
	$LF
]div
[div class=p 
	"This isn't included in this TAS, but we found a faster strategy for the second guard skip that prevents him from appearing on the next screen. It saves over a second (because lag), but unfortunately it costs some in-game frames.
	$LF
]div
[div class=p 
	"We tried and tried finding a new strategy without losing in-game time, but no success after all. That guard is very annoying for sure.
	$LF
]div
[h4 id=Level06 
	" Level 06
	$LF
]h4
[div class=p 
	"Between the first and second guard skip, different second jump pattern for lag reduction.
	$LF
]div
[div class=p 
	"We worked on a new strategy for the boss fight, killing her slightly faster.
	$LF
]div
[h4 id=Level07 
	" Level 07
	$LF
]h4
[div class=p 
	"No improvement, though the second-to-last room fixes a little mistake from the old run.
	$LF
]div
[h4 id=Level08 
	" Level 08
	$LF
]h4
[div class=p 
	"This time we have a big improvement for this level: we skip the first guard and one of the required gate switches in the middle of the level through a complicated setup, positioning, and a gate glitch, gaining some seconds.
	$LF
]div
[div class=p 
	"Soon after the glitch, we skip a ledge grab since he has extra health this time.
	$LF
]div
[div class=p 
	"The second guard fight isn't killed this time, because eien86 found an interesting strat that reduces the falling down time (there's a similar strat with the skeleton from level 3) when returning to the exit room.
	$LF
]div
[h4 id=Level09 
	" Level 09
	$LF
]h4
[div class=p 
	"Different running jump patterns between the first two rooms in order to do a running jump on the third room instead of a stop+normal jump, reaching the gate switch earlier (requires perfect position)
	$LF
]div
[div class=p 
	"Some frames gained before boss room thanks to a nice trick that allows you to run into gates a bit earlier than intended.
	$LF
]div
[div class=p 
	"For the boss fight, first of all if you manage to enter the fight with very precise positioning, the enemy will be pushed forward. Second, we skip the fight thanks to a very complicated setup and requires a good RNG in order to work properly.
	$LF
]div
[h4 id=Level10 
	" Level 10
	$LF
]h4
[div class=p 
	"Some better rng thanks to aiming for in-game time instead of real-time, as well as skipping two skeleton defeats.
	$LF
]div
[h4 id=Level11 
	" Level 11
	$LF
]h4
[div class=p 
	"Improved guard skip and the second gate, as well as optimizing some lag.
	$LF
]div
[h4 id=Level12 
	" Level 12
	$LF
]h4
[div class=p 
	"Optimized the second guard, on the path before chompers, normal jump instead of running then falling down.
	$LF
]div
[div class=p 
	"We also aimed for in-game time instead of real-time by optimizing some running jumps before going to the room with several loose tiles, skipping a ledge grab for the next room.
	$LF
]div
[div class=p 
	"An in-game frame boss fight is lost this time due to different RNG.
	$LF
]div
[h4 id=Level13 
	" Level 13
	$LF
]h4
[div class=p 
	"eien86 found a very nice strat with the first guard, requiring an extra damage to fall down earlier and skip a ledge grab and half. He also improved the second guard by not sheathing the sword then doing a normal jump - the new strat is simply walking backwards until you fall down safely.
	$LF
]div
[div class=p 
	"Before working on the project, I found a way to open "that automatic gate switch" and return to the previous room before the gate closes completely, resulting in another big improvement for this run. eien86 and I improved it further during the project.
	$LF
]div
[div class=p 
	"The next two gates were improved thanks to better knowledge of the gameplay.
	$LF
]div
[h4 id=Level14 
	" Level 14
	$LF
]h4
[div class=p 
	"Stopping + doing a normal jump on the third room isn't necessary thanks to the new first guard skip. For the second guard, we keep walking backwards this time to gain in-game time.
	$LF
]div
[div class=p 
	"This time it's possible to skip the third guard instead of killing him.
	$LF
]div
[div class=p 
	"Little improvement for one of the latest rooms.
	$LF
]div
[h4 id=Level15 
	" Level 15
	$LF
]h4
[div class=p 
	"Here comes the biggest improvement of the run: it's possible to skip most of the level with a very difficult gate glitch.
	$LF
]div
[div class=p 
	"The objective is luring the guard past the chompers with some backtracking, since this version prevents you from bypassing while walking backwards with the enemy.
	$LF
]div
[div class=p 
	"To make things even worse, the narrow spacing between the chompers will ruin the plan. We tried and tried and tried to find a solution, without success. But at least this skip saves a great amount of time!
	$LF
]div
[div class=p 
	"Some frames gained between the room before prince mirror and when he appears after returning (eien86 found a way to avoid the sword pattern)
	$LF
]div
[h4 id=Level16 
	" Level 16
	$LF
]h4
[div class=p 
	"Improved start, guard skip and the boss fight.
	$LF
]div
[h4 id=Level17 
	" Level 17
	$LF
]h4
[div class=p 
	"Select menu before the fight starts works well, giving us a better pattern for the falling skulls before skipping the fight.
	$LF
]div
[h4 id=Level18 
	" Level 18
	$LF
]h4
[div class=p 
	"We gained an in-game frame after the second gate, improved the first and second guard but got a bad RNG for the third guard, losing an in-game frame.
	$LF
]div
[pre 
	"Little improvement after the exit switch and gained time improving the latest guard.
	$LF
]pre
[h4 id=Level19 
	" Level 19
	$LF
]h4
[div class=p 
	"Improved a frame second room, gained two frames during the first backtracking and recovered the good pattern for the first enemy boss rush.
	$LF
]div
[h4 id=Level20 
	" Level 20
	$LF
]h4
[div class=p 
	"eien86 improved the first phase of the Jaffar fight.
	$LF
]div
[h3 id=OpportunitiesForImprovement 
	" Opportunities for Improvement
	$LF
]h3
[h4 id=BetterLagManagement 
	" Better Lag Management
	$LF
]h4
[div class=p 
	"Although we made quite an effort to reduce lag frames, the game insisted on punishing us with them. Some levels ended up being slower than the published movie for this very reason. A full bot-driven re-work of this movie could perhaps help in this regard.
	$LF
]div
[h4 id=FullGameRngManipulation 
	" Full-Game RNG Manipulation
	$LF
]h4
[div class=p 
	"In 
	(__wikiLink|href=/5206M|implicitdisplaytext=5206M)
	", the RNG was manipulated for the entire game to produce a 'perfect movie'. Doing something like that in this game would squeeze a few more frames (particularly in guard fights). However, it seems almost impossible with the current technology since this game is much longer and the emulation much costlier. Nevertheless, it remains a possibility. 
	$LF
]div
[h3 id=SuggestedScreenshots 
	" Suggested screenshots
	$LF
]h3
[div class=p 
	"77237
	$LF
	[img class=embed mw-100 src=https://i.ibb.co/m8jnxvq/image4.png 
	]img
	" 
	$LF
]div
[div class=p 
	"43640
	$LF
	[img class=embed mw-100 src=https://i.ibb.co/nbk2mX7/image3.png 
	]img
	" 
	$LF
]div
[div class=p 
	"37064
	$LF
	[img class=embed mw-100 src=https://i.ibb.co/6HVK3bf/image2.png 
	]img
	" 
	$LF
]div
[div class=p 
	"78836
	$LF
	[img class=embed mw-100 src=https://i.ibb.co/JzDNNFN/image1.png 
	]img
	" 
	$LF
]div
[h3 id=OtherComments 
	" Other comments
	$LF
]h3
[div class=p 
	"Challenger: Like the second game of the SNES version, this project ended up being frustrating just to spend a great amount of time attempting to squeeze frames, and sometimes you spent days just to notice the game is really stubborn. But for the other side, I'm glad I have a more polished work this time and to see new glitches despite being used on some levels.
	$LF
]div
[div class=p 
	"If someone is interested to see the original work done on Snes9x before the BSNES resync, here's: 
	[a href=https://tasvideos.org/UserFiles/Info/638379969965662474 rel=noopener external nofollow 
		"https://tasvideos.org/UserFiles/Info/638379969965662474
	]a
	$LF
]div
[h3 id=EncoderInformation 
	" Encoder information
	$LF
]h3
[div class=p 
	"Please use the following userfile for encoding; it contains further end-of-movie inputs.
	$LF
	[a href=https://tasvideos.org/UserFiles/Info/638377954437300473 rel=noopener external nofollow 
		"https://tasvideos.org/UserFiles/Info/638377954437300473
	]a
	$LF
]div
[h3 id=RamMap 
	" RAM Map
	$LF
]h3
[div class=p 
	"Found here 
	[a href=https://tasvideos.org/UserFiles/Info/638218291637079174 rel=noopener external nofollow 
		"https://tasvideos.org/UserFiles/Info/638218291637079174
	]a
	$LF
]div
[hr 
]hr
[div class=p 
	[a class=intlink href=/Users/Profile/ThunderAxe31 
		"ThunderAxe31
	]a
	": Claiming for judging.
	$LF
]div
[div class=p 
	[a class=intlink href=/Users/Profile/ThunderAxe31 
		"ThunderAxe31
	]a
	": Accepting as improvement of the 
	(__wikiLink|displaytext=current publication|href=/3271M)
	".
	$LF
]div
[hr 
]hr
[div class=p 
	[a class=intlink href=/Users/Profile/Spikestuff 
		"Spikestuff
	]a
	": Processing...
]div
