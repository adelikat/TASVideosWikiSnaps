9
[div class=p 
	"Move over Lotus 1-2-3, Microsoft Excel is here, and it might even meet TASVideos' definition of a game.
	$LF
]div
[h3 id=SyncNotes 
	" Sync notes
	$LF
]h3
[div class=p 
	(__wikiLink|displaytext=Windows 95b|href=/EmulatorResources/PCem/Windows/Configurations/95)
	" with 
	(__wikiLink|displaytext=this configuration|href=/UserFiles/Info/638791974884109087)
	".
	$LF
]div
[div class=p 
	"ROM: OFFICE95PRO.iso
	$LF
]div
[pre 
	"MD5  502721d1bf70ab13f54a7b7771128e75
	$LF
	"SHA1 97a482d89a61648797946aaf9bcd64213ecac12b
	$LF
]pre
[div class=p 
	"Verification movie: N/A
	$LF
]div
[div class=p 
	"For my own and others' sakes I decided not to use a verification movie. It wouldn't save much time and it was somewhat fun to optimise the installation process.
	$LF
]div
[h3 id=AboutTheGame 
	" About the game
	$LF
]h3
[div class=p 
	"This is an Easter egg inside Excel 95. Early Windows products contained 
	[a href=https://en.wikipedia.org/wiki/List_of_Easter_eggs_in_Microsoft_products rel=noopener external nofollow 
		"many Easter eggs
	]a
	" until they stopped the practice in 2002. Games hidden in other products include a flight simulator, pinball, and a driving game. Out of all of them, the Doom-style game in this submission has both an element of skill and credits to reach.
	$LF
]div
[div class=p 
	"To reach the game: 
	$LF
]div
[ul 
	[li 
		" Go to row 95
		$LF
	]li
	[li 
		" Highlight the row
		$LF
	]li
	[li 
		" Tab to cell B
		$LF
	]li
	[li 
		" Open Help>About Microsoft Excel
		$LF
	]li
	[li 
		" Hold down Ctrl+Shift and press Tech Support
		$LF
	]li
]ul
[div class=p 
	"Inside the game you can walk forward and up a ramp to see the credits. Or instead you can turn around and enter the code "exlkfa" to remove a wall and reveal a narrow passage (a reference to the Doom code "idkfa"). Across the passage is a room with photos of the developers, and the same credits screen as before.
	$LF
]div
[h3 id=Tas 
	" The TAS
	$LF
]h3
[div class=p 
	"I use F4 to skip two of the hardware checks during the boot sequence (not included in temp encode). This saves about 1.7 seconds. Once Windows has started, I open the Run window and start Command Prompt in the D: directory. I go to D:\OS\SYSTEM and copy over two relevant files to C:\Windows. Then I launch Excel with D:\EXCEL\EXCEL.
	$LF
]div
[div class=p 
	"Once Excel has opened, I click in the cell navigation window and go to A95. I use Ctrl+Shift+Right to highlight the row and press Tab. I enter Alt and then H to open Help dropdown, and then Up and Enter to open the About window. Then I hold Ctrl+Shift and click Tech Support to open the game.
	$LF
]div
[div class=p 
	"Inside the game I start moving backwards while entering the "exlkfa" code. I navigate through the passage to the credits room.
	$LF
]div
[div class=p 
	"Keypresses up to game start in order:
	$LF
]div
[div class= 
	[div class= 
		[ul class=nav nav-tabs role=tablist 
			[li class=nav-item 
				[a class=active nav-link data-bs-toggle=tab href=#tabs-2287-0 
					"Hide
				]a
			]li
			[li class=nav-item 
				[a class=nav-link data-bs-toggle=tab href=#tabs-2287-1 
					"Show
				]a
			]li
		]ul
	]div
	[div class=tab-content 
		[div class=tab-pane fade active show id=tabs-2287-0 
		]div
		[div class=tab-pane fade id=tabs-2287-1 
			[div class=p 
				"Win+R
				$LF
			]div
			[div class=p 
				[code 
					"command /k D:
				]code
				$LF
			]div
			[div class=p 
				"Enter
				$LF
			]div
			[div class=p 
				[code 
					"cd os\system
				]code
				$LF
			]div
			[div class=p 
				"Enter
				$LF
			]div
			[div class=p 
				[code 
					"copy mso95.dll C:\windows
				]code
				$LF
			]div
			[div class=p 
				"Enter
				$LF
			]div
			[div class=p 
				[code 
					"copy vbaen32.olb C:\windows
				]code
				$LF
			]div
			[div class=p 
				"Enter
				$LF
			]div
			[div class=p 
				[code 
					"D:\excel\excel
				]code
				$LF
			]div
			[div class=p 
				"Enter
				$LF
			]div
			[div class=p 
				[code 
					"a95
				]code
				$LF
			]div
			[div class=p 
				"Enter
				$LF
			]div
			[div class=p 
				"Ctrl+Shift+Right
				$LF
			]div
			[div class=p 
				"Tab
				$LF
			]div
			[div class=p 
				"Alt
				$LF
			]div
			[div class=p 
				"H
				$LF
			]div
			[div class=p 
				"Up
				$LF
			]div
			[div class=p 
				"Enter
				$LF
			]div
			[div class=p 
				"Ctrl+Shift
				$LF
			]div
		]div
	]div
]div
[h3 id=TechnicalDetailsReverseEngineering 
	" Technical details/reverse engineering
	$LF
]h3
[div class=p 
	"Due to the nature of this game there's little useful information to be found online. Most of the guides on how to reach the game repeat the same errors, such as suggesting the need to type "excelkfa" rather than "exlkfa". There is 
	[a href=https://www.youtube.com/watch?v=kK0M74E8PS4&lc=Ugyu-8KqLuqPC2L9Y_V4AaABAg rel=noopener external nofollow 
		"this YouTube comment thread
	]a
	" by one of the Excel developers, but I didn't find anything helpful. The 
	[a href=https://www.speedrun.com/microsoft_excel_95_hall_of_tortured_souls rel=noopener external nofollow 
		"real-time runs
	]a
	" were some help in optimising button presses. For reference, this run is about 5 or 6 seconds when compared to RTA runs (Excel boots up far slower in this TAS).
	$LF
]div
[div class=p 
	"I tried going through the game in Ghidra/WinDbg, but it began to torture my soul. I think the code may be obfuscated. I only found a function to check the state of Ctrl+Shift+Alt (50126723), and possibly a function that creates the game window (501239df). I was hoping to at least confirm what button presses are required.
	$LF
]div
[div class=p 
	"Due to all this, and PCem difficulties, I didn't have any speed or position values to go off when making this.
	$LF
]div
[h3 id=PossibleImprovements 
	" Possible improvements
	$LF
]h3
[ul 
	[li 
		" This game is very dependent on processor speed (if you want to see this in action, try installing Excel 95 on your machine and opening the game). The 233MHz processor is appropriate for this TAS though before the game starts running unreasonably fast.
		$LF
	]li
	[li 
		" Pre-installing the game would save a small amount of time. As is, I optimised the installation process as much as I could, but there might be other tricks to improve it. The VBAEN32.OLB file is technically not required to run Excel, but it will fail on the first attempt at opening which is ultimately slower.
		$LF
	]li
	[li 
		" All the keypresses were entered by trying to press keys on the same frame, and if one failed moving it to the next frame, so not completely thorough.
		$LF
	]li
	[li 
		" I didn't test opening the Go To window to get to cell A95.
		$LF
	]li
	[li 
		" The walk along the passage (i.e. the only real gameplay) is not perfect. Since I didn't have any memory values as detailed above, I was basically running blind for half of it. I still put effort in to optimise it.
		$LF
	]li
	[li 
		" I added a few frames at the end to get a good view of the credits, otherwise it would be too small to read.
		$LF
	]li
]ul
[h3 id=JudgingNotes 
	" Judging notes
	$LF
]h3
[div class=p 
	"I don't know how exactly to catalogue this game and TAS. It could be Microsoft Excel: Hall of Tortured Souls "secret ending" for example.
	$LF
]div
[hr 
]hr
[div class=p 
	[a class=intlink href=/Users/Profile/feos 
		"feos
	]a
	": Claiming for judging.
	$LF
]div
[div class=p 
	[a class=intlink href=/Users/Profile/feos 
		"feos
	]a
	": This fits 
	(__wikiLink|displaytext=our definition of a video game|href=/Glossary#VideoGame)
	", the only questionable aspect being the ending, but we allow a community vetted one. In the case of this game the ending is when 
	[a href=https://www.speedrun.com/microsoft_excel_95_hall_of_tortured_souls?h=Credits-standard&rules=game&x=zd3xe8nd-2lgek338.qyz4erd1 rel=noopener external nofollow 
		"the credits screen is fully visible
	]a
	".
	$LF
]div
[div class=p 
	"It was tempting to try optimizing this movie further, but that'd delay the queue even more, so I resisted and left it to someone's future improvements. Accepting, and I think the normal ending is also acceptable based on the same ending definition. Going out-of-bounds seems to require a CPU that's too fast for this game, so arguably it'd be an unintended environment abuse, but it'd still be fine for Alt.
	$LF
]div
[div class=p 
	[a class=intlink href=/Users/Profile/fsvgm777 
		"fsvgm777
	]a
	": Processing.
]div
