7
[div class=p 
	"Citadel of Celestial Cascades is a Touhou themed puzzle platformer where the player takes control of Youmu and utilises her varied moveset to kill every ghost enemy on each level, thus unlocking the exit. Each level features a collectible which while initially seeming like a bonus challenge for completionists, is actually required to reach the credits.
	$LF
]div
[div class=p 
	"Pretty much every one of Youmu's abilities has some interesting quirks to it, all of which are used to complete the game as fast as possible. 
	$LF
]div
[h3 id=GameObjectives 
	" Game objectives
	$LF
]h3
[ul 
	[li 
		" Aims for fastest completion
		$LF
	]li
]ul
[h3 id=SyncInstructions 
	" Sync instructions
	$LF
]h3
[ul 
	[li 
		" OS: Ubuntu 20.04.2 LTS
		$LF
	]li
	[li 
		" Game must be ran in a desktop environment, as outlined in the discussion thread
		$LF
	]li
	[li 
		" Unsure about this given the discussion thread but, the command-line option 
		[code 
			"--audio-driver ALSA
		]code
		" may be necessary for the encode to have audio
		$LF
	]li
	[li 
		" Virtual screen resolution may be altered freely
		$LF
	]li
]ul
[h3 id=MechanicsExploitsUsed 
	" Mechanics & Exploits Used
	$LF
]h3
[div class=p 
	"Jump: The game features fairly standard jumping mechanics - the longer you hold the key, the higher Youmu will go. The interesting thing is buffering a jump with horizontal speed will maintain that speed. This will be referred to as bunnyhopping from now on.
	$LF
]div
[div class=p 
	"Walljump: Youmu can jump off walls! Doing so will give her the highest horizontal speed possible in the game, so it will be done as much as possible, and then that speed will be preserved with bunnyhops.
	$LF
]div
[div class=p 
	"Sword slash: Youmu can swing her sword! This basic attack has 4 active frames where it can hit enemies or boxes, killing the former and pushing the latter. As all attacks, it can be aimed in one of 8 directions. Normally there is a bit of a cooldown between swings, but successfully killing an enemy allows Youmu to skip said cooldown and swing again right away.
	$LF
]div
[div class=p 
	"Dash: After killing an enemy, as long as Youmu remains midair or on a wall, I can press jump again to dash in one of eight directions. The direction of the dash can be changed mid-dash, making it quite versatile for all kinds of platforming. Dashing horizontally is faster than walking, but slower than walljumping, so it is rarely used for purely horizontal traversal. Dashing down is also slower than simply falling any time Youmu has enough room to accelerate downwards. The dash does however interrupt the freeze from clearing all enemies on the screen and opening the exit, so it will often be used to save a couple frames by continuing to move. Dashes can be refreshed by killing another enemy after dashing, until there are no more enemies left, however the dash must be used between kills as only one can be held at a time.
	$LF
]div
[div class=p 
	"Bullet: After killing two consecutive enemies without touching the floor Youmu will gain a bullet which she can fire at any time in one of the eight directions. This bullet deals the same amount of damage as a sword swing, but has the advantage of being a ranged attack. Firing a bullet will freeze the game for a couple frames, after which the projectile is fired. Killing a third enemy will refresh the bullet as well as the dash, and any further kills will do the same. Same as the dash, only one bullet can be held at a time. By using the bullet it is possible to kill two enemies on the same frame, stacking the freeze from killing them and saving a handful of frames. Doing this on the last two enemies of the level will softlock the level, but as long as the last remaining enemy is a solo kill, kills can be doubled up for timesave.
	$LF
]div
[div class=p 
	"Pause: While it might seem counter intuitive, pausing the game can in fact help with going fast. The usual cooldown from slashing the sword without killing an enemy runs during the pause menu, meaning I can wait out the cooldown without having Youmu move an inch, and slash again right away in the same spot. This comes in especially handy in encounters with shielded enemies. Additionally, 1-frame pauses are utilised to release jump without letting Youmu move, allowing for some otherwise impossible walljumps and wallslides.
	$LF
]div
[div class=p 
	"Wallslide: This is a glitch resulting from buffering a walljump input on the first possible frame. I'm not sure the exact conditions under which the glitch occurs, however I believe it to have something to do with Youmu's horizontal position aligning just right with the wall that's being slid on. This means sometimes touching another wall to set up the correct align for a slide is required. Wallslides are useful for gaining height in places where it wasn't intended, or just doing so quicker than one would by simply jumping between two walls.
	$LF
]div
[div class=p 
	"Box Redirect: Slashing a box normally sends it in the direction where the attack was aimed. Hitting the box on any frame of the attack that is not the first one allows me to change the direction Youmu is aiming and with it also the direction the box will fly.
	$LF
]div
[div class=p 
	"Time Control: Pausing the game has the effect of stopping everything but Youmu for the first frame of the pause screen. Pressing pause and confirm on the same frame performs a 0-frame pause, effectively letting the game continue at seemingly full speed, while all objects other than Youmu get stopped for 1 frame. This is used in a couple levels to slow down falling boxes to perform otherwise impossible jumps off them midair.
	$LF
]div
[h3 id=StageByStageComments 
	" Stage by stage comments
	$LF
]h3
[h4 id=Start 
	" Start
	$LF
]h4
[div class=p 
	"There is no menu delay so the intro cutscene can be skipped and the first level chosen in just a couple frames.
	$LF
]div
[h4 id=1 
	" 1
	$LF
]h4
[div class=p 
	"Fairly basic level. Use horizontal dashes and don't bonk into walls.
	$LF
]div
[h4 id=2 
	" 2
	$LF
]h4
[div class=p 
	"Downwards dash to cancel all upwards momentum from the jump. Dashing into the exit trigger is still faster than just standing on top of it due to the dash cancelling the 'level clear' freeze.
	$LF
]div
[h4 id=3 
	" 3
	$LF
]h4
[div class=p 
	"As is the case with a lot of the early levels, not much to comment on here. Simply optimised gameplay.
	$LF
]div
[h4 id=4 
	" 4
	$LF
]h4
[div class=p 
	"First time using walljumps as a way to gain horizontal speed, though due to the level geometry it's not possible to use bunnyhopping to my advantage. 
	$LF
]div
[h4 id=5 
	" 5
	$LF
]h4
[div class=p 
	"First instance of wallslides being used to speed up upwards movement.
	$LF
]div
[h4 id=6 
	" 6
	$LF
]h4
[div class=p 
	"Wallslide into walljump into bunnyhop all on 1x1 tiles to get directly to the collectible and be able to kill the enemy on the way.
	$LF
]div
[h4 id=7 
	" 7
	$LF
]h4
[div class=p 
	"More wallslides to grab the collectible in an unintended way, then a pause-assisted walljump to continue with the level.
	$LF
]div
[h4 id=811 
	" 8-11
	$LF
]h4
[div class=p 
	"Not much to say here.
	$LF
]div
[h4 id=12 
	" 12
	$LF
]h4
[div class=p 
	"The ability to redirect the dash at any point allows me to manipulate Youmu's h position in such a way that allows a slide on the upcoming wall. After which comes a long chain of bunnyhops in the low ceiling corridor to preserve walljump speed. 
	$LF
]div
[h4 id=1316 
	" 13-16
	$LF
]h4
[div class=p 
	"Nothing new here.
	$LF
]div
[h4 id=17 
	" 17
	$LF
]h4
[div class=p 
	"First level to introduce eye blocks, which just kill Youmu when touched. The hitboxes are fairly forgiving and that fact is abused to its maximum potential. 
	$LF
]div
[h4 id=1820 
	" 18-20
	$LF
]h4
[div class=p 
	"Nothing new here. 
	$LF
]div
[h4 id=21 
	" 21
	$LF
]h4
[div class=p 
	"First and only instance of killing two enemies on the same frame by using a bullet and a sword slash.
	$LF
]div
[h4 id=2226 
	" 22-26
	$LF
]h4
[div class=p 
	"Nothing new.
	$LF
]div
[h4 id=27 
	" 27
	$LF
]h4
[div class=p 
	"First instance of a moving enemy. These will move towards Youmu when they have line of sight. This generally does not impact much of the routing for the levels though, as any puzzles that would require manipulating them can be skipped.
	$LF
]div
[h4 id=2829 
	" 28-29
	$LF
]h4
[div class=p 
	"Nothing new.
	$LF
]div
[h4 id=30 
	" 30
	$LF
]h4
[div class=p 
	"Another walljump into low ceiling bunnyhops.
	$LF
]div
[h4 id=31 
	" 31
	$LF
]h4
[div class=p 
	"First occurrence of a box. This one is easily skipped with a wallslide.
	$LF
]div
[h4 id=32 
	" 32
	$LF
]h4
[div class=p 
	"Second instance of a pause-assisted walljump, used to skip moving the box again and doing some slower platforming.
	$LF
]div
[h4 id=33 
	" 33
	$LF
]h4
[div class=p 
	"Just optimised platforming.
	$LF
]div
[h4 id=34 
	" 34
	$LF
]h4
[div class=p 
	"Attaching to the side of a box kills its vertical speed, allowing me to put the box on Youmu's head and be able to push it into a good position right away. This level also features the first instance of Time Control, allowing me to slow the box as it's flying towards the exit. This lets Youmu catch up to the box midair and jump off to grab the collectible a bit earlier than normal. 
	$LF
]div
[h4 id=35 
	" 35
	$LF
]h4
[div class=p 
	"Wallslides allow me to skip the entire box puzzle in this level.
	$LF
]div
[h4 id=36 
	" 36
	$LF
]h4
[div class=p 
	"Tough level to optimise! I tried different combinations of up and diagonal slashes, as well as Time Control but couldn't figure out a more optimal chain.
	$LF
]div
[h4 id=37 
	" 37
	$LF
]h4
[div class=p 
	"The entire puzzle aspect of this level is skipped thanks to one conveniently exposed corner.
	$LF
]div
[h4 id=38 
	" 38
	$LF
]h4
[div class=p 
	"Couldn't figure out a way to get down to the goal without jumping all the way to the left, since all dashes need to be used to get to the collectible.
	$LF
]div
[h4 id=39 
	" 39
	$LF
]h4
[div class=p 
	"Walljump speed is fast so bnuuyhopping is preferred to keeping dashes.
	$LF
]div
[h4 id=40 
	" 40
	$LF
]h4
[div class=p 
	"Mild flashing lights warning. First instance of pausing the game to wait out sword swing cooldown. Simplified a lot of the routing for these levels and made them a lot faster.
	$LF
]div
[h4 id=41 
	" 41
	$LF
]h4
[div class=p 
	"Another puzzle easily skipped, this one didn't even require any glitches!
	$LF
]div
[h4 id=42 
	" 42
	$LF
]h4
[div class=p 
	"Doubling up on sword slash and bullet to instantly kill a 1 shield enemy, allowing me to forego the pause abuse.
	$LF
]div
[h4 id=4344 
	" 43-44
	$LF
]h4
[div class=p 
	"Nothing new.
	$LF
]div
[h4 id=45 
	" 45
	$LF
]h4
[div class=p 
	"Another usage of Time Control to slow down the box after pushing it up-right. This allows me to walljump off it midair and jump over the eye blocks. Normally this section requires baiting the eye enemy over to use it for a dash, which takes approximately 5 seconds longer than using this exploit.
	$LF
]div
[h4 id=46 
	" 46
	$LF
]h4
[div class=p 
	"First usage of a box redirect, to pull a box along with Youmu as she falls.
	$LF
]div
[h4 id=47 
	" 47
	$LF
]h4
[div class=p 
	"Bonking the box from below allows me to slow down its fall and walljump off it.
	$LF
]div
[h4 id=48 
	" 48
	$LF
]h4
[div class=p 
	"Second use of Time Control, this time to slow down the falling box, allowing me to jump off it and not die to the eye blocks. It's also the only way I found to quickly collect the item.
	$LF
]div
[h4 id=49 
	" 49
	$LF
]h4
[div class=p 
	"Nothing new.
	$LF
]div
[h4 id=50 
	" 50
	$LF
]h4
[div class=p 
	"Going into this level from the level select seems to get the collectible countdown to start quicker. I didn't do extensive testing as pausing during a level transition doesn't lose time, so it might be unnecessary, just didn't feel like testing it. Killing the two overlapping enemies with one slash crashed the game, so I'm forced to kill them separately instead. As with any normal level, every enemy must be killed for the level to end, so killing the extra ad is required after slashing the boss enemy. As such last meaningful input happens when the slash comes out.
	$LF
]div
[h3 id=SpecialThanks 
	" Special thanks
	$LF
]h3
[ul 
	[li 
		" -7 for encouraging me to optimise this TAS and submit it here
		$LF
	]li
]ul
[hr 
]hr
[div class=p 
	[a class=intlink href=/Users/Profile/feos 
		"feos
	]a
	": Claiming for judging.
	$LF
]div
[div class=p 
	[a class=intlink href=/Users/Profile/feos 
		"feos
	]a
	": libTAS 1.4.3 has just been released and this movie works great on it. The movie itself is great too, so accepting. I fixed the movie to point to that version of libTAS too.
	$LF
]div
[div class=p 
	"The ending music is the main tune of the game just slowed down to about 23%, and it's not played from the start, and it's barely possible to recognize what it's playing without resampling it back to normal speed, and hard to spot loop end, so I'm not sure it really matters where the encode should end.
	$LF
]div
[div class=p 
	[a class=intlink href=/Users/Profile/fsvgm777 
		"fsvgm777
	]a
	": Processing (got an AVI dump from feos).
]div
