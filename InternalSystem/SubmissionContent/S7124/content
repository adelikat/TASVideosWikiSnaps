11
[div class=p 
	"Why play the game when you can just play the first level?
	$LF
]div
[div class=card mb-2 
	[div class=card-header 
		[strong 
			"Table of contents
		]strong
	]div
	[div class=card-body 
		[ul 
			[li 
				[a href=#GeneralInformation 
					" General Information
					$LF
				]a
			]li
			[li 
				[a href=#FunkyStart 
					" Funky Start
					$LF
				]a
			]li
			[li 
				[a href=#SplitUpGlitch 
					" Split-up Glitch
					$LF
				]a
			]li
			[li 
				[a href=#InvisibleAnimal 
					" Invisible Animal
					$LF
				]a
			]li
			[li 
				[a href=#BrkIsYourFriend 
					" BRK is your friend
					$LF
				]a
			]li
			[li 
				[a href=#OpenBusStrikesAgain 
					" Open Bus Strikes Again
					$LF
				]a
			]li
			[li 
				[a href=#HdmaToTheRescue 
					" HDMA to the rescue
					$LF
				]a
			]li
			[li 
				[a href=#Payload 
					" The Payload
					$LF
				]a
			]li
			[li 
				[a href=#WhatAboutWrongWarping 
					" What about Wrong Warping?
					$LF
				]a
			]li
			[li 
				[a href=#Notes 
					" Notes
					$LF
				]a
			]li
			[li 
				[a href=#SpecialThanks 
					" Special Thanks
					$LF
				]a
			]li
			[li 
				[a href=#SuggestedScreenshot 
					" Suggested Screenshot
					$LF
				]a
			]li
		]ul
	]div
]div
[h3 id=GeneralInformation 
	" General Information
	$LF
]h3
[ul 
	[li 
		" Emulator: Bizhawk 2.6.1
		$LF
	]li
	[li 
		" Version: USA 1.0
		$LF
	]li
	[li 
		" Objective: "Defeat" King K Rool as quickly as possible
		$LF
	]li
	[li 
		" Categories:
		$LF
		[ul 
			[li 
				" Uses death to save time
				$LF
			]li
			[li 
				" Takes damage to save time
				$LF
			]li
			[li 
				" Heavy glitch abuse
				$LF
			]li
			[li 
				" Corrupts memory
				$LF
			]li
			[li 
				" Major skip glitch
				$LF
			]li
			[li 
				" Final boss skip glitch
				$LF
			]li
			[li 
				" Executes arbitrary code
				$LF
			]li
			[li 
				" Genre: Platform
				$LF
			]li
		]ul
	]li
]ul
[h3 id=FunkyStart 
	" Funky Start
	$LF
]h3
[div class=p 
	"A relatively new glitch was discovered where pressing down immediately after Start at the beginning causes the kongs to start in a funky barrel instead of as solo Donkey Kong.  This saves a little over a second by not loading the world map music and moving slightly faster.
	$LF
]div
[h3 id=SplitUpGlitch 
	" Split-up Glitch
	$LF
]h3
[div class=p 
	"The split-up glitch causes allows the player to control both kongs at once, in addition to having both kongs interact with objects as if each was the active kong.
	$LF
]div
[div class=p 
	"There are a few ways to trigger this, but the fastest way is to do the following:
	$LF
]div
[ul 
	[li 
		" Pick up a DK Barrel
		$LF
	]li
	[li 
		" Bounce on an enemy to drop it
		$LF
	]li
	[li 
		" Before the DK Barrel breaks, pick it back up again
		$LF
	]li
	[li 
		" Get hit and die (note: while in this state, you can only die from falling in a pit, so you must get hit over a pit)
		$LF
	]li
	[li 
		" Break open a DK Barrel
		$LF
	]li
]ul
[div class=p 
	"You will now be controlling both kongs at once.  Needless to say, being able to do this causes all manner of glitches to occur, including the one we're interested in.
	$LF
]div
[h3 id=InvisibleAnimal 
	" Invisible Animal
	$LF
]h3
[div class=p 
	"Using the split-up glitch, you can ride an animal buddy with both Kongs at the same time.  This causes weird graphical effects, and the animal buddy object can despawn if you travel too far in either direction.
	$LF
]div
[div class=p 
	"Notably, this allows applying the "jump" logic to an invalid object like a bonus, which causes an infinite loop.  The infinite loop fills the stack until it eventually overwrites the source of the infinite loop, corrupting many pointers in the process.
	$LF
]div
[h3 id=BrkIsYourFriend 
	" BRK is your friend
	$LF
]h3
[div class=p 
	"The most obvious effect of these pointers being corrupted is the Kongs will now fall through the ground.  However, it is also possible to execute invalid behavior 3F, which quickly BRK's.  This sends the program counter to $7003.
	$LF
]div
[h3 id=OpenBusStrikesAgain 
	" Open Bus Strikes Again
	$LF
]h3
[div class=p 
	"If you don't know what Open Bus is, you can find a high level explanation 
	(__wikiLink|displaytext=here|href=/6432S)
	".
	$LF
]div
[div class=p 
	"Suffice it to say, $7000-$7FFF is all Open Bus, and it ends up doing 70 70 over and over again.
	$LF
]div
[div class=p 
	"It then reaches $800b, which quickly results in another BRK back to $7000 or $7003.
	$LF
]div
[h3 id=HdmaToTheRescue 
	" HDMA to the rescue
	$LF
]h3
[div class=p 
	"This would normally result in some sort of infinite loop, but while all this is going on, HDMA is still actively trying to send data during certain windows for graphical effects.
	$LF
]div
[div class=p 
	"I won't go into too many details here, but these commands can overwrite what Open Bus would normally spit out, and vary wildly in effect.
	$LF
]div
[div class=p 
	"By finding an extremely unlikely command through a very specific timing, it is then possible to reach the controller registers located from $4218 to $421F.
	$LF
]div
[h3 id=Payload 
	" The Payload
	$LF
]h3
[div class=p 
	"Unfortunately, the path I took to get here ended up clobbering both the data bank and direct page registers, and we can't beat the game without resetting them.  Thus, the payload looks like this:
	$LF
]div
[ul 
	[li 
		" 5B 20728C 80FA
		$LF
	]li
	[li 
		" 80F8 48 AB 22D784B8
		$LF
	]li
]ul
[div class=p 
	"The first frame fixes the direct page register and continually calls a lengthy function in the game until the controller data is updated.  This last bit is important because the controller data isn't filled instantly, so we need to stall after the process starts without knowing when it started.
	$LF
]div
[div class=p 
	"The second frame fixes the data bank register and jumps to $B884D7.  This location is called very early on when loading the level after King K Rool is beaten, and conveniently sets all the necessary flags as well.
	$LF
]div
[h3 id=WhatAboutWrongWarping 
	" What about Wrong Warping?
	$LF
]h3
[div class=p 
	"It is entirely possible on Bizhawk to do the same jump using the controller registers by doing a wrong warp to level FFE9.  This is both significantly easier to do and faster, but it has a fatal problem: 
	[b 
		"It doesn't work on real hardware.
	]b
	$LF
]div
[div class=p 
	"The way Bizhawk updates the controller registers in this instance is flawed, and as such reads data that is basically a bunch of 0's or thereabouts on actual hardware.  This will always be the case if the ACE is attempted during a level transition, and as such is not viable anywhere.
	$LF
]div
[div class=p 
	"Thankfully, the HDMA ACE is done in the middle of the level, and there's no reason to believe the controller registers should be disabled.
	$LF
]div
[h3 id=Notes 
	" Notes
	$LF
]h3
[div class=p 
	"For more details on some of the movement done here, please refer to the explanation video.
	$LF
]div
[h3 id=SpecialThanks 
	" Special Thanks
	$LF
]h3
[div class=p 
	"p4plus2 and Ilari: For helping me to better understand why the wrong warp method doesn't work on real hardware, and for helping me to better understand the magic of HDMA.
	$LF
]div
[div class=p 
	"SnakPak: For confirming that the BRK is triggered on console.
	$LF
]div
[div class=p 
	"Everyone on the DKC speedrun, TASVideos, and TASBot discord servers who gave advice or encouragement.  It's much appreciated!
	$LF
]div
[h3 id=SuggestedScreenshot 
	" Suggested Screenshot
	$LF
]h3
[div class=p 
	[img class=embed mw-100 src=https://i.imgur.com/AuaQvAx.png 
	]img
	$LF
]div
[hr 
]hr
[div class=p 
	[a class=intlink href=/Users/Profile/Samsara 
		"Samsara
	]a
	": Judging.
	$LF
]div
[div class=p 
	[a class=intlink href=/Users/Profile/Samsara 
		"Samsara
	]a
	": Congrats on finding a working strategy for this! Reception to the run is excellent, the submission text was a great read and the video was an even better watch. Accepting to Moons as a new category!
	$LF
]div
[div class=p 
	[a class=intlink href=/Users/Profile/EZGames69 
		"EZGames69
	]a
	": Processing
]div
