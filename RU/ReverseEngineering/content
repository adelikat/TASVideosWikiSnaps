5
[h2 id=Thispageinotherlanguages 
	" This page in other languages
	$LF
]h2
[div class=p 
	(listlanguages|istranslation=true)
	$LF
]div
[hr 
]hr
[div class=toc 
	[ul 
		[li 
			[a href=#Thispageinotherlanguages 
				" This page in other languages
				$LF
			]a
			[ul 
				[li 
					[a href=#Предисловие 
						" Предисловие
						$LF
					]a
				]li
				[li 
					[a href=#Областипамяти(RAM) 
						" Области памяти (RAM)
						$LF
					]a
				]li
				[li 
					[a href=#Объекты 
						" Объекты
						$LF
					]a
				]li
				[li 
					[a href=#Генераторыслучайныхчисел. 
						" Генераторы случайных чисел.
						$LF
					]a
				]li
				[li 
					[a href=#Ссылки 
						" Ссылки
						$LF
					]a
				]li
				[li 
					[a href=#Эмуляторы 
						" Эмуляторы
						$LF
					]a
				]li
			]ul
		]li
	]ul
]div
[div class=p 
	[em 
		""Искусство ТАС стало чем-то большим, нежели просто играть в игру. ТАСинг сделался игрой сам по себе, и мы идем еще дальше, создавая вещи, которые играют в эту игру за вас. Своего рода, метаигра. Ее лучшие игроки знают, как нарушить все правила, и это требует глубокого понимания как архитектуры, особенностей игры, так и инструментов для взаимодействия с ней."
	]em
	" - 
	[a class=intlink href=/Forum/P/389519#389519 
		"ТРУЪ
	]a
	".
	$LF
]div
[h3 id=Предисловие 
	" Предисловие
	$LF
]h3
[div class=p 
	[a class=extlink href=http://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D1%80%D0%B0%D1%82%D0%BD%D0%B0%D1%8F_%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0 rel=nofollow 
		"Обратная разработка
	]a
	" - исследование некоторого готового устройства или программы, а также документации на него с целью понять принцип его работы; например, чтобы обнаружить недокументированные возможности (в том числе программные закладки), сделать изменение, или воспроизвести устройство, программу или иной объект с аналогичными функциями, но без копирования как такового.
	$LF
]div
[div class=p 
	"В старые ламповые времена, создание ТАС сводилось к экспериментам над игрой в попытках пройти ее неизвестным прежде способом. Это было довольно ново, и потому работало. Но приходили все новые люди, делались ТАСы по все новым играм, старые прохождения постоянно обгонялись, и сообщество в итоге развило новый стандарт ТАСинга, значительно превосходящий прежний. Это был естественный процесс, по двум основным причинам:
	$LF
]div
[ul 
	[li 
		" Уровень оптимизации постоянно возрастал, обнаруживались и применялись новые трюки, улучшались старые.
		$LF
	]li
	[li 
		" Развлечь зрителей становилось все сложнее, коль скоро за годы они повидали уже столько всего, что ТАСам всегда нужно было находить новые необычные идеи ради улучшение развлекательности.
		$LF
	]li
]ul
[div class=p 
	"Сегодня, чтобы сделать мувик, полностью отвечающий современным стандартам ТАС, стало необходимо применять к проходимой игре самые продвинутые методики. А именно - детально разбираться во внутренних механизмах игры и применять эти знания непосредственно при создании ТАС.
	$LF
]div
[div class=p 
	"Данное руководство ставит себе целью научить читателя простым, но эффективным методам, которые можно применять к подавляющему большинству игр. Единственной проблемой может оказаться отсутствие нужных инструментов в некоторых эмуляторах.
	$LF
]div
[div class=p 
	[em 
		"Примечание: настоящее руководство изложено в контексте наиболее мощного в части обратной разработки эмулятора - FCEUX. Однако, опыт, полученный с его помощью, может быть эффективно применен в отношении любых других платформ/эмуляторов, для которых существуют аналогичные инструменты.
	]em
	$LF
]div
[h3 id=Областипамяти(RAM) 
	" Области памяти (RAM)
	$LF
]h3
[div class=p 
	[em 
		"Примечание: Используйте встроенный во FCEUX шестнадцатеричный редактор, чтобы обозревать память RAM в ходе игры. Команда меню "Debug -> Hex Editor". Также будет полезно сразу отрегулировать размер окна, чтобы единовременно отображалось 16 строк (1 страница памяти).
	]em
	$LF
]div
[div class=p 
	"В диапазоне адресов от $0000 до $00FF располагается нулевая страница (Zero Page). Игры размещают там временные переменные, которые очень часто меняются, или те, к которым необходим самый быстрый доступ; очень часто одни и те же адреса в пределах Zero Page отражают значения массы несвязанных между собой переменных из основной памяти. В связи с чем эти самые адреса, пусть даже если в них можно стабильно находить реальные данные, все равно не надежны. Необходимо искать реальные адреса, где на самом деле хранятся данные о состоянии RAM игры, и которые не заполняются посторонней информацией.
	$LF
]div
[div class=p 
	"В диапазоне $0100 - $01FF располагается Стек, который также используется для данных временного характера.
	$LF
]div
[div class=p 
	"Третья страница часто отводится под данные о спрайтах, что можно заметить, наблюдая, как там меняются значения.
	$LF
]div
[div class=p 
	"А вот дальше уже идут настоящие данные об игровом процессе, из которых можно многое узнать. Существует ряд довольно типичных способов размещения этих данных. Не считая всяких особо хитрых счетчиков и прочего, практически каждая игра хранит состояние объектов в различного вида массивах.
	$LF
]div
[h3 id=Объекты 
	" Объекты
	$LF
]h3
[div class=p 
	"Термин говорит сам за себя. Реализованные в игре сущности, взаимодействующие друг с другом и окружением, принято называть объектами. Как правило, все они обладают неким общим набором атрибутов. Для их хранения можно организовать виртуальную таблицу, где сами объекты будут представлены рядами, а их атрибуты - столбцами. Если вы разберетесь в адресах, соответствующих атрибутам тех или иных объектов, то 
	[del 
		"Матрица откроет вам свои тайны
	]del
	" вы увидите систему.
	$LF
]div
[div class=p 
	"Вышеназванная гипотетическая таблица не так уж далека от того, как объекты на самом деле размещаются в памяти. Начинаться сия структура может с массива идентификаторов объектов, располагающихся в свободных слотах. Потом - массив из идентификаторов спрайтов для них. А может - какой-нибудь номер состояния объекта, от которого зависит его поведение. И в дополнение ко всему - пространственные координаты, обычно из 2-3 переменных каждая. Типичный набор таков:
	$LF
]div
[ul 
	[li 
		" X - младший байт
		$LF
	]li
	[li 
		" X - старший байт
		$LF
	]li
	[li 
		" X - субпиксельная позиция
		$LF
	]li
	[li 
		" Y - младший байт
		$LF
	]li
	[li 
		" Y - старший байт
		$LF
	]li
	[li 
		" Y - субпиксельная позиция
		$LF
	]li
]ul
[div class=p 
	"Порой имеется и координата по оси Z. Также ситуация может различаться в зависимости от того, является ваш персонаж элементом общей карты объектов или обладает уникальными атрибутами, адресуемыми отдельно.
	$LF
]div
[div class=p 
	"Какие-то игры отслеживают положение объектов по абсолютным координатам в рамках уровня. А какие-то - чисто в зависимости от положения игровой камеры. Координаты X и Y для камеры тоже могут занимать по паре байт и обычно хранятся отдельно от основного массива объектов. Это позволяет получить истинное положение объекта на экране путем вычитания их абсолютных координат из координат камеры. А некоторые игры просто хранят данные о положении на экране отдельно, но такие данные ненадежны.
	$LF
]div
[div class=p 
	"Часто можно найти и другие атрибуты, такие как скорость, направление, и так далее. Какие-то вам не понадобятся, какие-то может оказаться трудно понять.
	$LF
]div
[div class=p 
	"Вам потребуется определить, что - ряды, а что - колонки. Некоторые игры представляют слоты в виде колонок, а атрибуты располагают рядами. А некоторые хранят атрибуты сразу за идентификатором, тем самым делая слоты рядами, а атрибуты строя в колонки. Бывает еще так, что игра форматирует таблицу на манер того, как показывает данные HEX-редактор, к примеру, резервируя 8 или 16 слотов под объекты, или давая каждому из них по 16 атрибутов. Такая таблица объектов легко различима на глаз.
	$LF
]div
[div class=p 
	"Разобравшись с назначением некоторых частей таблицы, вам уже нет нужды искать все атрибуты вручную, достаточно наблюдать изменения в ячейках памяти и делать выводы об их реальном назначении, например:
	$LF
]div
[ul 
	[li 
		" Младший байт для X координаты растет от 0 до 255 и снова сбрасывается в 0, увеличивая старший байт.
		$LF
	]li
	[li 
		" Координата X для позиции на экране замирает, когда персонаж достигает точки, где экран начинает прокручиваться вслед за ним.
		$LF
	]li
	[li 
		" Здоровье уменьшаются при получении объектом урона (хотя иногда наоборот - полученный урон аккумулируется в счетчике). 
		$LF
	]li
	[li 
		" Скорость часто также показывает направление (принимая положительные или отрицательные значения) и меняется при ускорении.
		$LF
	]li
	[li 
		" Субпиксельные позиции интенсивно меняются, когда скорость растет или уменьшается, замирают или колеблются между парой значений, когда скорость постоянна.
		$LF
	]li
	[li 
		" Идентификатор объекта появляется в слоте вместе с вводом объекта в игру и не обнуляется, пока последний не исчезнет.
		$LF
	]li
	[li 
		" Значения таймеров уменьшаются или увеличиваются на один до наступления определенного момента, и иногда можно увидеть, наступление каких событий отслеживается.
		$LF
	]li
]ul
[div class=p 
	"Какие-то игры реализуют боссов, как обычные объекты, а какие-то хранят их атрибуты отдельно от прочих. Вам потребуется найти их: здоровье, таймер неуязвимости, позиция, состояние/направление движения. Это позволит понять их действия и найти способ их контролировать, или, по меньшей мере, отслеживать.
	$LF
]div
[h3 id=Генераторыслучайныхчисел. 
	" Генераторы случайных чисел.
	$LF
]h3
[div class=p 
	"Разобраться в причинах возникновения какого-то конкретного события не так уж сложно. Однако, для этого нужно будет пользоваться Отладчиком, ставить точки останова, равно как и выводить исполненный код в файл или окно (трейс лог).
	$LF
]div
[div class=p 
	"Для начала, следует определить для себя некий видимый атрибут, который изменяется, и вы хотите это контролировать. К примеру, конкретный кадр, в который противник предпримет атаку. Или тип этой атаки. Или место появления какого-то объекта. В общем, любой фактор, который выглядит случайным и меняется в зависимости от вашего поведения в игре.
	$LF
]div
[div class=p 
	"После этого надо найти адрес, по которому хранится значение этого атрибута. В этом нам поможет инструмент RAM Search, который позволит найти адреса переменных, которые меняются в точности тогда же, когда и искомый видимый атрибут.
	$LF
]div
[div class=p 
	"Затем ставится точка останова на событие Записи по найденному адресу. Запускается мувик, в котором меняется искомый атрибут. Важно знать, как часто происходит его запись. В большинстве случаев точка останова будет срабатывать лишь раз в некоторый промежуток времени (скажем, раз в несколько секунд). А записываемое значение равняется тому, что вы впоследствии видите в RAM. Номер кадра, на котором происходит запись следует куда-то записать, например, в текстовый файл, или сохранить состояние игры непосредственно перед ним.
	$LF
]div
[div class=p 
	"После этого надо вывести в файл код, выполняющийся непосредственно перед срабатыванием точки останова. Во многих случаях лога лишь за один кадр, где это произошло, достаточно. Однако, если точка останова срабатывала много раз за кадр, обязательно убедитесь, что в лог попали они все. Хорошо может сказаться и привычка пройти несколько "шагов вглубь" (Step Into) вслед за последним срабатыванием, чтобы захватить весь вовлеченный в событие код. Читать его во время выполнения не так уж полезно. А вот чтение лога покажет вам, откуда взялось значение, записанное по наблюдаемому адресу. Обычно оно бывает:
	$LF
]div
[ul 
	[li 
		" Скопировано как есть из ROM.
		$LF
	]li
	[li 
		" Скопировано как есть с другого адреса в RAM.
		$LF
	]li
	[li 
		" Результатом какого-то взаимодействия с другой или несколькими другими переменными.
		$LF
	]li
]ul
[div class=p 
	"В первом случае, вам потребуется найти условие, при котором игра выполняет переход на данную позицию в коде и пишет это значение. Если переход будет сделан в другое место, записанное значение тоже будет другим.
	$LF
]div
[div class=p 
	"В двух других случаях, вам нужно будет найти, откуда берется результирующее значение. Если оно копируется напрямую с другого адреса, установите точку останова на запись туда, и ищите, откуда берется 
	[em 
		"то
	]em
	" значение (точка останова может активироваться не единожды, прежде чем там окажется конечное значение, в таком случае надо обращать внимание на последний раз, в который было установлено значение, попавшее по наблюдаемому вами адресу). Если имел место какой-то алгоритм с участием значений по сторонним адресам, вам потребуется отладить процедуру, выполняющуюся каждый раз и выдающую разный результат для различного набора исходных значений.
	$LF
]div
[div class=p 
	"Когда источник значения наблюдаемой переменной обнаружен, нужно изменить игровое поведение так, чтобы поменялось наблюдаемое значение, и аналогичным способом оценить, что изменилось в факторах, его определяющих.
	$LF
]div
[div class=p 
	"Иными словами, для поиска причин вы будете раз за разом отматывать время назад. И наконец, отладив и натрейсив достаточно, придете к четкому пониманию, как себя ведет искомый псевдослучайный атрибут. Можно будет даже написать аналогичный алгоритм на LUA, и с его помощью предсказывать будущие значения в зависимости от игровой ситуации. И, самое главное, у вас появится возможность влиять на псевдослучайные исходные факторы, определяющие искомый атрибут, тем самым эффективно контролируя его. А может наоборот, узнаете, что он нисколько не случаен, и им нельзя манипулировать без существенного проигрыша по скорости. Это головоломка, в конце концов, вам ее решать!
	$LF
]div
[div class=p 
	[em 
		"Замечание: Некоторые эмуляторы поддерживают использование при отладке и трассировке информации об отладочных символах. Это ужасно полезная вещь, позволяющая заменить нужные вам адреса на понятные человеку слова. В результате, в коде будут фигурировать не безликие цифры, а осмысленные названия, отражающие назначение упоминаемых адресов.
	]em
	$LF
]div
[h3 id=Ссылки 
	" Ссылки
	$LF
]h3
[ul 
	[li 
		" http://www.6502.org/tutorials/6502opcodes.html
		$LF
	]li
	[li 
		" http://wiki.nesdev.com/w/index.php/Nesdev_Wiki
		$LF
	]li
	[li 
		" http://en.wikibooks.org/wiki/Super_NES_Programming
		$LF
	]li
	[li 
		" http://forums.nesdev.com/viewtopic.php?t=5528
		$LF
	]li
	[li 
		" http://www.romhacking.net/utilities/749/
		$LF
	]li
	[li 
		" http://gendev.spritesmind.net/page-home.html
		$LF
	]li
	[li 
		" http://problemkaputt.de/gbatek.htm
		$LF
	]li
	[li 
		" http://gbadev.org/docs.php
		$LF
	]li
]ul
[ul 
	[li 
		" http://www.fceux.com/web/help/HexEditor.html
		$LF
	]li
	[li 
		" http://www.fceux.com/web/help/fceux.html?Debugger.html
		$LF
	]li
	[li 
		" http://www.fceux.com/web/help/fceux.html?TraceLogger.html
		$LF
	]li
	[li 
		" http://www.fceux.com/web/help/NESRAMMappingFindingValues.html
		$LF
	]li
]ul
[h3 id=Эмуляторы 
	" Эмуляторы
	$LF
]h3
[table 
	[tbody 
		[tr 
			[th 
				" Эмулятор 
			]th
			[th 
				" Платформа 
			]th
			[th 
				" Инструменты 
			]th
		]tr
		[tr 
			[td 
				" 
				[a class=extlink href=http://www.fceux.com/ rel=nofollow 
					"FCEUX
				]a
				" 
			]td
			[td 
				" NES/FDS 
			]td
			[td 
				" - Отладчик
				[br 
				]br
				" - Трассировщик кода
				[br 
				]br
				" - HEX-редактор
				[br 
				]br
				" - Функции отладки LUA 
			]td
		]tr
		[tr 
			[td 
				" 
				(__wikiLink|/BizHawk|BizHawk)
				" 
			]td
			[td 
				" Несколько 
			]td
			[td 
				" - Трассировщик кода
				[br 
				]br
				" - HEX-редактор 
			]td
		]tr
		[tr 
			[td 
				" 
				[a class=extlink href=http://code.google.com/p/vba-rerecording/ rel=nofollow 
					"VisualBoyAdvance
				]a
				" 
			]td
			[td 
				" GBx/GBA 
			]td
			[td 
				" - Дизассемблер
				[br 
				]br
				" - Трассировщик кода
				[br 
				]br
				" - HEX-редактор 
			]td
		]tr
		[tr 
			[td 
				" 
				[a class=extlink href=http://desmume.org/ rel=nofollow 
					"DeSmuME
				]a
				" 
			]td
			[td 
				" NDS 
			]td
			[td 
				" - GDB Stub
				[br 
				]br
				" - Дизассемблер
				[br 
				]br
				" - HEX-редактор 
			]td
		]tr
		[tr 
			[td 
				" 
				(__wikiLink|/Lsnes|lsnes)
				" 
			]td
			[td 
				" SNES 
			]td
			[td 
				" - Дизассемблер
				[br 
				]br
				" - Трассировщик кода
				[br 
				]br
				" - HEX-редактор
				[br 
				]br
				" - Функции отладки LUA 
			]td
		]tr
		[tr 
			[td 
				" 
				[a class=extlink href=http://psxemulator.gazaxian.com/ rel=nofollow 
					"pSX
				]a
				" 
			]td
			[td 
				" PSX 
			]td
			[td 
				" - Отладчик
				[br 
				]br
				" - HEX-редактор 
			]td
		]tr
		[tr 
			[td 
				" 
				[a class=extlink href=http://problemkaputt.de/index.htm rel=nofollow 
					"nocash emulators
				]a
				" 
			]td
			[td 
				" Несколько 
			]td
			[td 
				" - Отладчик
				[br 
				]br
				" - Трассировщик кода
				[br 
				]br
				" - HEX-редактор
				[br 
				]br
				" 
			]td
		]tr
		[tr 
			[td 
				" 
				[a class=extlink href=http://aamirm.hacking-cult.org/www/regen.html rel=nofollow 
					"Regen D
				]a
				" 
			]td
			[td 
				" Genesis/GG/SMS 
			]td
			[td 
				" - Отладчик
				[br 
				]br
				" - HEX-редактор
				[br 
				]br
				" 
			]td
		]tr
		[tr 
			[td 
				" 
				[a class=extlink href=http://code.google.com/p/gens-rerecording/downloads/list rel=nofollow 
					"Gens-rr
				]a
				" 
			]td
			[td 
				" Genesis/SegaCD/32X 
			]td
			[td 
				" - Трассировщик кода
				[br 
				]br
				" 
			]td
		]tr
		[tr 
			[td 
				" 
				[a class=extlink href=http://elektropage.ru/publ/programmy_dlja_romkhakinga/ehmuljatory/gens_11_r57shell_mod/38-1-0-122 rel=nofollow 
					"Gens-rr r57shell mod
				]a
				" 
			]td
			[td 
				" Genesis/SegaCD/32X 
			]td
			[td 
				" - Отладчики
				[br 
				]br
				" - Трассировщик кода
				[br 
				]br
				" - HEX-редактор
				[br 
				]br
				" 
			]td
		]tr
	]tbody
]table
[hr 
]hr
[div class=p 
	[em 
		(__wikiLink|/TODO|TODO)
	]em
	": Add cases that contradict this guide..
	[br 
	]br
	$LF
	[em 
		(__wikiLink|/TODO|TODO)
	]em
	": Expand this guide with details..
	[br 
	]br
]div
